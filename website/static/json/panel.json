{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 16,
  "iteration": 1638864885076,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 33,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 2,
      "options": {
        "SVGBaseFix": true,
        "add100Percentage": true,
        "calcsMutation": "standard",
        "centerAlignContent": true,
        "codeData": "{\n  \"editable\": true,\n  \"isGrafana\": true,\n  \"templateVariables\": {\n    \"area\": \"area\",\n    \"scene\": \"scene\",\n    \"autoRotate\": \"autoRotate\"\n  },\n  \"api\": {\n    \"url\": \"/api/datasources/proxy/1/\",\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiZWRpdG9yIn0.prDbUIvvO_qmOyL4hg0c9MVGpW6HZaxKzZbd3fCUha4\"\n  }\n}",
        "css": ".panorama-container.svelte-z7wx6o{position:absolute;top:0;left:0;width:100%;height:100%}.dev-info.svelte-lxue0z{position:absolute;bottom:0;right:0;display:flex;padding:10px 20px;color:#fcfcfc;background-color:#1b191c55}.dev-info.svelte-lxue0z>div:not(:last-child){margin-right:20px}.sidebar.svelte-723jm5{position:absolute;top:0;left:0;bottom:0;display:flex;flex-direction:column;background-color:#1b191c55;border-right:2px solid black}.tabs.svelte-1mi0k3z.svelte-1mi0k3z{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tabs.svelte-1mi0k3z button.svelte-1mi0k3z{background-color:inherit;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:0.3s;font-size:17px}.tabs.svelte-1mi0k3z button.svelte-1mi0k3z:hover{background-color:#ddd}.tabs.svelte-1mi0k3z button.active.svelte-1mi0k3z{background-color:#ccc}.draggable.svelte-nddt6l{position:absolute;right:0;bottom:0;top:0;width:12px;transform:translateX(12px);cursor:e-resize;user-select:none}.wrapper.svelte-1mqf4s8{display:none}.editing.svelte-1mqf4s8{z-index:1000000 !important}.editable.svelte-1mqf4s8{cursor:pointer}.editor-container.svelte-1mqf4s8{border:5px solid #1b191c;background-color:#1b191c55;position:absolute;top:40px;transform:translateX(-50%)}div.svelte-b2gyfz{width:110px}.draggable.svelte-1uh541o{user-select:none;cursor:move;position:absolute}div.svelte-10r7xly{display:flex;justify-content:space-between}.container.svelte-5mdjxu{width:100px}.hotspot.svelte-11tniiw{position:absolute;top:0;left:0;color:white;width:200px;transform:translate(-50%, -50%)}.link.svelte-11tniiw{cursor:pointer}.type.svelte-11tniiw{text-transform:uppercase}.hotspot.svelte-1l62dig{position:absolute;top:0;left:0;width:80px;cursor:pointer;transform:translate(-50%, -50%)}div.svelte-zjwjw7{color:white;transform:translate(-50%, -50%)}div.svelte-n62mam{color:#fcfcfc;overflow-y:auto;flex:1}ul.svelte-n62mam{list-style:none;margin:0;padding:0}div.svelte-vbt9u8{color:#fcfcfc;border-top:2px solid black}button.svelte-vbt9u8{width:100%}button.svelte-4vhvtq{width:100%}div.svelte-n62mam{color:#fcfcfc;overflow-y:auto;flex:1}ul.svelte-n62mam{list-style:none;margin:0;padding:0}div.svelte-58jnl0{border-top:2px solid black}button.svelte-58jnl0{width:100%}div.svelte-n62mam{color:#fcfcfc;overflow-y:auto;flex:1}ul.svelte-n62mam{list-style:none;margin:0;padding:0}div.svelte-1nqmnxb{display:flex}button.svelte-1nqmnxb{width:100%}.confirm.svelte-1nqmnxb{background-color:lightgreen}.cancel.svelte-1nqmnxb{background-color:lightcoral}.container.svelte-11aq3ga{color:#fcfcfc;padding:8px 8px 4px 8px}input.svelte-w9c1hk.svelte-w9c1hk{width:150px}.color-picker-holder.svelte-w9c1hk.svelte-w9c1hk{display:flex;justify-content:space-between;position:relative}.color-picker-inner.svelte-w9c1hk.svelte-w9c1hk{display:flex;height:22px}.select-color.svelte-w9c1hk.svelte-w9c1hk{border:1px solid transparent;border-radius:4px;margin-right:4px;background-color:#000}.caret.svelte-w9c1hk.svelte-w9c1hk{border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid #000}.caret.toggled.svelte-w9c1hk.svelte-w9c1hk{border-bottom:4px solid #000;border-top:none}.active.svelte-w9c1hk.svelte-w9c1hk{box-shadow:inset 0 0 0 1px #fff, 0 0 3px 1px rgba(0, 0, 0, 0.25)}.color-block.svelte-w9c1hk.svelte-w9c1hk{border-radius:2px;width:24px;height:24px}.values-dropdown.svelte-w9c1hk.svelte-w9c1hk{padding:8px;position:absolute;top:25px;left:65px;background:white;border:1px solid #ccc;border-radius:2px;cursor:default}.values-dropdown-grid.svelte-w9c1hk.svelte-w9c1hk{grid-template-columns:repeat(2, 24px);grid-gap:4px;display:grid}.values-dropdown.svelte-w9c1hk button.svelte-w9c1hk{border:none}div.svelte-q0fna{display:flex;justify-content:space-between}.select-container.svelte-q0fna{--height:22px;--inputPadding:2px;--itemPadding:4px;--inputFontSize:13.3333px;--border-radius:2px;--margin:1px 0 0 1px;--clearSelectTop:1px;--clearSelectBottom:0;display:inline-block;color:black;width:158px;font-size:var(--inputFontSize);margin-left:10px}.selectContainer{padding:2px !important}div.svelte-uhbt6z{display:flex;justify-content:space-between;white-space:pre}input.svelte-uhbt6z{margin-left:10px;width:150px}div.svelte-uhbt6z{display:flex;justify-content:space-between;white-space:pre}input.svelte-uhbt6z{margin-left:10px;width:150px}label.svelte-kk9kj9{display:block;padding:10px 16px;height:22px;position:relative}label.svelte-kk9kj9:hover{background-color:#1b191ce0}label.active.svelte-kk9kj9{background-color:#1b191cbb}label.edited.svelte-kk9kj9{font-style:italic}input.svelte-98eo36{width:100%}img.svelte-98eo36{width:100%}label.svelte-kk9kj9{display:block;padding:10px 16px;height:22px;position:relative}label.svelte-kk9kj9:hover{background-color:#1b191ce0}label.active.svelte-kk9kj9{background-color:#1b191cbb}label.edited.svelte-kk9kj9{font-style:italic}label.svelte-1sg4g2q{display:block;padding:10px 16px;height:22px;position:relative}label.svelte-1sg4g2q:hover{background-color:#1b191ce0}label.active.svelte-1sg4g2q{background-color:#1b191cbb}label.edited.svelte-1sg4g2q{font-style:italic}img.svelte-1sg4g2q{height:100%;position:absolute;right:0;top:0}.selectContainer.svelte-17l1npl.svelte-17l1npl{--internalPadding:0 16px;border:var(--border, 1px solid #d8dbdf);border-radius:var(--borderRadius, 3px);box-sizing:border-box;height:var(--height, 42px);position:relative;display:flex;align-items:center;padding:var(--padding, var(--internalPadding));background:var(--background, #fff);margin:var(--margin, 0)}.selectContainer.svelte-17l1npl input.svelte-17l1npl{cursor:default;border:none;color:var(--inputColor, #3f4f5f);height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--inputPadding, var(--padding, var(--internalPadding)));width:100%;background:transparent;font-size:var(--inputFontSize, 14px);letter-spacing:var(--inputLetterSpacing, -0.08px);position:absolute;left:var(--inputLeft, 0);margin:var(--inputMargin, 0)}.selectContainer.svelte-17l1npl input.svelte-17l1npl::placeholder{color:var(--placeholderColor, #78848f);opacity:var(--placeholderOpacity, 1)}.selectContainer.svelte-17l1npl input.svelte-17l1npl:focus{outline:none}.selectContainer.svelte-17l1npl.svelte-17l1npl:hover{border-color:var(--borderHoverColor, #b2b8bf)}.selectContainer.focused.svelte-17l1npl.svelte-17l1npl{border-color:var(--borderFocusColor, #006fe8)}.selectContainer.disabled.svelte-17l1npl.svelte-17l1npl{background:var(--disabledBackground, #ebedef);border-color:var(--disabledBorderColor, #ebedef);color:var(--disabledColor, #c1c6cc)}.selectContainer.disabled.svelte-17l1npl input.svelte-17l1npl::placeholder{color:var(--disabledPlaceholderColor, #c1c6cc);opacity:var(--disabledPlaceholderOpacity, 1)}.selectedItem.svelte-17l1npl.svelte-17l1npl{line-height:var(--height, 42px);height:var(--height, 42px);overflow-x:hidden;padding:var(--selectedItemPadding, 0 20px 0 0)}.selectedItem.svelte-17l1npl.svelte-17l1npl:focus{outline:none}.clearSelect.svelte-17l1npl.svelte-17l1npl{position:absolute;right:var(--clearSelectRight, 10px);top:var(--clearSelectTop, 11px);bottom:var(--clearSelectBottom, 11px);width:var(--clearSelectWidth, 20px);color:var(--clearSelectColor, #c5cacf);flex:none !important}.clearSelect.svelte-17l1npl.svelte-17l1npl:hover{color:var(--clearSelectHoverColor, #2c3e50)}.selectContainer.focused.svelte-17l1npl .clearSelect.svelte-17l1npl{color:var(--clearSelectFocusColor, #3f4f5f)}.indicator.svelte-17l1npl.svelte-17l1npl{position:absolute;right:var(--indicatorRight, 10px);top:var(--indicatorTop, 11px);width:var(--indicatorWidth, 20px);height:var(--indicatorHeight, 20px);color:var(--indicatorColor, #c5cacf)}.indicator.svelte-17l1npl svg.svelte-17l1npl{display:inline-block;fill:var(--indicatorFill, currentcolor);line-height:1;stroke:var(--indicatorStroke, currentcolor);stroke-width:0}.spinner.svelte-17l1npl.svelte-17l1npl{position:absolute;right:var(--spinnerRight, 10px);top:var(--spinnerLeft, 11px);width:var(--spinnerWidth, 20px);height:var(--spinnerHeight, 20px);color:var(--spinnerColor, #51ce6c);animation:svelte-17l1npl-rotate 0.75s linear infinite}.spinner_icon.svelte-17l1npl.svelte-17l1npl{display:block;height:100%;transform-origin:center center;width:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;-webkit-transform:none}.spinner_path.svelte-17l1npl.svelte-17l1npl{stroke-dasharray:90;stroke-linecap:round}.multiSelect.svelte-17l1npl.svelte-17l1npl{display:flex;padding:var(--multiSelectPadding, 0 35px 0 16px);height:auto;flex-wrap:wrap;align-items:stretch}.multiSelect.svelte-17l1npl>.svelte-17l1npl{flex:1 1 50px}.selectContainer.multiSelect.svelte-17l1npl input.svelte-17l1npl{padding:var(--multiSelectInputPadding, 0);position:relative;margin:var(--multiSelectInputMargin, 0)}.hasError.svelte-17l1npl.svelte-17l1npl{border:var(--errorBorder, 1px solid #ff2d55);background:var(--errorBackground, #fff)}.a11yText.svelte-17l1npl.svelte-17l1npl{z-index:9999;border:0px;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0px;white-space:nowrap}@keyframes svelte-17l1npl-rotate{100%{transform:rotate(360deg)}}.listContainer.svelte-1uyqfml{box-shadow:var(--listShadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));border-radius:var(--listBorderRadius, 4px);max-height:var(--listMaxHeight, 250px);overflow-y:auto;background:var(--listBackground, #fff);border:var(--listBorder, none);position:var(--listPosition, absolute);z-index:var(--listZIndex, 2);width:100%;left:var(--listLeft, 0);right:var(--listRight, 0)}.virtualList.svelte-1uyqfml{height:var(--virtualListHeight, 200px)}.listGroupTitle.svelte-1uyqfml{color:var(--groupTitleColor, #8f8f8f);cursor:default;font-size:var(--groupTitleFontSize, 12px);font-weight:var(--groupTitleFontWeight, 600);height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--groupTitlePadding, 0 20px);text-overflow:ellipsis;overflow-x:hidden;white-space:nowrap;text-transform:var(--groupTitleTextTransform, uppercase)}.empty.svelte-1uyqfml{text-align:var(--listEmptyTextAlign, center);padding:var(--listEmptyPadding, 20px 0);color:var(--listEmptyColor, #78848f)}.selection.svelte-pu1q1n{text-overflow:ellipsis;overflow-x:hidden;white-space:nowrap}.item.svelte-3e0qet{cursor:default;height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--itemPadding, 0 20px);color:var(--itemColor, inherit);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.groupHeader.svelte-3e0qet{text-transform:var(--groupTitleTextTransform, uppercase)}.groupItem.svelte-3e0qet{padding-left:var(--groupItemPaddingLeft, 40px)}.item.svelte-3e0qet:active{background:var(--itemActiveBackground, #b9daff)}.item.active.svelte-3e0qet{background:var(--itemIsActiveBG, #007aff);color:var(--itemIsActiveColor, #fff)}.item.notSelectable.svelte-3e0qet{color:var(--itemIsNotSelectableColor, #999)}.item.first.svelte-3e0qet{border-radius:var(--itemFirstBorderRadius, 4px 4px 0 0)}.item.hover.svelte-3e0qet:not(.active){background:var(--itemHoverBG, #e7f2ff);color:var(--itemHoverColor, inherit)}.multiSelectItem.svelte-liu9pa.svelte-liu9pa{background:var(--multiItemBG, #ebedef);margin:var(--multiItemMargin, 5px 5px 0 0);border-radius:var(--multiItemBorderRadius, 16px);height:var(--multiItemHeight, 32px);line-height:var(--multiItemHeight, 32px);display:flex;cursor:default;padding:var(--multiItemPadding, 0 10px 0 15px);max-width:100%}.multiSelectItem_label.svelte-liu9pa.svelte-liu9pa{margin:var(--multiLabelMargin, 0 5px 0 0);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.multiSelectItem.svelte-liu9pa.svelte-liu9pa:hover,.multiSelectItem.active.svelte-liu9pa.svelte-liu9pa{background-color:var(--multiItemActiveBG, #006fff);color:var(--multiItemActiveColor, #fff)}.multiSelectItem.disabled.svelte-liu9pa.svelte-liu9pa:hover{background:var(--multiItemDisabledHoverBg, #ebedef);color:var(--multiItemDisabledHoverColor, #c1c6cc)}.multiSelectItem_clear.svelte-liu9pa.svelte-liu9pa{border-radius:var(--multiClearRadius, 50%);background:var(--multiClearBG, #52616f);min-width:var(--multiClearWidth, 16px);max-width:var(--multiClearWidth, 16px);height:var(--multiClearHeight, 16px);position:relative;top:var(--multiClearTop, 8px);text-align:var(--multiClearTextAlign, center);padding:var(--multiClearPadding, 1px)}.multiSelectItem_clear.svelte-liu9pa.svelte-liu9pa:hover,.active.svelte-liu9pa .multiSelectItem_clear.svelte-liu9pa{background:var(--multiClearHoverBG, #fff)}.multiSelectItem_clear.svelte-liu9pa:hover svg.svelte-liu9pa,.active.svelte-liu9pa .multiSelectItem_clear svg.svelte-liu9pa{fill:var(--multiClearHoverFill, #006fff)}.multiSelectItem_clear.svelte-liu9pa svg.svelte-liu9pa{fill:var(--multiClearFill, #ebedef);vertical-align:top}svelte-virtual-list-viewport.svelte-g2cagw{position:relative;overflow-y:auto;-webkit-overflow-scrolling:touch;display:block}svelte-virtual-list-contents.svelte-g2cagw,svelte-virtual-list-row.svelte-g2cagw{display:block}svelte-virtual-list-row.svelte-g2cagw{overflow:hidden}",
        "dynamicData": true,
        "dynamicFieldDisplayValues": false,
        "dynamicHtmlGraphics": false,
        "dynamicProps": false,
        "html": "<div></div>",
        "onInit": "var app=function(){\"use strict\";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function i(){return Object.create(null)}function r(t){t.forEach(n)}function o(t){return\"function\"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&\"object\"==typeof t||\"function\"==typeof t}let a,l,c;function u(t,e){return a||(a=document.createElement(\"a\")),a.href=e,t===a.href}function h(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function f(t){let e;return h(t,(t=>e=t))(),e}function p(t,e,n){t.$$.on_destroy.push(h(e,n))}function d(t,e,n,i){if(t){const r=m(t,e,n,i);return t[0](r)}}function m(t,n,i,r){return t[1]&&r?e(i.ctx.slice(),t[1](r(n))):i.ctx}function v(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(void 0===e.dirty)return r;if(\"object\"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let i=0;i<n;i+=1)t[i]=e.dirty[i]|r[i];return t}return e.dirty|r}return e.dirty}function _(t,e,n,i,r,o){if(r){const s=m(e,n,i,o);t.p(s,r)}}function y(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function g(t,e,n){return t.set(n),e}function w(e){return e&&o(e.destroy)?e.destroy:t}function $(t,e){t.appendChild(e)}function b(t,e,n){t.insertBefore(e,n||null)}function x(t){t.parentNode.removeChild(t)}function M(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function T(t){return document.createElementNS(\"http://www.w3.org/2000/svg\",t)}function L(t){return document.createTextNode(t)}function C(){return L(\" \")}function S(){return L(\"\")}function k(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function I(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function P(t,e){const n=Object.getOwnPropertyDescriptors(t.__proto__);for(const i in e)null==e[i]?t.removeAttribute(i):\"style\"===i?t.style.cssText=e[i]:\"__value\"===i?t.value=t[i]=e[i]:n[i]&&n[i].set?t[i]=e[i]:I(t,i,e[i])}function A(t,e,n){e in t?t[e]=\"boolean\"==typeof t[e]&&\"\"===n||n:I(t,e,n)}function z(t){return\"\"===t?null:+t}function O(t,e){e=\"\"+e,t.wholeText!==e&&(t.data=e)}function R(t,e){t.value=null==e?\"\":e}function H(t,e,n,i){t.style.setProperty(e,n,i?\"important\":\"\")}function D(){if(void 0===l){l=!1;try{\"undefined\"!=typeof window&&window.parent&&window.parent.document}catch(t){l=!0}}return l}function F(t,e,n){t.classList[n?\"add\":\"remove\"](e)}class q{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=E(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)b(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(x)}}function j(t){c=t}function V(){if(!c)throw new Error(\"Function called outside component initialization\");return c}function N(t){V().$$.before_update.push(t)}function B(t){V().$$.on_mount.push(t)}function X(t){V().$$.on_destroy.push(t)}function W(){const t=V();return(e,n)=>{const i=t.$$.callbacks[e];if(i){const r=function(t,e,n=!1){const i=document.createEvent(\"CustomEvent\");return i.initCustomEvent(t,n,!1,e),i}(e,n);i.slice().forEach((e=>{e.call(t,r)}))}}}const Y=[],U=[],G=[],K=[],Z=Promise.resolve();let Q=!1;function J(){Q||(Q=!0,Z.then(ot))}function tt(){return J(),Z}function et(t){G.push(t)}function nt(t){K.push(t)}let it=!1;const rt=new Set;function ot(){if(!it){it=!0;do{for(let t=0;t<Y.length;t+=1){const e=Y[t];j(e),st(e.$$)}for(j(null),Y.length=0;U.length;)U.pop()();for(let t=0;t<G.length;t+=1){const e=G[t];rt.has(e)||(rt.add(e),e())}G.length=0}while(Y.length);for(;K.length;)K.pop()();Q=!1,it=!1,rt.clear()}}function st(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(et)}}const at=new Set;let lt;function ct(){lt={r:0,c:[],p:lt}}function ut(){lt.r||r(lt.c),lt=lt.p}function ht(t,e){t&&t.i&&(at.delete(t),t.i(e))}function ft(t,e,n,i){if(t&&t.o){if(at.has(t))return;at.add(t),lt.c.push((()=>{at.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function pt(t,e){const n=e.token={};function i(t,i,r,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==r&&(s=s.slice(),s[r]=o);const a=t&&(e.current=t)(s);let l=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==i&&t&&(ct(),ft(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ut())})):e.block.d(1),a.c(),ht(a,1),a.m(e.mount(),e.anchor),l=!0),e.block=a,e.blocks&&(e.blocks[i]=a),l&&ot()}if((r=t)&&\"object\"==typeof r&&\"function\"==typeof r.then){const n=V();if(t.then((t=>{j(n),i(e.then,1,e.value,t),j(null)}),(t=>{if(j(n),i(e.catch,2,e.error,t),j(null),!e.hasCatch)throw t})),e.current!==e.pending)return i(e.pending,0),!0}else{if(e.current!==e.then)return i(e.then,1,e.value,t),!0;e.resolved=t}var r}function dt(t,e,n){const i=e.slice(),{resolved:r}=t;t.current===t.then&&(i[t.value]=r),t.current===t.catch&&(i[t.error]=r),t.block.p(i,n)}function mt(t,e){ft(t,1,1,(()=>{e.delete(t.key)}))}function vt(t,e,n,i,r,o,s,a,l,c,u,h){let f=t.length,p=o.length,d=f;const m={};for(;d--;)m[t[d].key]=d;const v=[],_=new Map,y=new Map;for(d=p;d--;){const t=h(r,o,d),a=n(t);let l=s.get(a);l?i&&l.p(t,e):(l=c(a,t),l.c()),_.set(a,v[d]=l),a in m&&y.set(a,Math.abs(d-m[a]))}const g=new Set,w=new Set;function $(t){ht(t,1),t.m(a,u),s.set(t.key,t),u=t.first,p--}for(;f&&p;){const e=v[p-1],n=t[f-1],i=e.key,r=n.key;e===n?(u=e.first,f--,p--):_.has(r)?!s.has(i)||g.has(i)?$(e):w.has(r)?f--:y.get(i)>y.get(r)?(w.add(i),$(e)):(g.add(r),f--):(l(n,s),f--)}for(;f--;){const e=t[f];_.has(e.key)||l(e,s)}for(;p;)$(v[p-1]);return v}function _t(t,e){const n={},i={},r={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(i[t]=1);for(const t in a)r[t]||(n[t]=a[t],r[t]=1);t[o]=a}else for(const t in s)r[t]=1}for(const t in i)t in n||(n[t]=void 0);return n}function yt(t){return\"object\"==typeof t&&null!==t?t:{}}function gt(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function wt(t){t&&t.c()}function $t(t,e,i,s){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=t.$$;a&&a.m(e,i),s||et((()=>{const e=l.map(n).filter(o);c?c.push(...e):r(e),t.$$.on_mount=[]})),u.forEach(et)}function bt(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function xt(e,n,o,s,a,l,u,h=[-1]){const f=c;j(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:i(),dirty:h,skip_bound:!1,root:n.target||f.$$.root};u&&u(p.root);let d=!1;if(p.ctx=o?o(e,n.props||{},((t,n,...i)=>{const r=i.length?i[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),d&&function(t,e){-1===t.$$.dirty[0]&&(Y.push(t),J(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(x)}else p.fragment&&p.fragment.c();n.intro&&ht(e.$$.fragment),$t(e,n.target,n.anchor,n.customElement),ot()}j(f)}class Mt{$destroy(){bt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Et=[];function Tt(e,n=t){let i;const r=new Set;function o(t){if(s(e,t)&&(e=t,i)){const t=!Et.length;for(const t of r)t[1](),Et.push(t,e);if(t){for(let t=0;t<Et.length;t+=2)Et[t][0](Et[t+1]);Et.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const l=[s,a];return r.add(l),1===r.size&&(i=n(o)||t),s(e),()=>{r.delete(l),0===r.size&&(i(),i=null)}}}}function Lt(e,n,i){const s=!Array.isArray(e),a=s?[e]:e,l=n.length<2;return c=e=>{let i=!1;const c=[];let u=0,f=t;const p=()=>{if(u)return;f();const i=n(s?c[0]:c,e);l?e(i):f=o(i)?i:t},d=a.map(((t,e)=>h(t,(t=>{c[e]=t,u&=~(1<<e),i&&p()}),(()=>{u|=1<<e}))));return i=!0,p(),function(){r(d),f()}},{subscribe:Tt(i,c).subscribe};var c}function Ct(t){return data.series.find((e=>e.name==t))}function St(t,e,{searchLabels:n=!0}={}){return t.fields.find((t=>[t.name,...n&&t.labels?[t.labels.name]:[]].includes(e)))}function kt(t){return t.fields.find((t=>\"time\"==t.type))??t.fields.find((t=>\"Time\"==t.name||\"time\"==t.name))}function It(t,{searchLabels:e=!0,getTime:n=!0}={}){const{series:i,valueField:r}=function(t,{searchLabels:e=!0}={}){const n=Ct(t);if(n)return{series:n,valueField:St(n,\"Value\",{searchLabels:!1})??St(n,t,{searchLabels:e})};for(const n of data.series){const i=St(n,t,{searchLabels:e});if(i)return{series:n,valueField:i}}return{}}(t,{searchLabels:e});return i&&r?{valueField:r,timeField:n?kt(i):void 0}:{}}function Pt(t,{noDataValue:e=null,reducerID:n=\"last\"}={}){const{valueField:i}=It(t,{getTime:!1}),r=i?.state?.calcs?.[n]??function(t,e){const n=t?.values.length;if(!n)return null;if(\"first\"===e||\"last\"===e){const i=\"first\"===e?0:n-1,r=t?.values.get(i);return r}}(i,n);return r??e}function At(t,{noDataValue:e=null,reducerID:n}={}){let i=!1;const r=t.replace(/[\"']([^\"']*)[\"']/g,(t=>{const e=Pt(t.replace(/[\"']/g,\"\"),{reducerID:n});return null==e&&(i=!0),String(e)}));return i?e:new Function(\"return \"+r)()}function zt(t,{showcase:e,range:n,decimals:i,noDataValue:r,reducerID:o}={}){return e?function({range:t={min:0,max:1e3},decimals:e=2}={}){const n=Math.random()*(t.max-t.min)+t.min;return Number(n.toFixed(e))}({range:n,decimals:i}):t.includes('\"')||t.includes(\"'\")?At(t,{noDataValue:r,reducerID:o}):Pt(t,{noDataValue:r,reducerID:o})}function Ot(){const[t,e,n]=[\"areas\",\"scenes\",\"hotspots\"].map((t=>{let e;try{e=customProperties.editable?[]:JSON.parse(Ct(t).fields.find((t=>\"Value\"==t.name)).values.get(0))}catch(e){throw new Error(`Couldn't parse series \"${t}\": ${e}`)}if(!(e instanceof Array))throw new Error(`Series \"${t}\" is not an Array`);return e}));return t.sort(((t,e)=>t.area_key-e.area_key)),e.sort(((t,e)=>t.scene_key-e.scene_key)),n.sort(((t,e)=>Number(t.hotspot_key)-Number(e.hotspot_key))),{areas:t,scenes:e,hotspots:n}}var Rt=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:{};function Ht(t){if(t.__esModule)return t;var e=Object.defineProperty({},\"__esModule\",{value:!0});return Object.keys(t).forEach((function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})})),e}function Dt(){}Dt.prototype.addEventListener=function(t,e){var n=this.__events=this.__events||{},i=n[t]=n[t]||[];i.indexOf(e)<0&&i.push(e)},Dt.prototype.removeEventListener=function(t,e){var n=(this.__events=this.__events||{})[t];if(n){var i=n.indexOf(e);i>=0&&n.splice(i,1)}},Dt.prototype.emit=function(t,e){var n=this.__events=this.__events||{},i=n[t],r=Array.prototype.slice.call(arguments,1);if(i)for(var o=0;o<i.length;o++){var s=i[o];s.apply(this,r)}};var Ft=function(t){for(var e in Dt.prototype)Dt.prototype.hasOwnProperty(e)&&(t.prototype[e]=Dt.prototype[e])};var qt=\"undefined\"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return Date.now()},jt=qt;function Vt(t,e){this.fn=t,this.cb=e,this.cfn=null}function Nt(t){this._queue=[],this._delay=t&&t.delay||0,this._paused=t&&!!t.paused||!1,this._currentTask=null,this._lastFinished=null}Nt.prototype.length=function(){return this._queue.length},Nt.prototype.push=function(t,e){var n=new Vt(t,e),i=this._cancel.bind(this,n);return this._queue.push(n),this._next(),i},Nt.prototype.pause=function(){this._paused||(this._paused=!0)},Nt.prototype.resume=function(){this._paused&&(this._paused=!1,this._next())},Nt.prototype._start=function(t){if(this._currentTask)throw new Error(\"WorkQueue: called start while running task\");this._currentTask=t;var e=this._finish.bind(this,t);if(t.cfn=t.fn(e),\"function\"!=typeof t.cfn)throw new Error(\"WorkQueue: function is not cancellable\")},Nt.prototype._finish=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask!==t)throw new Error(\"WorkQueue: called finish on wrong task\");t.cb.apply(null,e),this._currentTask=null,this._lastFinished=jt(),this._next()},Nt.prototype._cancel=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask===t)t.cfn.apply(null,e);else{var n=this._queue.indexOf(t);n>=0&&(this._queue.splice(n,1),t.cb.apply(null,e))}},Nt.prototype._next=function(){if(!this._paused&&this._queue.length&&!this._currentTask){if(null!=this._lastFinished){var t=jt()-this._lastFinished,e=this._delay-t;if(e>0)return void setTimeout(this._next.bind(this),e)}var n=this._queue.shift();this._start(n)}};var Bt=Nt;var Xt=function(t,e,n,i){var r,o,s,a;return i=i||{},r=null!=n&&null!=n.absoluteWidth?n.absoluteWidth/t:null!=n&&null!=n.relativeWidth?n.relativeWidth:1,o=n&&null!=n.absoluteHeight?n.absoluteHeight/e:null!=n&&null!=n.relativeHeight?n.relativeHeight:1,s=null!=n&&null!=n.absoluteX?n.absoluteX/t:null!=n&&null!=n.relativeX?n.relativeX:0,a=null!=n&&null!=n.absoluteY?n.absoluteY/e:null!=n&&null!=n.relativeY?n.relativeY:0,i.x=s,i.y=a,i.width=r,i.height=o,i};var Wt=function(t){return function(e){var n,i;try{i=t()}catch(t){n=t}finally{n?e(n):e(null,i)}}};var Yt=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}},Ut=Yt;var Gt=function(t){return function(){if(!arguments.length)throw new Error(\"cancelized: expected at least one argument\");var e=Array.prototype.slice.call(arguments,0),n=e[e.length-1]=Ut(e[e.length-1]);function i(){n.apply(null,arguments)}return t.apply(null,e),i}};var Kt=function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]=void 0)};function Zt(){this._renderers={}}Zt.prototype.set=function(t,e,n){this._renderers[t]||(this._renderers[t]={}),this._renderers[t][e]=n},Zt.prototype.get=function(t,e){return this._renderers[t]&&this._renderers[t][e]||null};var Qt=Bt,Jt=Xt,te=Wt,ee=Gt,ne=Kt,ie=Zt;function re(t,e){return t.cmp(e)}function oe(t,e){return-t.cmp(e)}function se(t){this._progressive=!(!t||!t.progressive),this._layers=[],this._renderers=[],this._tilesToLoad=[],this._tilesToRender=[],this._tmpVisible=[],this._tmpChildren=[],this._width=0,this._height=0,this._tmpRect={},this._tmpSize={},this._createTextureWorkQueue=new Qt,this._emitRenderInvalid=this._emitRenderInvalid.bind(this),this._rendererRegistry=new ie}Ft(se),se.prototype.destroy=function(){this.removeAllLayers(),ne(this)},se.prototype.registerRenderer=function(t,e,n){return this._rendererRegistry.set(t,e,n)},se.prototype.domElement=function(){throw new Error(\"Stage implementation must override domElement\")},se.prototype.width=function(){return this._width},se.prototype.height=function(){return this._height},se.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},se.prototype.setSize=function(t){this._width=t.width,this._height=t.height,this.setSizeForType(),this.emit(\"resize\"),this._emitRenderInvalid()},se.prototype.setSizeForType=function(t){throw new Error(\"Stage implementation must override setSizeForType\")},se.prototype.loadImage=function(){throw new Error(\"Stage implementation must override loadImage\")},se.prototype._emitRenderInvalid=function(){this.emit(\"renderInvalid\")},se.prototype.validateLayer=function(t){throw new Error(\"Stage implementation must override validateLayer\")},se.prototype.listLayers=function(){return[].concat(this._layers)},se.prototype.hasLayer=function(t){return this._layers.indexOf(t)>=0},se.prototype.addLayer=function(t,e){if(this._layers.indexOf(t)>=0)throw new Error(\"Layer already in stage\");if(null==e&&(e=this._layers.length),e<0||e>this._layers.length)throw new Error(\"Invalid layer position\");this.validateLayer(t);var n=t.geometry().type,i=t.view().type,r=this._rendererRegistry.get(n,i);if(!r)throw new Error(\"No \"+this.type+\" renderer avaiable for \"+n+\" geometry and \"+i+\" view\");var o=this.createRenderer(r);this._layers.splice(e,0,t),this._renderers.splice(e,0,o),t.addEventListener(\"viewChange\",this._emitRenderInvalid),t.addEventListener(\"effectsChange\",this._emitRenderInvalid),t.addEventListener(\"fixedLevelChange\",this._emitRenderInvalid),t.addEventListener(\"textureStoreChange\",this._emitRenderInvalid),this._emitRenderInvalid()},se.prototype.moveLayer=function(t,e){var n=this._layers.indexOf(t);if(n<0)throw new Error(\"No such layer in stage\");if(e<0||e>=this._layers.length)throw new Error(\"Invalid layer position\");t=this._layers.splice(n,1)[0];var i=this._renderers.splice(n,1)[0];this._layers.splice(e,0,t),this._renderers.splice(e,0,i),this._emitRenderInvalid()},se.prototype.removeLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw new Error(\"No such layer in stage\");var n=this._layers.splice(e,1)[0],i=this._renderers.splice(e,1)[0];this.destroyRenderer(i),n.removeEventListener(\"viewChange\",this._emitRenderInvalid),n.removeEventListener(\"effectsChange\",this._emitRenderInvalid),n.removeEventListener(\"fixedLevelChange\",this._emitRenderInvalid),n.removeEventListener(\"textureStoreChange\",this._emitRenderInvalid),this._emitRenderInvalid()},se.prototype.removeAllLayers=function(){for(;this._layers.length>0;)this.removeLayer(this._layers[0])},se.prototype.startFrame=function(){throw new Error(\"Stage implementation must override startFrame\")},se.prototype.endFrame=function(){throw new Error(\"Stage implementation must override endFrame\")},se.prototype.render=function(){var t,e,n,i=this._tilesToLoad,r=this._tilesToRender,o=!0,s=this._width,a=this._height,l=this._tmpRect,c=this._tmpSize;if(!(s<=0||a<=0)){for(this.startFrame(),t=0;t<this._layers.length;t++)this._layers[t].textureStore().startFrame();for(t=0;t<this._layers.length;t++){var u,h,f=this._layers[t],p=f.effects(),d=f.view(),m=f.textureStore(),v=this._renderers[t],_=this._layers.length-t;if(Jt(s,a,p&&p.rect,l),!(l.width<=0||l.height<=0)){for(c.width=l.width*this._width,c.height=l.height*this._height,d.setSize(c),v.startLayer(f,l),n=this._collectTiles(f,m),e=0;e<i.length;e++)u=i[e],m.markTile(u);for(e=0;e<r.length;e++)u=r[e],h=m.texture(u),v.renderTile(u,h,f,_);f.emit(\"renderComplete\",n),n||(o=!1),v.endLayer(f,l)}}for(t=0;t<this._layers.length;t++)this._layers[t].textureStore().endFrame();this.endFrame(),this.emit(\"renderComplete\",o)}},se.prototype._collectTiles=function(t,e){var n=this._tilesToLoad,i=this._tilesToRender,r=this._tmpVisible;n.length=0,i.length=0,r.length=0,t.visibleTiles(r);for(var o=!0,s=0;s<r.length;s++){var a,l=r[s];this._collectTileToLoad(l),e.texture(l)?(a=!1,this._collectTileToRender(l)):(a=this._collectChildren(l,e),o=!1),this._collectParents(l,e,a)}return n.sort(re),i.sort(oe),o},se.prototype._collectChildren=function(t,e){var n=this._tmpChildren,i=!0;do{if(n.length=0,!t.children(n))break;i=!1;for(var r=0;r<n.length;r++)t=n[r],e.texture(t)?(this._collectTileToLoad(t),this._collectTileToRender(t)):i=!0}while(i&&1===n.length);return i},se.prototype._collectParents=function(t,e,n){for(var i=this._progressive;(i||n)&&null!=(t=t.parent());){if(n)if(e.texture(t))this._collectTileToRender(t),n=!1;else if(!this._progressive)continue;this._collectTileToLoad(t)||(i=!1)}return n},se.prototype._collectTileToLoad=function(t){return this._collectTileIntoList(t,this._tilesToLoad)},se.prototype._collectTileToRender=function(t){return this._collectTileIntoList(t,this._tilesToRender)},se.prototype._collectTileIntoList=function(t,e){for(var n=!1,i=0;i<e.length;i++)if(t.equals(e[i])){n=!0;break}return n||e.push(t),!n},se.prototype.createTexture=function(t,e,n){var i=this;var r=ee(te((function(){return new i.TextureClass(i,t,e)})));return this._createTextureWorkQueue.push(r,(function(i,r){n(i,t,e,r)}))};var ae=se,le=\"undefined\"!=typeof window?window:\"undefined\"!=typeof self?self:void 0!==Rt?Rt:null,ce=le,ue=Kt,he={HTMLImageElement:[\"naturalWidth\",\"naturalHeight\"],HTMLCanvasElement:[\"width\",\"height\"],ImageBitmap:[\"width\",\"height\"]};function fe(t){var e=!1;for(var n in he)if(ce[n]&&t instanceof ce[n]){e=!0,this._widthProp=he[n][0],this._heightProp=he[n][1];break}if(!e)throw new Error(\"Unsupported pixel source\");this._element=t}Ft(fe),fe.prototype.destroy=function(){ue(this)},fe.prototype.element=function(){return this._element},fe.prototype.width=function(){return this._element[this._widthProp]},fe.prototype.height=function(){return this._element[this._heightProp]},fe.prototype.timestamp=function(){return 0},fe.prototype.isDynamic=function(){return!1};var pe=fe;var de=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t};function me(t){this.constructor.super_.apply(this,arguments),this.message=t}de(me,Error);var ve,_e,ye,ge=me,we={exports:{}};_e=Rt,ye=function(){var t=!0;function e(e){function n(t){var n=e.match(t);return n&&n.length>1&&n[1]||\"\"}function i(t){var n=e.match(t);return n&&n.length>1&&n[2]||\"\"}var r=n(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(e)&&/android/i.test(e),a=/nexus\\s*[0-6]\\s*/i.test(e),l=!a&&/nexus\\s*[0-9]+/i.test(e),c=/CrOS/.test(e),u=/silk/i.test(e),h=/sailfish/i.test(e),f=/tizen/i.test(e),p=/(web|hpw)(o|0)s/i.test(e),d=/windows phone/i.test(e);/SamsungBrowser/i.test(e);var m,v=!d&&/windows/i.test(e),_=!r&&!u&&/macintosh/i.test(e),y=!s&&!h&&!f&&!p&&/linux/i.test(e),g=i(/edg([ea]|ios)\\/(\\d+(\\.\\d+)?)/i),w=n(/version\\/(\\d+(\\.\\d+)?)/i),$=/tablet/i.test(e)&&!/tablet pc/i.test(e),b=!$&&/[^-]mobi/i.test(e),x=/xbox/i.test(e);/opera/i.test(e)?m={name:\"Opera\",opera:t,version:w||n(/(?:opera|opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i)}:/opr\\/|opios/i.test(e)?m={name:\"Opera\",opera:t,version:n(/(?:opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i)||w}:/SamsungBrowser/i.test(e)?m={name:\"Samsung Internet for Android\",samsungBrowser:t,version:w||n(/(?:SamsungBrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)}:/Whale/i.test(e)?m={name:\"NAVER Whale browser\",whale:t,version:n(/(?:whale)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/MZBrowser/i.test(e)?m={name:\"MZ Browser\",mzbrowser:t,version:n(/(?:MZBrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/coast/i.test(e)?m={name:\"Opera Coast\",coast:t,version:w||n(/(?:coast)[\\s\\/](\\d+(\\.\\d+)?)/i)}:/focus/i.test(e)?m={name:\"Focus\",focus:t,version:n(/(?:focus)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/yabrowser/i.test(e)?m={name:\"Yandex Browser\",yandexbrowser:t,version:w||n(/(?:yabrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)}:/ucbrowser/i.test(e)?m={name:\"UC Browser\",ucbrowser:t,version:n(/(?:ucbrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/mxios/i.test(e)?m={name:\"Maxthon\",maxthon:t,version:n(/(?:mxios)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/epiphany/i.test(e)?m={name:\"Epiphany\",epiphany:t,version:n(/(?:epiphany)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/puffin/i.test(e)?m={name:\"Puffin\",puffin:t,version:n(/(?:puffin)[\\s\\/](\\d+(?:\\.\\d+)?)/i)}:/sleipnir/i.test(e)?m={name:\"Sleipnir\",sleipnir:t,version:n(/(?:sleipnir)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:/k-meleon/i.test(e)?m={name:\"K-Meleon\",kMeleon:t,version:n(/(?:k-meleon)[\\s\\/](\\d+(?:\\.\\d+)+)/i)}:d?(m={name:\"Windows Phone\",osname:\"Windows Phone\",windowsphone:t},g?(m.msedge=t,m.version=g):(m.msie=t,m.version=n(/iemobile\\/(\\d+(\\.\\d+)?)/i))):/msie|trident/i.test(e)?m={name:\"Internet Explorer\",msie:t,version:n(/(?:msie |rv:)(\\d+(\\.\\d+)?)/i)}:c?m={name:\"Chrome\",osname:\"Chrome OS\",chromeos:t,chromeBook:t,chrome:t,version:n(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?m={name:\"Microsoft Edge\",msedge:t,version:g}:/vivaldi/i.test(e)?m={name:\"Vivaldi\",vivaldi:t,version:n(/vivaldi\\/(\\d+(\\.\\d+)?)/i)||w}:h?m={name:\"Sailfish\",osname:\"Sailfish OS\",sailfish:t,version:n(/sailfish\\s?browser\\/(\\d+(\\.\\d+)?)/i)}:/seamonkey\\//i.test(e)?m={name:\"SeaMonkey\",seamonkey:t,version:n(/seamonkey\\/(\\d+(\\.\\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(m={name:\"Firefox\",firefox:t,version:n(/(?:firefox|iceweasel|fxios)[ \\/](\\d+(\\.\\d+)?)/i)},/\\((mobile|tablet);[^\\)]*rv:[\\d\\.]+\\)/i.test(e)&&(m.firefoxos=t,m.osname=\"Firefox OS\")):u?m={name:\"Amazon Silk\",silk:t,version:n(/silk\\/(\\d+(\\.\\d+)?)/i)}:/phantom/i.test(e)?m={name:\"PhantomJS\",phantom:t,version:n(/phantomjs\\/(\\d+(\\.\\d+)?)/i)}:/slimerjs/i.test(e)?m={name:\"SlimerJS\",slimer:t,version:n(/slimerjs\\/(\\d+(\\.\\d+)?)/i)}:/blackberry|\\bbb\\d+/i.test(e)||/rim\\stablet/i.test(e)?m={name:\"BlackBerry\",osname:\"BlackBerry OS\",blackberry:t,version:w||n(/blackberry[\\d]+\\/(\\d+(\\.\\d+)?)/i)}:p?(m={name:\"WebOS\",osname:\"WebOS\",webos:t,version:w||n(/w(?:eb)?osbrowser\\/(\\d+(\\.\\d+)?)/i)},/touchpad\\//i.test(e)&&(m.touchpad=t)):/bada/i.test(e)?m={name:\"Bada\",osname:\"Bada\",bada:t,version:n(/dolfin\\/(\\d+(\\.\\d+)?)/i)}:f?m={name:\"Tizen\",osname:\"Tizen\",tizen:t,version:n(/(?:tizen\\s?)?browser\\/(\\d+(\\.\\d+)?)/i)||w}:/qupzilla/i.test(e)?m={name:\"QupZilla\",qupzilla:t,version:n(/(?:qupzilla)[\\s\\/](\\d+(?:\\.\\d+)+)/i)||w}:/chromium/i.test(e)?m={name:\"Chromium\",chromium:t,version:n(/(?:chromium)[\\s\\/](\\d+(?:\\.\\d+)?)/i)||w}:/chrome|crios|crmo/i.test(e)?m={name:\"Chrome\",chrome:t,version:n(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)}:s?m={name:\"Android\",version:w}:/safari|applewebkit/i.test(e)?(m={name:\"Safari\",safari:t},w&&(m.version=w)):r?(m={name:\"iphone\"==r?\"iPhone\":\"ipad\"==r?\"iPad\":\"iPod\"},w&&(m.version=w)):m=/googlebot/i.test(e)?{name:\"Googlebot\",googlebot:t,version:n(/googlebot\\/(\\d+(\\.\\d+))/i)||w}:{name:n(/^(.*)\\/(.*) /),version:i(/^(.*)\\/(.*) /)},!m.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\\/537\\.36/i.test(e)?(m.name=m.name||\"Blink\",m.blink=t):(m.name=m.name||\"Webkit\",m.webkit=t),!m.version&&w&&(m.version=w)):!m.opera&&/gecko\\//i.test(e)&&(m.name=m.name||\"Gecko\",m.gecko=t,m.version=m.version||n(/gecko\\/(\\d+(\\.\\d+)?)/i)),m.windowsphone||!s&&!m.silk?!m.windowsphone&&r?(m[r]=t,m.ios=t,m.osname=\"iOS\"):_?(m.mac=t,m.osname=\"macOS\"):x?(m.xbox=t,m.osname=\"Xbox\"):v?(m.windows=t,m.osname=\"Windows\"):y&&(m.linux=t,m.osname=\"Linux\"):(m.android=t,m.osname=\"Android\");var M=\"\";m.windows?M=function(t){switch(t){case\"NT\":return\"NT\";case\"XP\":case\"NT 5.1\":return\"XP\";case\"NT 5.0\":return\"2000\";case\"NT 5.2\":return\"2003\";case\"NT 6.0\":return\"Vista\";case\"NT 6.1\":return\"7\";case\"NT 6.2\":return\"8\";case\"NT 6.3\":return\"8.1\";case\"NT 10.0\":return\"10\";default:return}}(n(/Windows ((NT|XP)( \\d\\d?.\\d)?)/i)):m.windowsphone?M=n(/windows phone (?:os)?\\s?(\\d+(\\.\\d+)*)/i):m.mac?M=(M=n(/Mac OS X (\\d+([_\\.\\s]\\d+)*)/i)).replace(/[_\\s]/g,\".\"):r?M=(M=n(/os (\\d+([_\\s]\\d+)*) like mac os x/i)).replace(/[_\\s]/g,\".\"):s?M=n(/android[ \\/-](\\d+(\\.\\d+)*)/i):m.webos?M=n(/(?:web|hpw)os\\/(\\d+(\\.\\d+)*)/i):m.blackberry?M=n(/rim\\stablet\\sos\\s(\\d+(\\.\\d+)*)/i):m.bada?M=n(/bada\\/(\\d+(\\.\\d+)*)/i):m.tizen&&(M=n(/tizen[\\/\\s](\\d+(\\.\\d+)*)/i)),M&&(m.osversion=M);var E=!m.windows&&M.split(\".\")[0];return $||l||\"ipad\"==r||s&&(3==E||E>=4&&!b)||m.silk?m.tablet=t:(b||\"iphone\"==r||\"ipod\"==r||s||a||m.blackberry||m.webos||m.bada)&&(m.mobile=t),m.msedge||m.msie&&m.version>=10||m.yandexbrowser&&m.version>=15||m.vivaldi&&m.version>=1||m.chrome&&m.version>=20||m.samsungBrowser&&m.version>=4||m.whale&&1===o([m.version,\"1.0\"])||m.mzbrowser&&1===o([m.version,\"6.0\"])||m.focus&&1===o([m.version,\"1.0\"])||m.firefox&&m.version>=20||m.safari&&m.version>=6||m.opera&&m.version>=10||m.ios&&m.osversion&&m.osversion.split(\".\")[0]>=6||m.blackberry&&m.version>=10.1||m.chromium&&m.version>=20?m.a=t:m.msie&&m.version<10||m.chrome&&m.version<20||m.firefox&&m.version<20||m.safari&&m.version<6||m.opera&&m.version<10||m.ios&&m.osversion&&m.osversion.split(\".\")[0]<6||m.chromium&&m.version<20?m.c=t:m.x=t,m}var n=e(\"undefined\"!=typeof navigator&&navigator.userAgent||\"\");function i(t){return t.split(\".\").length}function r(t,e){var n,i=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(n=0;n<t.length;n++)i.push(e(t[n]));return i}function o(t){for(var e=Math.max(i(t[0]),i(t[1])),n=r(t,(function(t){var n=e-i(t);return r((t+=new Array(n+1).join(\".0\")).split(\".\"),(function(t){return new Array(20-t.length).join(\"0\")+t})).reverse()}));--e>=0;){if(n[0][e]>n[1][e])return 1;if(n[0][e]!==n[1][e])return-1;if(0===e)return 0}}function s(t,i,r){var s=n;\"string\"==typeof i&&(r=i,i=void 0),void 0===i&&(i=!1),r&&(s=e(r));var a=\"\"+s.version;for(var l in t)if(t.hasOwnProperty(l)&&s[l]){if(\"string\"!=typeof t[l])throw new Error(\"Browser version in the minVersion map should be a string: \"+l+\": \"+String(t));return o([a,t[l]])<0}return i}return n.test=function(t){for(var e=0;e<t.length;++e){var i=t[e];if(\"string\"==typeof i&&i in n)return!0}return!1},n.isUnsupportedBrowser=s,n.compareVersions=o,n.check=function(t,e,n){return!s(t,e,n)},n._detect=e,n.detect=e,n},(\n/*!\n     * Bowser - a browser detector\n     * https://github.com/ded/bowser\n     * MIT License | (c) Dustin Diaz 2015\n     */\nve=we).exports?ve.exports=ye():_e.bowser=ye();var $e=pe,be=ge,xe=we.exports,Me=le,Ee=Yt,Te=!!Me.createImageBitmap&&!xe.firefox,Le={imageOrientation:\"flipY\",premultiplyAlpha:\"premultiply\"};function Ce(t){this._stage=t}Ce.prototype.loadImage=function(t,e,n){var i=this,r=new Image;r.crossOrigin=\"anonymous\";var o=e&&e.x||0,s=e&&e.y||0,a=e&&e.width||1,l=e&&e.height||1;return n=Ee(n),r.onload=function(){i._handleLoad(r,o,s,a,l,n)},r.onerror=function(){i._handleError(t,n)},r.src=t,function(){r.onload=r.onerror=null,r.src=\"\",n.apply(null,arguments)}},Ce.prototype._handleLoad=function(t,e,n,i,r,o){if(0!==e||0!==n||1!==i||1!==r)if(e*=t.naturalWidth,n*=t.naturalHeight,i*=t.naturalWidth,r*=t.naturalHeight,Te)Me.createImageBitmap(t,e,n,i,r,Le).then((function(t){o(null,new $e(t))}));else{var s=document.createElement(\"canvas\");s.width=i,s.height=r,s.getContext(\"2d\").drawImage(t,e,n,i,r,0,0,i,r),o(null,new $e(s))}else o(null,new $e(t))},Ce.prototype._handleError=function(t,e){e(new be(\"Network error: \"+t))};var Se=Ce;var ke=function(){if(\"undefined\"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t&&t.deviceXDPI&&t.logicalXDPI)return t.deviceXDPI/t.logicalXDPI;if(t&&t.systemXDPI&&t.logicalXDPI)return t.systemXDPI/t.logicalXDPI}return 1};var Ie=function(t){return 0==(t&t-1)};function Pe(t){for(var e=document.documentElement.style,n=[\"Moz\",\"Webkit\",\"Khtml\",\"O\",\"ms\"],i=0;i<n.length;i++){var r=n[i]+(t[0].toUpperCase()+t.slice(1));if(r in e)return r}return t}function Ae(t){var e=Pe(t);return function(t,n){return t.style[e]=n}}var ze=Ae(\"transform\"),Oe=Ae(\"transformOrigin\");var Re={prefixProperty:Pe,getWithVendorPrefix:function(t){var e=Pe(t);return function(t){return t.style[e]}},setWithVendorPrefix:Ae,setTransform:ze,setTransformOrigin:Oe,setNullTransform:function(t){ze(t,\"translateZ(0)\")},setNullTransformOrigin:function(t){Oe(t,\"0 0 0\")},setAbsolute:function(t){t.style.position=\"absolute\"},setPixelPosition:function(t,e,n){t.style.left=e+\"px\",t.style.top=n+\"px\"},setPixelSize:function(t,e,n){t.style.width=e+\"px\",t.style.height=n+\"px\"},setNullSize:function(t){t.style.width=t.style.height=0},setFullSize:function(t){t.style.width=t.style.height=\"100%\"},setOverflowHidden:function(t){t.style.overflow=\"hidden\"},setOverflowVisible:function(t){t.style.overflow=\"visible\"},setNoPointerEvents:function(t){t.style.pointerEvents=\"none\"}},He=ae,De=Se,Fe=we.exports,qe=de,je=ke,Ve=Ie,Ne=Re.setAbsolute,Be=Re.setFullSize,Xe=Kt,We=Fe.chrome;function Ye(t){t=t||{};var e=this;this.constructor.super_.call(this,t),this._generateMipmaps=null!=t.generateMipmaps&&t.generateMipmaps,this._loader=new De(this),this._domElement=document.createElement(\"canvas\"),Ne(this._domElement),Be(this._domElement),this._gl=function(t,e){var n={alpha:!0,premultipliedAlpha:!0,antialias:!(!e||!e.antialias),preserveDrawingBuffer:!(!e||!e.preserveDrawingBuffer)},i=t.getContext&&(t.getContext(\"webgl\",n)||t.getContext(\"experimental-webgl\",n));if(!i)throw new Error(\"Could not get WebGL context\");return e.wrapContext&&(i=e.wrapContext(i)),i}(this._domElement,t),this._handleContextLoss=function(){e.emit(\"webglcontextlost\"),e._gl=null},this._domElement.addEventListener(\"webglcontextlost\",this._handleContextLoss),this._rendererInstances=[]}function Ue(t,e,n){this._stage=t,this._gl=t._gl,this._texture=null,this._timestamp=null,this._width=this._height=null,this.refresh(e,n)}qe(Ye,He),Ye.prototype.destroy=function(){this._domElement.removeEventListener(\"webglcontextlost\",this._handleContextLoss),this.constructor.super_.prototype.destroy.call(this)},Ye.prototype.domElement=function(){return this._domElement},Ye.prototype.webGlContext=function(){return this._gl},Ye.prototype.setSizeForType=function(){var t=je();this._domElement.width=t*this._width,this._domElement.height=t*this._height},Ye.prototype.loadImage=function(t,e,n){return this._loader.loadImage(t,e,n)},Ye.prototype.maxTextureSize=function(){return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE)},Ye.prototype.validateLayer=function(t){var e=t.geometry().maxTileSize(),n=this.maxTextureSize();if(e>n)throw new Error(\"Layer has level with tile size larger than maximum texture size (\"+e+\" vs. \"+n+\")\")},Ye.prototype.createRenderer=function(t){for(var e=this._rendererInstances,n=0;n<e.length;n++)if(e[n]instanceof t)return e[n];var i=new t(this._gl);return e.push(i),i},Ye.prototype.destroyRenderer=function(t){var e=this._rendererInstances;if(this._renderers.indexOf(t)<0){t.destroy();var n=e.indexOf(t);n>=0&&e.splice(n,1)}},Ye.prototype.startFrame=function(){var t=this._gl;if(!t)throw new Error(\"Bad WebGL context - maybe context was lost?\");t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},Ye.prototype.endFrame=function(){},Ye.prototype.takeSnapshot=function(t){\"object\"==typeof t&&null!=t||(t={});var e=t.quality;if(void 0===e&&(e=75),\"number\"!=typeof e||e<0||e>100)throw new Error(\"WebGLStage: Snapshot quality needs to be a number between 0 and 100\");return this.render(),this._domElement.toDataURL(\"image/jpeg\",e/100)},Ye.type=Ye.prototype.type=\"webgl\",Ue.prototype.refresh=function(t,e){var n,i=this._gl,r=this._stage,o=e.timestamp();if(o!==this._timestamp){var s=e.element(),a=e.width(),l=e.height();if(a!==this._width||l!==this._height){var c=r.maxTextureSize();if(a>c)throw new Error(\"Texture width larger than max size (\"+a+\" vs. \"+c+\")\");if(l>c)throw new Error(\"Texture height larger than max size (\"+l+\" vs. \"+c+\")\");this._texture&&i.deleteTexture(n),n=this._texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,n),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s)}else n=this._texture,i.bindTexture(i.TEXTURE_2D,n),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s instanceof HTMLVideoElement&&We?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s):i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,s);r._generateMipmaps&&Ve(a)&&Ve(l)?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_LINEAR),i.generateMipmap(i.TEXTURE_2D)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null),this._timestamp=o,this._width=a,this._height=l}},Ue.prototype.destroy=function(){this._texture&&this._gl.deleteTexture(this._texture),Xe(this)},Ye.TextureClass=Ye.prototype.TextureClass=Ue;var Ge=Ye,Ke=1e-6,Ze=\"undefined\"!=typeof Float32Array?Float32Array:Array,Qe=Math.random;var Je=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var tn=Object.freeze({__proto__:null,EPSILON:Ke,get ARRAY_TYPE(){return Ze},RANDOM:Qe,setMatrixArrayType:function(t){Ze=t},toRadian:function(t){return t*Je},equals:function(t,e){return Math.abs(t-e)<=Ke*Math.max(1,Math.abs(t),Math.abs(e))}});function en(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*a+o*l,t[1]=r*a+s*l,t[2]=i*c+o*u,t[3]=r*c+s*u,t}function nn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}var rn=en,on=nn,sn=Object.freeze({__proto__:null,create:function(){var t=new Ze(4);return Ze!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},clone:function(t){var e=new Ze(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},fromValues:function(t,e,n,i){var r=new Ze(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},set:function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},transpose:function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},invert:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*o-r*i;return s?(s=1/s,t[0]=o*s,t[1]=-i*s,t[2]=-r*s,t[3]=n*s,t):null},adjoint:function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:en,rotate:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*a,t[1]=r*l+s*a,t[2]=i*-a+o*l,t[3]=r*-a+s*l,t},scale:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1];return t[0]=i*a,t[1]=r*a,t[2]=o*l,t[3]=s*l,t},fromRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},str:function(t){return\"mat2(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3])},LDU:function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},subtract:nn,exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},equals:function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=Ke*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=Ke*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-l)<=Ke*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-c)<=Ke*Math.max(1,Math.abs(o),Math.abs(c))},multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},multiplyScalarAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},mul:rn,sub:on});function an(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=n[0],u=n[1],h=n[2],f=n[3],p=n[4],d=n[5];return t[0]=i*c+o*u,t[1]=r*c+s*u,t[2]=i*h+o*f,t[3]=r*h+s*f,t[4]=i*p+o*d+a,t[5]=r*p+s*d+l,t}function ln(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}var cn=an,un=ln,hn=Object.freeze({__proto__:null,create:function(){var t=new Ze(6);return Ze!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},clone:function(t){var e=new Ze(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},fromValues:function(t,e,n,i,r,o){var s=new Ze(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s[4]=r,s[5]=o,s},set:function(t,e,n,i,r,o,s){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=s,t},invert:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=n*o-i*r;return l?(l=1/l,t[0]=o*l,t[1]=-i*l,t[2]=-r*l,t[3]=n*l,t[4]=(r*a-o*s)*l,t[5]=(i*s-n*a)*l,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:an,rotate:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=Math.sin(n),u=Math.cos(n);return t[0]=i*u+o*c,t[1]=r*u+s*c,t[2]=i*-c+o*u,t[3]=r*-c+s*u,t[4]=a,t[5]=l,t},scale:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=i*c,t[1]=r*c,t[2]=o*u,t[3]=s*u,t[4]=a,t[5]=l,t},translate:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=i*c+o*u+a,t[5]=r*c+s*u+l,t},fromRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},str:function(t){return\"mat2d(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\")\"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},subtract:ln,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},multiplyScalarAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},equals:function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],p=e[5];return Math.abs(n-l)<=Ke*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-c)<=Ke*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-u)<=Ke*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-h)<=Ke*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-f)<=Ke*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-p)<=Ke*Math.max(1,Math.abs(a),Math.abs(p))},mul:cn,sub:un});function fn(){var t=new Ze(9);return Ze!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function pn(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],p=n[1],d=n[2],m=n[3],v=n[4],_=n[5],y=n[6],g=n[7],w=n[8];return t[0]=f*i+p*s+d*c,t[1]=f*r+p*a+d*u,t[2]=f*o+p*l+d*h,t[3]=m*i+v*s+_*c,t[4]=m*r+v*a+_*u,t[5]=m*o+v*l+_*h,t[6]=y*i+g*s+w*c,t[7]=y*r+g*a+w*u,t[8]=y*o+g*l+w*h,t}function dn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}var mn=pn,vn=dn,_n=Object.freeze({__proto__:null,create:fn,fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},clone:function(t){var e=new Ze(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},fromValues:function(t,e,n,i,r,o,s,a,l){var c=new Ze(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=i,c[4]=r,c[5]=o,c[6]=s,c[7]=a,c[8]=l,c},set:function(t,e,n,i,r,o,s,a,l,c){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=c,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*s-a*c,f=-u*o+a*l,p=c*o-s*l,d=n*h+i*f+r*p;return d?(d=1/d,t[0]=h*d,t[1]=(-u*i+r*c)*d,t[2]=(a*i-r*s)*d,t[3]=f*d,t[4]=(u*n-r*l)*d,t[5]=(-a*n+r*o)*d,t[6]=p*d,t[7]=(-c*n+i*l)*d,t[8]=(s*n-i*o)*d,t):null},adjoint:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=s*u-a*c,t[1]=r*c-i*u,t[2]=i*a-r*s,t[3]=a*l-o*u,t[4]=n*u-r*l,t[5]=r*o-n*a,t[6]=o*c-s*l,t[7]=i*l-n*c,t[8]=n*s-i*o,t},determinant:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8];return e*(c*o-s*l)+n*(-c*r+s*a)+i*(l*r-o*a)},multiply:pn,translate:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],p=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=f*i+p*s+c,t[7]=f*r+p*a+u,t[8]=f*o+p*l+h,t},rotate:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(n),p=Math.cos(n);return t[0]=p*i+f*s,t[1]=p*r+f*a,t[2]=p*o+f*l,t[3]=p*s-f*i,t[4]=p*a-f*r,t[5]=p*l-f*o,t[6]=c,t[7]=u,t[8]=h,t},scale:function(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},fromRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},fromQuat:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,f=r*s,p=r*a,d=r*l,m=o*s,v=o*a,_=o*l;return t[0]=1-h-d,t[3]=u-_,t[6]=f+v,t[1]=u+_,t[4]=1-c-d,t[7]=p-m,t[2]=f-v,t[5]=p+m,t[8]=1-c-h,t},normalFromMat4:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],v=e[14],_=e[15],y=n*a-i*s,g=n*l-r*s,w=n*c-o*s,$=i*l-r*a,b=i*c-o*a,x=r*c-o*l,M=u*m-h*d,E=u*v-f*d,T=u*_-p*d,L=h*v-f*m,C=h*_-p*m,S=f*_-p*v,k=y*S-g*C+w*L+$*T-b*E+x*M;return k?(k=1/k,t[0]=(a*S-l*C+c*L)*k,t[1]=(l*T-s*S-c*E)*k,t[2]=(s*C-a*T+c*M)*k,t[3]=(r*C-i*S-o*L)*k,t[4]=(n*S-r*T+o*E)*k,t[5]=(i*T-n*C-o*M)*k,t[6]=(m*x-v*b+_*$)*k,t[7]=(v*w-d*x-_*g)*k,t[8]=(d*b-m*w+_*y)*k,t):null},projection:function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return\"mat3(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\", \"+t[6]+\", \"+t[7]+\", \"+t[8]+\")\"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},subtract:dn,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},multiplyScalarAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},equals:function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=e[0],f=e[1],p=e[2],d=e[3],m=e[4],v=e[5],_=e[6],y=e[7],g=e[8];return Math.abs(n-h)<=Ke*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-f)<=Ke*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(r-p)<=Ke*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-d)<=Ke*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-m)<=Ke*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(a-v)<=Ke*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(l-_)<=Ke*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-y)<=Ke*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-g)<=Ke*Math.max(1,Math.abs(u),Math.abs(g))},mul:mn,sub:vn});function yn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gn(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],p=e[10],d=e[11],m=e[12],v=e[13],_=e[14],y=e[15],g=n[0],w=n[1],$=n[2],b=n[3];return t[0]=g*i+w*a+$*h+b*m,t[1]=g*r+w*l+$*f+b*v,t[2]=g*o+w*c+$*p+b*_,t[3]=g*s+w*u+$*d+b*y,g=n[4],w=n[5],$=n[6],b=n[7],t[4]=g*i+w*a+$*h+b*m,t[5]=g*r+w*l+$*f+b*v,t[6]=g*o+w*c+$*p+b*_,t[7]=g*s+w*u+$*d+b*y,g=n[8],w=n[9],$=n[10],b=n[11],t[8]=g*i+w*a+$*h+b*m,t[9]=g*r+w*l+$*f+b*v,t[10]=g*o+w*c+$*p+b*_,t[11]=g*s+w*u+$*d+b*y,g=n[12],w=n[13],$=n[14],b=n[15],t[12]=g*i+w*a+$*h+b*m,t[13]=g*r+w*l+$*f+b*v,t[14]=g*o+w*c+$*p+b*_,t[15]=g*s+w*u+$*d+b*y,t}function wn(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=i+i,l=r+r,c=o+o,u=i*a,h=i*l,f=i*c,p=r*l,d=r*c,m=o*c,v=s*a,_=s*l,y=s*c;return t[0]=1-(p+m),t[1]=h+y,t[2]=f-_,t[3]=0,t[4]=h-y,t[5]=1-(u+m),t[6]=d+v,t[7]=0,t[8]=f+_,t[9]=d-v,t[10]=1-(u+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function $n(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function bn(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],s=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(l,c,u),t}function xn(t,e){var n=new Ze(3);bn(n,e);var i=1/n[0],r=1/n[1],o=1/n[2],s=e[0]*i,a=e[1]*r,l=e[2]*o,c=e[4]*i,u=e[5]*r,h=e[6]*o,f=e[8]*i,p=e[9]*r,d=e[10]*o,m=s+u+d,v=0;return m>0?(v=2*Math.sqrt(m+1),t[3]=.25*v,t[0]=(h-p)/v,t[1]=(f-l)/v,t[2]=(a-c)/v):s>u&&s>d?(v=2*Math.sqrt(1+s-u-d),t[3]=(h-p)/v,t[0]=.25*v,t[1]=(a+c)/v,t[2]=(f+l)/v):u>d?(v=2*Math.sqrt(1+u-s-d),t[3]=(f-l)/v,t[0]=(a+c)/v,t[1]=.25*v,t[2]=(h+p)/v):(v=2*Math.sqrt(1+d-s-u),t[3]=(a-c)/v,t[0]=(f+l)/v,t[1]=(h+p)/v,t[2]=.25*v),t}function Mn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}var En=gn,Tn=Mn,Ln=Object.freeze({__proto__:null,create:function(){var t=new Ze(16);return Ze!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},clone:function(t){var e=new Ze(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},fromValues:function(t,e,n,i,r,o,s,a,l,c,u,h,f,p,d,m){var v=new Ze(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=i,v[4]=r,v[5]=o,v[6]=s,v[7]=a,v[8]=l,v[9]=c,v[10]=u,v[11]=h,v[12]=f,v[13]=p,v[14]=d,v[15]=m,v},set:function(t,e,n,i,r,o,s,a,l,c,u,h,f,p,d,m,v){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=p,t[13]=d,t[14]=m,t[15]=v,t},identity:yn,transpose:function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},invert:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],v=e[14],_=e[15],y=n*a-i*s,g=n*l-r*s,w=n*c-o*s,$=i*l-r*a,b=i*c-o*a,x=r*c-o*l,M=u*m-h*d,E=u*v-f*d,T=u*_-p*d,L=h*v-f*m,C=h*_-p*m,S=f*_-p*v,k=y*S-g*C+w*L+$*T-b*E+x*M;return k?(k=1/k,t[0]=(a*S-l*C+c*L)*k,t[1]=(r*C-i*S-o*L)*k,t[2]=(m*x-v*b+_*$)*k,t[3]=(f*b-h*x-p*$)*k,t[4]=(l*T-s*S-c*E)*k,t[5]=(n*S-r*T+o*E)*k,t[6]=(v*w-d*x-_*g)*k,t[7]=(u*x-f*w+p*g)*k,t[8]=(s*C-a*T+c*M)*k,t[9]=(i*T-n*C-o*M)*k,t[10]=(d*b-m*w+_*y)*k,t[11]=(h*w-u*b-p*y)*k,t[12]=(a*E-s*L-l*M)*k,t[13]=(n*L-i*E+r*M)*k,t[14]=(m*g-d*$-v*y)*k,t[15]=(u*$-h*g+f*y)*k,t):null},adjoint:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],v=e[14],_=e[15];return t[0]=a*(f*_-p*v)-h*(l*_-c*v)+m*(l*p-c*f),t[1]=-(i*(f*_-p*v)-h*(r*_-o*v)+m*(r*p-o*f)),t[2]=i*(l*_-c*v)-a*(r*_-o*v)+m*(r*c-o*l),t[3]=-(i*(l*p-c*f)-a*(r*p-o*f)+h*(r*c-o*l)),t[4]=-(s*(f*_-p*v)-u*(l*_-c*v)+d*(l*p-c*f)),t[5]=n*(f*_-p*v)-u*(r*_-o*v)+d*(r*p-o*f),t[6]=-(n*(l*_-c*v)-s*(r*_-o*v)+d*(r*c-o*l)),t[7]=n*(l*p-c*f)-s*(r*p-o*f)+u*(r*c-o*l),t[8]=s*(h*_-p*m)-u*(a*_-c*m)+d*(a*p-c*h),t[9]=-(n*(h*_-p*m)-u*(i*_-o*m)+d*(i*p-o*h)),t[10]=n*(a*_-c*m)-s*(i*_-o*m)+d*(i*c-o*a),t[11]=-(n*(a*p-c*h)-s*(i*p-o*h)+u*(i*c-o*a)),t[12]=-(s*(h*v-f*m)-u*(a*v-l*m)+d*(a*f-l*h)),t[13]=n*(h*v-f*m)-u*(i*v-r*m)+d*(i*f-r*h),t[14]=-(n*(a*v-l*m)-s*(i*v-r*m)+d*(i*l-r*a)),t[15]=n*(a*f-l*h)-s*(i*f-r*h)+u*(i*l-r*a),t},determinant:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],p=t[12],d=t[13],m=t[14],v=t[15];return(e*s-n*o)*(h*v-f*m)-(e*a-i*o)*(u*v-f*d)+(e*l-r*o)*(u*m-h*d)+(n*a-i*s)*(c*v-f*p)-(n*l-r*s)*(c*m-h*p)+(i*l-r*a)*(c*d-u*p)},multiply:gn,translate:function(t,e,n){var i,r,o,s,a,l,c,u,h,f,p,d,m=n[0],v=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*_+e[12],t[13]=e[1]*m+e[5]*v+e[9]*_+e[13],t[14]=e[2]*m+e[6]*v+e[10]*_+e[14],t[15]=e[3]*m+e[7]*v+e[11]*_+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=i*m+a*v+h*_+e[12],t[13]=r*m+l*v+f*_+e[13],t[14]=o*m+c*v+p*_+e[14],t[15]=s*m+u*v+d*_+e[15]),t},scale:function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},rotate:function(t,e,n,i){var r,o,s,a,l,c,u,h,f,p,d,m,v,_,y,g,w,$,b,x,M,E,T,L,C=i[0],S=i[1],k=i[2],I=Math.hypot(C,S,k);return I<Ke?null:(C*=I=1/I,S*=I,k*=I,r=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],l=e[1],c=e[2],u=e[3],h=e[4],f=e[5],p=e[6],d=e[7],m=e[8],v=e[9],_=e[10],y=e[11],g=C*C*s+o,w=S*C*s+k*r,$=k*C*s-S*r,b=C*S*s-k*r,x=S*S*s+o,M=k*S*s+C*r,E=C*k*s+S*r,T=S*k*s-C*r,L=k*k*s+o,t[0]=a*g+h*w+m*$,t[1]=l*g+f*w+v*$,t[2]=c*g+p*w+_*$,t[3]=u*g+d*w+y*$,t[4]=a*b+h*x+m*M,t[5]=l*b+f*x+v*M,t[6]=c*b+p*x+_*M,t[7]=u*b+d*x+y*M,t[8]=a*E+h*T+m*L,t[9]=l*E+f*T+v*L,t[10]=c*E+p*T+_*L,t[11]=u*E+d*T+y*L,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},rotateX:function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=s*r+u*i,t[6]=a*r+h*i,t[7]=l*r+f*i,t[8]=c*r-o*i,t[9]=u*r-s*i,t[10]=h*r-a*i,t[11]=f*r-l*i,t},rotateY:function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*i,t[1]=s*r-u*i,t[2]=a*r-h*i,t[3]=l*r-f*i,t[8]=o*i+c*r,t[9]=s*i+u*r,t[10]=a*i+h*r,t[11]=l*i+f*r,t},rotateZ:function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=s*r+u*i,t[2]=a*r+h*i,t[3]=l*r+f*i,t[4]=c*r-o*i,t[5]=u*r-s*i,t[6]=h*r-a*i,t[7]=f*r-l*i,t},fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,e,n){var i,r,o,s=n[0],a=n[1],l=n[2],c=Math.hypot(s,a,l);return c<Ke?null:(s*=c=1/c,a*=c,l*=c,i=Math.sin(e),o=1-(r=Math.cos(e)),t[0]=s*s*o+r,t[1]=a*s*o+l*i,t[2]=l*s*o-a*i,t[3]=0,t[4]=s*a*o-l*i,t[5]=a*a*o+r,t[6]=l*a*o+s*i,t[7]=0,t[8]=s*l*o+a*i,t[9]=a*l*o-s*i,t[10]=l*l*o+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromYRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:wn,fromQuat2:function(t,e){var n=new Ze(3),i=-e[0],r=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=i*i+r*r+o*o+s*s;return h>0?(n[0]=2*(a*s+u*i+l*o-c*r)/h,n[1]=2*(l*s+u*r+c*i-a*o)/h,n[2]=2*(c*s+u*o+a*r-l*i)/h):(n[0]=2*(a*s+u*i+l*o-c*r),n[1]=2*(l*s+u*r+c*i-a*o),n[2]=2*(c*s+u*o+a*r-l*i)),wn(t,e,n),t},getTranslation:$n,getScaling:bn,getRotation:xn,fromRotationTranslationScale:function(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3],l=r+r,c=o+o,u=s+s,h=r*l,f=r*c,p=r*u,d=o*c,m=o*u,v=s*u,_=a*l,y=a*c,g=a*u,w=i[0],$=i[1],b=i[2];return t[0]=(1-(d+v))*w,t[1]=(f+g)*w,t[2]=(p-y)*w,t[3]=0,t[4]=(f-g)*$,t[5]=(1-(h+v))*$,t[6]=(m+_)*$,t[7]=0,t[8]=(p+y)*b,t[9]=(m-_)*b,t[10]=(1-(h+d))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,e,n,i,r){var o=e[0],s=e[1],a=e[2],l=e[3],c=o+o,u=s+s,h=a+a,f=o*c,p=o*u,d=o*h,m=s*u,v=s*h,_=a*h,y=l*c,g=l*u,w=l*h,$=i[0],b=i[1],x=i[2],M=r[0],E=r[1],T=r[2],L=(1-(m+_))*$,C=(p+w)*$,S=(d-g)*$,k=(p-w)*b,I=(1-(f+_))*b,P=(v+y)*b,A=(d+g)*x,z=(v-y)*x,O=(1-(f+m))*x;return t[0]=L,t[1]=C,t[2]=S,t[3]=0,t[4]=k,t[5]=I,t[6]=P,t[7]=0,t[8]=A,t[9]=z,t[10]=O,t[11]=0,t[12]=n[0]+M-(L*M+k*E+A*T),t[13]=n[1]+E-(C*M+I*E+z*T),t[14]=n[2]+T-(S*M+P*E+O*T),t[15]=1,t},fromQuat:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,f=r*s,p=r*a,d=r*l,m=o*s,v=o*a,_=o*l;return t[0]=1-h-d,t[1]=u+_,t[2]=f-v,t[3]=0,t[4]=u-_,t[5]=1-c-d,t[6]=p+m,t[7]=0,t[8]=f+v,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,e,n,i,r,o,s){var a=1/(n-e),l=1/(r-i),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t},perspective:function(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t},perspectiveFromFieldOfView:function(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+a),c=2/(r+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(s-a)*l*.5,t[9]=(r-o)*c*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t},ortho:function(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*c,t[15]=1,t},lookAt:function(t,e,n,i){var r,o,s,a,l,c,u,h,f,p,d=e[0],m=e[1],v=e[2],_=i[0],y=i[1],g=i[2],w=n[0],$=n[1],b=n[2];return Math.abs(d-w)<Ke&&Math.abs(m-$)<Ke&&Math.abs(v-b)<Ke?yn(t):(u=d-w,h=m-$,f=v-b,r=y*(f*=p=1/Math.hypot(u,h,f))-g*(h*=p),o=g*(u*=p)-_*f,s=_*h-y*u,(p=Math.hypot(r,o,s))?(r*=p=1/p,o*=p,s*=p):(r=0,o=0,s=0),a=h*s-f*o,l=f*r-u*s,c=u*o-h*r,(p=Math.hypot(a,l,c))?(a*=p=1/p,l*=p,c*=p):(a=0,l=0,c=0),t[0]=r,t[1]=a,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=c,t[10]=f,t[11]=0,t[12]=-(r*d+o*m+s*v),t[13]=-(a*d+l*m+c*v),t[14]=-(u*d+h*m+f*v),t[15]=1,t)},targetTo:function(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=i[0],l=i[1],c=i[2],u=r-n[0],h=o-n[1],f=s-n[2],p=u*u+h*h+f*f;p>0&&(u*=p=1/Math.sqrt(p),h*=p,f*=p);var d=l*f-c*h,m=c*u-a*f,v=a*h-l*u;return(p=d*d+m*m+v*v)>0&&(d*=p=1/Math.sqrt(p),m*=p,v*=p),t[0]=d,t[1]=m,t[2]=v,t[3]=0,t[4]=h*v-f*m,t[5]=f*d-u*v,t[6]=u*m-h*d,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=r,t[13]=o,t[14]=s,t[15]=1,t},str:function(t){return\"mat4(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\", \"+t[6]+\", \"+t[7]+\", \"+t[8]+\", \"+t[9]+\", \"+t[10]+\", \"+t[11]+\", \"+t[12]+\", \"+t[13]+\", \"+t[14]+\", \"+t[15]+\")\"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},subtract:Mn,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},multiplyScalarAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},equals:function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],p=t[11],d=t[12],m=t[13],v=t[14],_=t[15],y=e[0],g=e[1],w=e[2],$=e[3],b=e[4],x=e[5],M=e[6],E=e[7],T=e[8],L=e[9],C=e[10],S=e[11],k=e[12],I=e[13],P=e[14],A=e[15];return Math.abs(n-y)<=Ke*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-g)<=Ke*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(r-w)<=Ke*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(o-$)<=Ke*Math.max(1,Math.abs(o),Math.abs($))&&Math.abs(s-b)<=Ke*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(a-x)<=Ke*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(l-M)<=Ke*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-E)<=Ke*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-T)<=Ke*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-L)<=Ke*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(f-C)<=Ke*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-S)<=Ke*Math.max(1,Math.abs(p),Math.abs(S))&&Math.abs(d-k)<=Ke*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(m-I)<=Ke*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-P)<=Ke*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(_-A)<=Ke*Math.max(1,Math.abs(_),Math.abs(A))},mul:En,sub:Tn});function Cn(){var t=new Ze(3);return Ze!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Sn(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function kn(t,e,n){var i=new Ze(3);return i[0]=t,i[1]=e,i[2]=n,i}function In(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Pn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function An(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function zn(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function On(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function Rn(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function Hn(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Dn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Fn(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s,t}var qn,jn=In,Vn=Pn,Nn=An,Bn=zn,Xn=On,Wn=Sn,Yn=Rn,Un=(qn=Cn(),function(t,e,n,i,r,o){var s,a;for(e||(e=3),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,s=n;s<a;s+=e)qn[0]=t[s],qn[1]=t[s+1],qn[2]=t[s+2],r(qn,qn,o),t[s]=qn[0],t[s+1]=qn[1],t[s+2]=qn[2];return t}),Gn=Object.freeze({__proto__:null,create:Cn,clone:function(t){var e=new Ze(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},length:Sn,fromValues:kn,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},set:function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},subtract:In,multiply:Pn,divide:An,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},scale:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},scaleAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},distance:zn,squaredDistance:On,squaredLength:Rn,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},normalize:Hn,dot:Dn,cross:Fn,lerp:function(t,e,n,i){var r=e[0],o=e[1],s=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t},hermite:function(t,e,n,i,r,o){var s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,c=s*(o-1),u=s*(3-2*o);return t[0]=e[0]*a+n[0]*l+i[0]*c+r[0]*u,t[1]=e[1]*a+n[1]*l+i[1]*c+r[1]*u,t[2]=e[2]*a+n[2]*l+i[2]*c+r[2]*u,t},bezier:function(t,e,n,i,r,o){var s=1-o,a=s*s,l=o*o,c=a*s,u=3*o*a,h=3*l*s,f=l*o;return t[0]=e[0]*c+n[0]*u+i[0]*h+r[0]*f,t[1]=e[1]*c+n[1]*u+i[1]*h+r[1]*f,t[2]=e[2]*c+n[2]*u+i[2]*h+r[2]*f,t},random:function(t,e){e=e||1;var n=2*Qe()*Math.PI,i=2*Qe()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t},transformMat4:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t},transformMat3:function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},transformQuat:function(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],c=e[2],u=r*c-o*l,h=o*a-i*c,f=i*l-r*a,p=r*f-o*h,d=o*u-i*f,m=i*h-r*u,v=2*s;return u*=v,h*=v,f*=v,p*=2,d*=2,m*=2,t[0]=a+u+p,t[1]=l+h+d,t[2]=c+f+m,t},rotateX:function(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},rotateY:function(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},rotateZ:function(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},angle:function(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+s*s+a*a),c=l&&Dn(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))},zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t},str:function(t){return\"vec3(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\")\"},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},equals:function(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=Ke*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=Ke*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-a)<=Ke*Math.max(1,Math.abs(r),Math.abs(a))},sub:jn,mul:Vn,div:Nn,dist:Bn,sqrDist:Xn,len:Wn,sqrLen:Yn,forEach:Un});function Kn(){var t=new Ze(4);return Ze!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Zn(t){var e=new Ze(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Qn(t,e,n,i){var r=new Ze(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function Jn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function ti(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function ei(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function ni(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function ii(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function ri(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function oi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function si(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,i,r,o)}function ai(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+i*i+r*r+o*o}function li(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function ci(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function ui(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=o*s,t}function hi(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function fi(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t[3]=a+i*(n[3]-a),t}function pi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function di(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=Ke*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=Ke*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-l)<=Ke*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-c)<=Ke*Math.max(1,Math.abs(o),Math.abs(c))}var mi=ni,vi=ii,_i=ri,yi=si,gi=ai,wi=li,$i=ci,bi=function(){var t=Kn();return function(e,n,i,r,o,s){var a,l;for(n||(n=4),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,a=i;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),xi=Object.freeze({__proto__:null,create:Kn,clone:Zn,fromValues:Qn,copy:Jn,set:ti,add:ei,subtract:ni,multiply:ii,divide:ri,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},scale:oi,scaleAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},distance:si,squaredDistance:ai,length:li,squaredLength:ci,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},normalize:ui,dot:hi,cross:function(t,e,n,i){var r=n[0]*i[1]-n[1]*i[0],o=n[0]*i[2]-n[2]*i[0],s=n[0]*i[3]-n[3]*i[0],a=n[1]*i[2]-n[2]*i[1],l=n[1]*i[3]-n[3]*i[1],c=n[2]*i[3]-n[3]*i[2],u=e[0],h=e[1],f=e[2],p=e[3];return t[0]=h*c-f*l+p*a,t[1]=-u*c+f*s-p*o,t[2]=u*l-h*s+p*r,t[3]=-u*a+h*o-f*r,t},lerp:fi,random:function(t,e){var n,i,r,o,s,a;e=e||1;do{s=(n=2*Qe()-1)*n+(i=2*Qe()-1)*i}while(s>=1);do{a=(r=2*Qe()-1)*r+(o=2*Qe()-1)*o}while(a>=1);var l=Math.sqrt((1-s)/a);return t[0]=e*n,t[1]=e*i,t[2]=e*r*l,t[3]=e*o*l,t},transformMat4:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t},transformQuat:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2],c=n[3],u=c*i+a*o-l*r,h=c*r+l*i-s*o,f=c*o+s*r-a*i,p=-s*i-a*r-l*o;return t[0]=u*c+p*-s+h*-l-f*-a,t[1]=h*c+p*-a+f*-s-u*-l,t[2]=f*c+p*-l+u*-a-h*-s,t[3]=e[3],t},zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},str:function(t){return\"vec4(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"},exactEquals:pi,equals:di,sub:mi,mul:vi,div:_i,dist:yi,sqrDist:gi,len:wi,sqrLen:$i,forEach:bi});function Mi(){var t=new Ze(4);return Ze!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ei(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Ti(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*u+s*a+r*c-o*l,t[1]=r*u+s*l+o*a-i*c,t[2]=o*u+s*c+i*l-r*a,t[3]=s*u-i*a-r*l-o*c,t}function Li(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=o*l-r*a,t[3]=s*l-i*a,t}function Ci(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l-o*a,t[1]=r*l+s*a,t[2]=o*l+i*a,t[3]=s*l-r*a,t}function Si(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t}function ki(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=Math.sqrt(n*n+i*i+r*r),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return t[0]=n*l,t[1]=i*l,t[2]=r*l,t[3]=a*Math.cos(s),t}function Ii(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=Math.sqrt(n*n+i*i+r*r),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=.5*Math.log(n*n+i*i+r*r+o*o),t}function Pi(t,e,n,i){var r,o,s,a,l,c=e[0],u=e[1],h=e[2],f=e[3],p=n[0],d=n[1],m=n[2],v=n[3];return(o=c*p+u*d+h*m+f*v)<0&&(o=-o,p=-p,d=-d,m=-m,v=-v),1-o>Ke?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-i)*r)/s,l=Math.sin(i*r)/s):(a=1-i,l=i),t[0]=a*c+l*p,t[1]=a*u+l*d,t[2]=a*h+l*m,t[3]=a*f+l*v,t}function Ai(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[s]=(e[3*s+r]+e[3*r+s])*n}return t}var zi,Oi,Ri,Hi,Di,Fi,qi=Zn,ji=Qn,Vi=Jn,Ni=ti,Bi=ei,Xi=Ti,Wi=oi,Yi=hi,Ui=fi,Gi=li,Ki=Gi,Zi=ci,Qi=Zi,Ji=ui,tr=pi,er=di,nr=(zi=Cn(),Oi=kn(1,0,0),Ri=kn(0,1,0),function(t,e,n){var i=Dn(e,n);return i<-.999999?(Fn(zi,Oi,e),Wn(zi)<1e-6&&Fn(zi,Ri,e),Hn(zi,zi),Ei(t,zi,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Fn(zi,e,n),t[0]=zi[0],t[1]=zi[1],t[2]=zi[2],t[3]=1+i,Ji(t,t))}),ir=(Hi=Mi(),Di=Mi(),function(t,e,n,i,r,o){return Pi(Hi,e,r,o),Pi(Di,n,i,o),Pi(t,Hi,Di,2*o*(1-o)),t}),rr=(Fi=fn(),function(t,e,n,i){return Fi[0]=n[0],Fi[3]=n[1],Fi[6]=n[2],Fi[1]=i[0],Fi[4]=i[1],Fi[7]=i[2],Fi[2]=-e[0],Fi[5]=-e[1],Fi[8]=-e[2],Ji(t,Ai(t,Fi))}),or=Object.freeze({__proto__:null,create:Mi,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:Ei,getAxisAngle:function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>Ke?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n},getAngle:function(t,e){var n=Yi(t,e);return Math.acos(2*n*n-1)},multiply:Ti,rotateX:Li,rotateY:Ci,rotateZ:Si,calculateW:function(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},exp:ki,ln:Ii,pow:function(t,e,n){return Ii(t,e),Wi(t,t,n),ki(t,t),t},slerp:Pi,random:function(t){var e=Qe(),n=Qe(),i=Qe(),r=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t},invert:function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=o*a,t},conjugate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},fromMat3:Ai,fromEuler:function(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(n),l=Math.cos(n),c=Math.sin(i),u=Math.cos(i);return t[0]=o*l*u-s*a*c,t[1]=s*a*u+o*l*c,t[2]=s*l*c-o*a*u,t[3]=s*l*u+o*a*c,t},str:function(t){return\"quat(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"},clone:qi,fromValues:ji,copy:Vi,set:Ni,add:Bi,mul:Xi,scale:Wi,dot:Yi,lerp:Ui,length:Gi,len:Ki,squaredLength:Zi,sqrLen:Qi,normalize:Ji,exactEquals:tr,equals:er,rotationTo:nr,sqlerp:ir,setAxes:rr});function sr(t,e,n){var i=.5*n[0],r=.5*n[1],o=.5*n[2],s=e[0],a=e[1],l=e[2],c=e[3];return t[0]=s,t[1]=a,t[2]=l,t[3]=c,t[4]=i*c+r*l-o*a,t[5]=r*c+o*s-i*l,t[6]=o*c+i*a-r*s,t[7]=-i*s-r*a-o*l,t}function ar(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}var lr=Vi;var cr=Vi;function ur(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[4],l=n[5],c=n[6],u=n[7],h=e[4],f=e[5],p=e[6],d=e[7],m=n[0],v=n[1],_=n[2],y=n[3];return t[0]=i*y+s*m+r*_-o*v,t[1]=r*y+s*v+o*m-i*_,t[2]=o*y+s*_+i*v-r*m,t[3]=s*y-i*m-r*v-o*_,t[4]=i*u+s*a+r*c-o*l+h*y+d*m+f*_-p*v,t[5]=r*u+s*l+o*a-i*c+f*y+d*v+p*m-h*_,t[6]=o*u+s*c+i*l-r*a+p*y+d*_+h*v-f*m,t[7]=s*u-i*a-r*l-o*c+d*y-h*m-f*v-p*_,t}var hr=ur;var fr=Yi;var pr=Gi,dr=pr,mr=Zi,vr=mr;var _r=Object.freeze({__proto__:null,create:function(){var t=new Ze(8);return Ze!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},clone:function(t){var e=new Ze(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},fromValues:function(t,e,n,i,r,o,s,a){var l=new Ze(8);return l[0]=t,l[1]=e,l[2]=n,l[3]=i,l[4]=r,l[5]=o,l[6]=s,l[7]=a,l},fromRotationTranslationValues:function(t,e,n,i,r,o,s){var a=new Ze(8);a[0]=t,a[1]=e,a[2]=n,a[3]=i;var l=.5*r,c=.5*o,u=.5*s;return a[4]=l*i+c*n-u*e,a[5]=c*i+u*t-l*n,a[6]=u*i+l*e-c*t,a[7]=-l*t-c*e-u*n,a},fromRotationTranslation:sr,fromTranslation:function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},fromRotation:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},fromMat4:function(t,e){var n=Mi();xn(n,e);var i=new Ze(3);return $n(i,e),sr(t,n,i),t},copy:ar,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},set:function(t,e,n,i,r,o,s,a,l){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t},getReal:lr,getDual:function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},setReal:cr,setDual:function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},getTranslation:function(t,e){var n=e[4],i=e[5],r=e[6],o=e[7],s=-e[0],a=-e[1],l=-e[2],c=e[3];return t[0]=2*(n*c+o*s+i*l-r*a),t[1]=2*(i*c+o*a+r*s-n*l),t[2]=2*(r*c+o*l+n*a-i*s),t},translate:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=.5*n[0],l=.5*n[1],c=.5*n[2],u=e[4],h=e[5],f=e[6],p=e[7];return t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=s*a+r*c-o*l+u,t[5]=s*l+o*a-i*c+h,t[6]=s*c+i*l-r*a+f,t[7]=-i*a-r*l-o*c+p,t},rotateX:function(t,e,n){var i=-e[0],r=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=a*s+u*i+l*o-c*r,f=l*s+u*r+c*i-a*o,p=c*s+u*o+a*r-l*i,d=u*s-a*i-l*r-c*o;return Li(t,e,n),i=t[0],r=t[1],o=t[2],s=t[3],t[4]=h*s+d*i+f*o-p*r,t[5]=f*s+d*r+p*i-h*o,t[6]=p*s+d*o+h*r-f*i,t[7]=d*s-h*i-f*r-p*o,t},rotateY:function(t,e,n){var i=-e[0],r=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=a*s+u*i+l*o-c*r,f=l*s+u*r+c*i-a*o,p=c*s+u*o+a*r-l*i,d=u*s-a*i-l*r-c*o;return Ci(t,e,n),i=t[0],r=t[1],o=t[2],s=t[3],t[4]=h*s+d*i+f*o-p*r,t[5]=f*s+d*r+p*i-h*o,t[6]=p*s+d*o+h*r-f*i,t[7]=d*s-h*i-f*r-p*o,t},rotateZ:function(t,e,n){var i=-e[0],r=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=a*s+u*i+l*o-c*r,f=l*s+u*r+c*i-a*o,p=c*s+u*o+a*r-l*i,d=u*s-a*i-l*r-c*o;return Si(t,e,n),i=t[0],r=t[1],o=t[2],s=t[3],t[4]=h*s+d*i+f*o-p*r,t[5]=f*s+d*r+p*i-h*o,t[6]=p*s+d*o+h*r-f*i,t[7]=d*s-h*i-f*r-p*o,t},rotateByQuatAppend:function(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],c=e[2],u=e[3];return t[0]=a*s+u*i+l*o-c*r,t[1]=l*s+u*r+c*i-a*o,t[2]=c*s+u*o+a*r-l*i,t[3]=u*s-a*i-l*r-c*o,a=e[4],l=e[5],c=e[6],u=e[7],t[4]=a*s+u*i+l*o-c*r,t[5]=l*s+u*r+c*i-a*o,t[6]=c*s+u*o+a*r-l*i,t[7]=u*s-a*i-l*r-c*o,t},rotateByQuatPrepend:function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*u+s*a+r*c-o*l,t[1]=r*u+s*l+o*a-i*c,t[2]=o*u+s*c+i*l-r*a,t[3]=s*u-i*a-r*l-o*c,a=n[4],l=n[5],c=n[6],u=n[7],t[4]=i*u+s*a+r*c-o*l,t[5]=r*u+s*l+o*a-i*c,t[6]=o*u+s*c+i*l-r*a,t[7]=s*u-i*a-r*l-o*c,t},rotateAroundAxis:function(t,e,n,i){if(Math.abs(i)<Ke)return ar(t,e);var r=Math.hypot(n[0],n[1],n[2]);i*=.5;var o=Math.sin(i),s=o*n[0]/r,a=o*n[1]/r,l=o*n[2]/r,c=Math.cos(i),u=e[0],h=e[1],f=e[2],p=e[3];t[0]=u*c+p*s+h*l-f*a,t[1]=h*c+p*a+f*s-u*l,t[2]=f*c+p*l+u*a-h*s,t[3]=p*c-u*s-h*a-f*l;var d=e[4],m=e[5],v=e[6],_=e[7];return t[4]=d*c+_*s+m*l-v*a,t[5]=m*c+_*a+v*s-d*l,t[6]=v*c+_*l+d*a-m*s,t[7]=_*c-d*s-m*a-v*l,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},multiply:ur,mul:hr,scale:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},dot:fr,lerp:function(t,e,n,i){var r=1-i;return fr(e,n)<0&&(i=-i),t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i,t[3]=e[3]*r+n[3]*i,t[4]=e[4]*r+n[4]*i,t[5]=e[5]*r+n[5]*i,t[6]=e[6]*r+n[6]*i,t[7]=e[7]*r+n[7]*i,t},invert:function(t,e){var n=mr(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},conjugate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},length:pr,len:dr,squaredLength:mr,sqrLen:vr,normalize:function(t,e){var n=mr(e);if(n>0){n=Math.sqrt(n);var i=e[0]/n,r=e[1]/n,o=e[2]/n,s=e[3]/n,a=e[4],l=e[5],c=e[6],u=e[7],h=i*a+r*l+o*c+s*u;t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=(a-i*h)/n,t[5]=(l-r*h)/n,t[6]=(c-o*h)/n,t[7]=(u-s*h)/n}return t},str:function(t){return\"quat2(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\", \"+t[6]+\", \"+t[7]+\")\"},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},equals:function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=e[0],h=e[1],f=e[2],p=e[3],d=e[4],m=e[5],v=e[6],_=e[7];return Math.abs(n-u)<=Ke*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-h)<=Ke*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-f)<=Ke*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-p)<=Ke*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-d)<=Ke*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-m)<=Ke*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-v)<=Ke*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-_)<=Ke*Math.max(1,Math.abs(c),Math.abs(_))}});function yr(){var t=new Ze(2);return Ze!=Float32Array&&(t[0]=0,t[1]=0),t}function gr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function wr(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function $r(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function br(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.hypot(n,i)}function xr(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function Mr(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Er(t){var e=t[0],n=t[1];return e*e+n*n}var Tr=Mr,Lr=gr,Cr=wr,Sr=$r,kr=br,Ir=xr,Pr=Er,Ar=function(){var t=yr();return function(e,n,i,r,o,s){var a,l;for(n||(n=2),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,a=i;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),zr=Object.freeze({__proto__:null,create:yr,clone:function(t){var e=new Ze(2);return e[0]=t[0],e[1]=t[1],e},fromValues:function(t,e){var n=new Ze(2);return n[0]=t,n[1]=e,n},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t},set:function(t,e,n){return t[0]=e,t[1]=n,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},subtract:gr,multiply:wr,divide:$r,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},scale:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},scaleAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},distance:br,squaredDistance:xr,length:Mr,squaredLength:Er,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},normalize:function(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},cross:function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},lerp:function(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t},random:function(t,e){e=e||1;var n=2*Qe()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},transformMat2:function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t},transformMat2d:function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t},transformMat3:function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t},transformMat4:function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t},rotate:function(t,e,n,i){var r=e[0]-n[0],o=e[1]-n[1],s=Math.sin(i),a=Math.cos(i);return t[0]=r*a-o*s+n[0],t[1]=r*s+o*a+n[1],t},angle:function(t,e){var n=t[0],i=t[1],r=e[0],o=e[1],s=Math.sqrt(n*n+i*i)*Math.sqrt(r*r+o*o),a=s&&(n*r+i*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))},zero:function(t){return t[0]=0,t[1]=0,t},str:function(t){return\"vec2(\"+t[0]+\", \"+t[1]+\")\"},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]},equals:function(t,e){var n=t[0],i=t[1],r=e[0],o=e[1];return Math.abs(n-r)<=Ke*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-o)<=Ke*Math.max(1,Math.abs(i),Math.abs(o))},len:Tr,sub:Lr,mul:Cr,div:Sr,dist:kr,sqrDist:Ir,sqrLen:Pr,forEach:Ar}),Or=Ht(Object.freeze({__proto__:null,glMatrix:tn,mat2:sn,mat2d:hn,mat3:_n,mat4:Ln,quat:or,quat2:_r,vec2:zr,vec3:Gn,vec4:xi}));var Rr=function(t,e,n){return Math.min(Math.max(t,e),n)},Hr=Rr,Dr=Or.vec4,Fr=Or.vec3,qr=Or.mat4;function jr(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw t.getShaderInfoLog(i);return i}function Vr(t,e,n,i){var r=t.createBuffer();return t.bindBuffer(e,r),t.bufferData(e,i,n),r}var Nr=Dr.create(),Br=qr.create();qr.identity(Br);var Xr=Fr.create(),Wr=Fr.create();var Yr={createShaderProgram:function(t,e,n,i,r){var o=jr(t,t.VERTEX_SHADER,e),s=jr(t,t.FRAGMENT_SHADER,n),a=t.createProgram();if(t.attachShader(a,o),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw t.getProgramInfoLog(a);for(var l=0;l<i.length;l++){var c=i[l];if(a[c]=t.getAttribLocation(a,c),-1===a[c])throw new Error(\"Shader program has no \"+c+\" attribute\")}for(var u=0;u<r.length;u++){var h=r[u];if(a[h]=t.getUniformLocation(a,h),-1===a[h])throw new Error(\"Shader program has no \"+h+\" uniform\")}return a},destroyShaderProgram:function(t,e){for(var n=t.getAttachedShaders(e),i=0;i<n.length;i++){var r=n[i];t.detachShader(e,r),t.deleteShader(r)}t.deleteProgram(e)},createConstantBuffers:function(t,e,n,i){return{vertexIndices:Vr(t,t.ELEMENT_ARRAY_BUFFER,t.STATIC_DRAW,new Uint16Array(e)),vertexPositions:Vr(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(n)),textureCoords:Vr(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(i))}},destroyConstantBuffers:function(t,e){t.deleteBuffer(e.vertexIndices),t.deleteBuffer(e.vertexPositions),t.deleteBuffer(e.textureCoords)},enableAttributes:function(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++)t.enableVertexAttribArray(i)},disableAttributes:function(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++)t.disableVertexAttribArray(i)},setTexture:function(t,e,n){t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n._texture),t.uniform1i(e.uSampler,0)},setDepth:function(t,e,n,i){var r=(256*(n+1)-i)/65536;t.uniform1f(e.uDepth,r)},setViewport:function(t,e,n,i){if(0===n.x&&1===n.width&&0===n.y&&1===n.height)return t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),void qr.identity(i);var r=n.x,o=Hr(r,0,1),s=o-r,a=1-o,l=Hr(n.width-s,0,a),c=n.width-l,u=1-n.height-n.y,h=Hr(u,0,1),f=h-u,p=1-h,d=Hr(n.height-f,0,p),m=n.height-d;Fr.set(Wr,n.width/l,n.height/d,1),Fr.set(Xr,(c-s)/l,(m-f)/d,0),qr.identity(i),qr.translate(i,i,Xr),qr.scale(i,i,Wr),t.viewport(t.drawingBufferWidth*o,t.drawingBufferHeight*h,t.drawingBufferWidth*l,t.drawingBufferHeight*d)},setupPixelEffectUniforms:function(t,e,n){var i=1;e&&null!=e.opacity&&(i=e.opacity),t.uniform1f(n.opacity,i);var r=Nr;e&&e.colorOffset&&(r=e.colorOffset),t.uniform4fv(n.colorOffset,r);var o=Br;e&&e.colorMatrix&&(o=e.colorMatrix),t.uniformMatrix4fv(n.colorMatrix,!1,o)}},Ur=[\"attribute vec3 aVertexPosition;\",\"attribute vec2 aTextureCoord;\",\"uniform float uDepth;\",\"uniform mat4 uViewportMatrix;\",\"uniform mat4 uProjMatrix;\",\"varying vec2 vTextureCoord;\",\"void main(void) {\",\"  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);\",\"  gl_Position.z = uDepth * gl_Position.w;\",\"  vTextureCoord = aTextureCoord;\",\"}\"].join(\"\\n\"),Gr=[\"#ifdef GL_FRAGMENT_PRECISION_HIGH\",\"precision highp float;\",\"#else\",\"precision mediump float;\",\"#endif\",\"uniform sampler2D uSampler;\",\"uniform float uOpacity;\",\"uniform vec4 uColorOffset;\",\"uniform mat4 uColorMatrix;\",\"varying vec2 vTextureCoord;\",\"void main(void) {\",\"  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;\",\"  gl_FragColor = vec4(color.rgba * uOpacity);\",\"}\"].join(\"\\n\"),Kr=Or.mat4,Zr=Or.vec3,Qr=Kt,Jr=Yr.createConstantBuffers,to=Yr.destroyConstantBuffers,eo=Yr.createShaderProgram,no=Yr.destroyShaderProgram,io=Yr.enableAttributes,ro=Yr.disableAttributes,oo=Yr.setViewport,so=Yr.setupPixelEffectUniforms,ao=Yr.setDepth,lo=Yr.setTexture,co=Ur,uo=Gr,ho=[0,1,2,0,2,3],fo=[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],po=[0,0,1,0,1,1,0,1],mo=[\"aVertexPosition\",\"aTextureCoord\"],vo=[\"uDepth\",\"uOpacity\",\"uSampler\",\"uProjMatrix\",\"uViewportMatrix\",\"uColorOffset\",\"uColorMatrix\"];function _o(t){this.gl=t,this.projMatrix=Kr.create(),this.viewportMatrix=Kr.create(),this.translateVector=Zr.create(),this.scaleVector=Zr.create(),this.constantBuffers=Jr(t,ho,fo,po),this.shaderProgram=eo(t,co,uo,mo,vo)}_o.prototype.destroy=function(){to(this.gl,this.constantBuffers),no(this.gl,this.shaderProgram),Qr(this)},_o.prototype.startLayer=function(t,e){var n=this.gl,i=this.shaderProgram,r=this.constantBuffers,o=this.viewportMatrix;n.useProgram(i),io(n,i),oo(n,t,e,o),n.uniformMatrix4fv(i.uViewportMatrix,!1,o),n.bindBuffer(n.ARRAY_BUFFER,r.vertexPositions),n.vertexAttribPointer(i.aVertexPosition,3,n.FLOAT,n.FALSE,0,0),n.bindBuffer(n.ARRAY_BUFFER,r.textureCoords),n.vertexAttribPointer(i.aTextureCoord,2,n.FLOAT,n.FALSE,0,0),so(n,t.effects(),{opacity:i.uOpacity,colorOffset:i.uColorOffset,colorMatrix:i.uColorMatrix})},_o.prototype.endLayer=function(t,e){var n=this.gl,i=this.shaderProgram;ro(n,i)},_o.prototype.renderTile=function(t,e,n,i){var r=this.gl,o=this.shaderProgram,s=this.constantBuffers,a=this.projMatrix,l=this.translateVector,c=this.scaleVector;l[0]=t.centerX(),l[1]=t.centerY(),l[2]=-.5,c[0]=t.scaleX(),c[1]=t.scaleY(),c[2]=1,Kr.copy(a,n.view().projection()),Kr.rotateX(a,a,t.rotX()),Kr.rotateY(a,a,t.rotY()),Kr.translate(a,a,l),Kr.scale(a,a,c),r.uniformMatrix4fv(o.uProjMatrix,!1,a),ao(r,o,i,t.z),lo(r,o,e),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,s.vertexIndices),r.drawElements(r.TRIANGLES,ho.length,r.UNSIGNED_SHORT,0)};var yo=_o;function go(){this.constructor.super_.apply(this,arguments)}de(go,yo);var wo=go;function $o(){this.constructor.super_.apply(this,arguments)}de($o,yo);var bo=$o,xo=[\"attribute vec3 aVertexPosition;\",\"uniform float uDepth;\",\"uniform mat4 uViewportMatrix;\",\"uniform mat4 uInvProjMatrix;\",\"varying vec4 vRay;\",\"void main(void) {\",\"  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);\",\"  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);\",\"}\"].join(\"\\n\"),Mo=[\"#ifdef GL_FRAGMENT_PRECISION_HIGH\",\"precision highp float;\",\"#else\",\"precision mediump float\",\"#endif\",\"uniform sampler2D uSampler;\",\"uniform float uOpacity;\",\"uniform float uTextureX;\",\"uniform float uTextureY;\",\"uniform float uTextureWidth;\",\"uniform float uTextureHeight;\",\"uniform vec4 uColorOffset;\",\"uniform mat4 uColorMatrix;\",\"varying vec4 vRay;\",\"const float PI = 3.14159265358979323846264;\",\"void main(void) {\",\"  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);\",\"  float phi  = acos(vRay.y * r);\",\"  float theta = atan(vRay.x, -1.0*vRay.z);\",\"  float s = 0.5 + 0.5 * theta / PI;\",\"  float t = 1.0 - phi / PI;\",\"  s = s * uTextureWidth + uTextureX;\",\"  t = t * uTextureHeight + uTextureY;\",\"  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;\",\"  gl_FragColor = vec4(color.rgba * uOpacity);\",\"}\"].join(\"\\n\"),Eo=Or.mat4,To=Kt,Lo=Yr.createConstantBuffers,Co=Yr.destroyConstantBuffers,So=Yr.createShaderProgram,ko=Yr.destroyShaderProgram,Io=Yr.enableAttributes,Po=Yr.disableAttributes,Ao=Yr.setViewport,zo=Yr.setupPixelEffectUniforms,Oo=Yr.setDepth,Ro=Yr.setTexture,Ho=xo,Do=Mo,Fo=[0,1,2,0,2,3],qo=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],jo=[0,0,1,0,1,1,0,1],Vo=[\"aVertexPosition\"],No=[\"uDepth\",\"uOpacity\",\"uSampler\",\"uInvProjMatrix\",\"uViewportMatrix\",\"uColorOffset\",\"uColorMatrix\",\"uTextureX\",\"uTextureY\",\"uTextureWidth\",\"uTextureHeight\"];function Bo(t){this.gl=t,this.invProjMatrix=Eo.create(),this.viewportMatrix=Eo.create(),this.constantBuffers=Lo(t,Fo,qo,jo),this.shaderProgram=So(t,Ho,Do,Vo,No)}Bo.prototype.destroy=function(){Co(this.gl,this.constantBuffers),ko(this.gl,this.shaderProgram),To(this)},Bo.prototype.startLayer=function(t,e){var n=this.gl,i=this.shaderProgram,r=this.constantBuffers,o=this.invProjMatrix,s=this.viewportMatrix;n.useProgram(i),Io(n,i),Ao(n,t,e,s),n.uniformMatrix4fv(i.uViewportMatrix,!1,s),n.bindBuffer(n.ARRAY_BUFFER,r.vertexPositions),n.vertexAttribPointer(i.aVertexPosition,3,n.FLOAT,n.FALSE,0,0),n.bindBuffer(n.ARRAY_BUFFER,r.textureCoords),Eo.copy(o,t.view().projection()),Eo.invert(o,o),n.uniformMatrix4fv(i.uInvProjMatrix,!1,o);var a=t.effects().textureCrop||{},l=null!=a.x?a.x:0,c=null!=a.y?a.y:0,u=null!=a.width?a.width:1,h=null!=a.height?a.height:1;n.uniform1f(i.uTextureX,l),n.uniform1f(i.uTextureY,c),n.uniform1f(i.uTextureWidth,u),n.uniform1f(i.uTextureHeight,h),zo(n,t.effects(),{opacity:i.uOpacity,colorOffset:i.uColorOffset,colorMatrix:i.uColorMatrix})},Bo.prototype.endLayer=function(t,e){var n=this.gl,i=this.shaderProgram;Po(n,i)},Bo.prototype.renderTile=function(t,e,n,i){var r=this.gl,o=this.shaderProgram,s=this.constantBuffers;Oo(r,o,i,t.z),Ro(r,o,e),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,s.vertexIndices),r.drawElements(r.TRIANGLES,Fo.length,r.UNSIGNED_SHORT,0)};var Xo=Bo,Wo=wo,Yo=bo,Uo=Xo;var Go=function(t){if(\"webgl\"!==t.type)throw new Error(\"Unknown stage type: \"+t.type);t.registerRenderer(\"flat\",\"flat\",Yo),t.registerRenderer(\"cube\",\"rectilinear\",Wo),t.registerRenderer(\"equirect\",\"rectilinear\",Uo)};var Ko=function(){for(var t=0,e=0;e<arguments.length;e++){var n=arguments[e];t+=n,t+=n<<10,t^=n>>6}return t+=t<<3,t^=t>>11,(t+=t<<15)>=0?t:-t};var Zo=function(t,e){return(+t%(e=+e)+e)%e},Qo=Zo;function Jo(t){if(null!=t&&(!isFinite(t)||Math.floor(t)!==t||t<1))throw new Error(\"Set: invalid capacity\");this._capacity=this._capacity||64,this._buckets=[];for(var e=0;e<this._capacity;e++)this._buckets.push([]);this._size=0}Jo.prototype.add=function(t){for(var e=Qo(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var r=n[i];if(t.equals(r))return n[i]=t,r}return n.push(t),this._size++,null},Jo.prototype.remove=function(t){for(var e=Qo(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var r=n[i];if(t.equals(r)){for(var o=i;o<n.length-1;o++)n[o]=n[o+1];return n.length=n.length-1,this._size--,r}}return null},Jo.prototype.has=function(t){for(var e=Qo(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var r=n[i];if(t.equals(r))return!0}return!1},Jo.prototype.size=function(){return this._size},Jo.prototype.clear=function(){for(var t=0;t<this._capacity;t++)this._buckets[t].length=0;this._size=0},Jo.prototype.forEach=function(t){for(var e=0,n=0;n<this._capacity;n++)for(var i=this._buckets[n],r=0;r<i.length;r++)t(i[r]),e+=1;return e};var ts=Jo,es=ts;function ns(){this._stack=[],this._visited=new es,this._vertices=null}ns.prototype.search=function(t,e,n){var i=this._stack,r=this._visited,o=this._vertices,s=0;for(this._clear(),i.push(e);i.length>0;){var a=i.pop();if(!r.has(a)&&t.intersects(a.vertices(o))){r.add(a);for(var l=a.neighbors(),c=0;c<l.length;c++)i.push(l[c]);n.push(a),s++}}return this._vertices=o,this._clear(),s},ns.prototype._clear=function(){this._stack.length=0,this._visited.clear()};var is=ns,rs=Zo;function os(t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new Error(\"LruMap: invalid capacity\");this._capacity=t,this._keys=new Array(this._capacity),this._values=new Array(this._capacity),this._start=0,this._size=0}os.prototype._index=function(t){return rs(this._start+t,this._capacity)},os.prototype.get=function(t){for(var e=0;e<this._size;e++){var n=this._keys[this._index(e)];if(t.equals(n))return this._values[this._index(e)]}return null},os.prototype.set=function(t,e){if(0===this._capacity)return t;this.del(t);var n=this._size===this._capacity?this._keys[this._index(0)]:null;return this._keys[this._index(this._size)]=t,this._values[this._index(this._size)]=e,this._size<this._capacity?this._size++:this._start=this._index(1),n},os.prototype.del=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._keys[this._index(e)])){for(var n=this._values[this._index(e)],i=e;i<this._size-1;i++)this._keys[this._index(i)]=this._keys[this._index(i+1)],this._values[this._index(i)]=this._values[this._index(i+1)];return this._size--,n}return null},os.prototype.has=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._keys[this._index(e)]))return!0;return!1},os.prototype.size=function(){return this._size},os.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._start=0,this._size=0},os.prototype.forEach=function(t){for(var e=0,n=0;n<this._size;n++)t(this._keys[this._index(n)],this._values[this._index(n)]),e+=1;return e};var ss=os;function as(t){this._fallbackOnly=!!t.fallbackOnly}as.prototype.numHorizontalTiles=function(){return Math.ceil(this.width()/this.tileWidth())},as.prototype.numVerticalTiles=function(){return Math.ceil(this.height()/this.tileHeight())},as.prototype.fallbackOnly=function(){return this._fallbackOnly};var ls=as;var cs=function(t,e){return t<e?-1:t>e?1:0},us=cs;var hs={makeLevelList:function(t,e){for(var n=[],i=0;i<t.length;i++)n.push(new e(t[i]));return n.sort((function(t,e){return us(t.width(),e.width())})),n},makeSelectableLevelList:function(t){for(var e=[],n=0;n<t.length;n++)t[n]._fallbackOnly||e.push(t[n]);if(!e.length)throw new Error(\"No selectable levels in list\");return e}};var fs=function(t){var e=typeof t;if(\"object\"===e){if(null===t)return\"null\";if(\"[object Array]\"===Object.prototype.toString.call(t))return\"array\";if(\"[object RegExp]\"===Object.prototype.toString.call(t))return\"regexp\"}return e},ps=de,ds=Ko,ms=is,vs=ss,_s=ls,ys=hs.makeLevelList,gs=hs.makeSelectableLevelList,ws=Rr,$s=cs,bs=fs,xs=Or.vec3,Ms=Or.vec4,Es=\"fudlrb\",Ts={f:{x:0,y:0},b:{x:0,y:Math.PI},l:{x:0,y:Math.PI/2},r:{x:0,y:-Math.PI/2},u:{x:Math.PI/2,y:0},d:{x:-Math.PI/2,y:0}},Ls=xs.create();function Cs(t,e,n,i){e&&xs.rotateZ(t,t,Ls,e),n&&xs.rotateX(t,t,Ls,n),i&&xs.rotateY(t,t,Ls,i)}for(var Ss={},ks=0;ks<Es.length;ks++){var Is=Es[ks],Ps=Ts[Is],As=xs.fromValues(0,0,-1);Cs(As,0,Ps.x,Ps.y),Ss[Is]=As}var zs={f:[\"l\",\"r\",\"u\",\"d\"],b:[\"r\",\"l\",\"u\",\"d\"],l:[\"b\",\"f\",\"u\",\"d\"],r:[\"f\",\"b\",\"u\",\"d\"],u:[\"l\",\"r\",\"b\",\"f\"],d:[\"l\",\"r\",\"f\",\"b\"]},Os=[[0,1],[1,0],[0,-1],[-1,0]];function Rs(t,e,n,i,r){this.face=t,this.x=e,this.y=n,this.z=i,this._geometry=r,this._level=r.levelList[i]}function Hs(t){if(this.constructor.super_.call(this,t),this._size=t.size,this._tileSize=t.tileSize,this._size%this._tileSize!=0)throw new Error(\"Level size is not multiple of tile size: \"+this._size+\" \"+this._tileSize)}function Ds(t){if(\"array\"!==bs(t))throw new Error(\"Level list must be an array\");this.levelList=ys(t,Hs),this.selectableLevelList=gs(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._tileSearcher=new ms(this),this._neighborsCache=new vs(64),this._vec=Ms.create(),this._viewSize={}}Rs.prototype.rotX=function(){return Ts[this.face].x},Rs.prototype.rotY=function(){return Ts[this.face].y},Rs.prototype.centerX=function(){return(this.x+.5)/this._level.numHorizontalTiles()-.5},Rs.prototype.centerY=function(){return.5-(this.y+.5)/this._level.numVerticalTiles()},Rs.prototype.scaleX=function(){return 1/this._level.numHorizontalTiles()},Rs.prototype.scaleY=function(){return 1/this._level.numVerticalTiles()},Rs.prototype.vertices=function(t){t||(t=[xs.create(),xs.create(),xs.create(),xs.create()]);var e=Ts[this.face];function n(t,n,i){xs.set(t,n,i,-.5),Cs(t,0,e.x,e.y)}var i=this.centerX()-this.scaleX()/2,r=this.centerX()+this.scaleX()/2,o=this.centerY()-this.scaleY()/2,s=this.centerY()+this.scaleY()/2;return n(t[0],i,s),n(t[1],r,s),n(t[2],r,o),n(t[3],i,o),t},Rs.prototype.parent=function(){if(0===this.z)return null;var t=this.face,e=this.z,n=this.x,i=this.y,r=this._geometry,o=r.levelList[e],s=r.levelList[e-1];return new Rs(t,Math.floor(n/o.numHorizontalTiles()*s.numHorizontalTiles()),Math.floor(i/o.numVerticalTiles()*s.numVerticalTiles()),e-1,r)},Rs.prototype.children=function(t){if(this.z===this._geometry.levelList.length-1)return null;var e=this.face,n=this.z,i=this.x,r=this.y,o=this._geometry,s=o.levelList[n],a=o.levelList[n+1],l=a.numHorizontalTiles()/s.numHorizontalTiles(),c=a.numVerticalTiles()/s.numVerticalTiles();t=t||[];for(var u=0;u<l;u++)for(var h=0;h<c;h++){var f=l*i+u,p=c*r+h,d=n+1;t.push(new Rs(e,f,p,d,o))}return t},Rs.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,n=e.get(this);if(n)return n;for(var i=t._vec,r=this.face,o=this.x,s=this.y,a=this.z,l=this._level,c=l.numHorizontalTiles(),u=l.numVerticalTiles(),h=[],f=0;f<Os.length;f++){var p=o+Os[f][0],d=s+Os[f][1],m=a,v=r;if(p<0||p>=c||d<0||d>=u){var _,y=this.centerX(),g=this.centerY();p<0?(xs.set(i,-.5,g,-.5),v=zs[r][0]):p>=c?(xs.set(i,.5,g,-.5),v=zs[r][1]):d<0?(xs.set(i,y,.5,-.5),v=zs[r][2]):d>=u&&(xs.set(i,y,-.5,-.5),v=zs[r][3]),Cs(i,0,(_=Ts[r]).x,_.y),Cs(i,0,-(_=Ts[v]).x,-_.y),p=ws(Math.floor((.5+i[0])*c),0,c-1),d=ws(Math.floor((.5-i[1])*u),0,u-1)}h.push(new Rs(v,p,d,m,t))}return e.set(this,h),h},Rs.prototype.hash=function(){return ds(Es.indexOf(this.face),this.z,this.y,this.x)},Rs.prototype.equals=function(t){return this._geometry===t._geometry&&this.face===t.face&&this.z===t.z&&this.y===t.y&&this.x===t.x},Rs.prototype.cmp=function(t){return $s(this.z,t.z)||$s(Es.indexOf(this.face),Es.indexOf(t.face))||$s(this.y,t.y)||$s(this.x,t.x)},Rs.prototype.str=function(){return\"CubeTile(\"+tile.face+\", \"+tile.x+\", \"+tile.y+\", \"+tile.z+\")\"},ps(Hs,_s),Hs.prototype.width=function(){return this._size},Hs.prototype.height=function(){return this._size},Hs.prototype.tileWidth=function(){return this._tileSize},Hs.prototype.tileHeight=function(){return this._tileSize},Hs.prototype._validateWithParentLevel=function(t){var e=this.width(),n=this.height(),i=this.tileWidth(),r=this.tileHeight(),o=this.numHorizontalTiles(),s=this.numVerticalTiles(),a=t.width(),l=t.height(),c=t.tileWidth(),u=t.tileHeight(),h=t.numHorizontalTiles(),f=t.numVerticalTiles();if(e%a!=0)throw new Error(\"Level width must be multiple of parent level: \"+e+\" vs. \"+a);if(n%l!=0)throw new Error(\"Level height must be multiple of parent level: \"+n+\" vs. \"+l);if(o%h!=0)throw new Error(\"Number of horizontal tiles must be multiple of parent level: \"+o+\" (\"+e+\"/\"+i+\") vs. \"+h+\" (\"+a+\"/\"+c+\")\");if(s%f!=0)throw new Error(\"Number of vertical tiles must be multiple of parent level: \"+s+\" (\"+n+\"/\"+r+\") vs. \"+f+\" (\"+l+\"/\"+u+\")\")},Ds.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},Ds.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t),i=t.numHorizontalTiles()-1,r=t.numVerticalTiles()-1;e=e||[];for(var o=0;o<Es.length;o++)for(var s=Es[o],a=0;a<=i;a++)for(var l=0;l<=r;l++)e.push(new Rs(s,a,l,n,this));return e},Ds.prototype._closestTile=function(t,e){var n=this._vec;Ms.set(n,0,0,1,1),Ms.transformMat4(n,n,t.inverseProjection());var i=1/0,r=null;for(var o in Ss){var s=Ss[o],a=1-xs.dot(s,n);a<i&&(i=a,r=o)}for(var l=Math.max(Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2]))/.5,c=0;c<3;c++)n[c]=n[c]/l;var u=Ts[r];Cs(n,0,-u.x,-u.y);var h=this.levelList.indexOf(e),f=e.numHorizontalTiles(),p=e.numVerticalTiles();return new Rs(r,ws(Math.floor((.5+n[0])*f),0,f-1),ws(Math.floor((.5-n[1])*p),0,p-1),h,this)},Ds.prototype.visibleTiles=function(t,e,n){var i=this._viewSize,r=this._tileSearcher;if(n=n||[],t.size(i),0===i.width||0===i.height)return n;var o=this._closestTile(t,e);if(!r.search(t,o,n))throw new Error(\"Starting tile is not visible\");return n},Ds.Tile=Ds.prototype.Tile=Rs,Ds.type=Ds.prototype.type=\"cube\",Rs.type=Rs.prototype.type=\"cube\";var Fs=Ds,qs=de,js=Ko,Vs=is,Ns=ss,Bs=ls,Xs=hs.makeLevelList,Ws=hs.makeSelectableLevelList,Ys=Rr,Us=Zo,Gs=cs,Ks=fs,Zs=Or.vec2,Qs=Or.vec4,Js=[[0,1],[1,0],[0,-1],[-1,0]];function ta(t,e,n,i){this.x=t,this.y=e,this.z=n,this._geometry=i,this._level=i.levelList[n]}function ea(t){this.constructor.super_.call(this,t),this._width=t.width,this._height=t.height,this._tileWidth=t.tileWidth,this._tileHeight=t.tileHeight}function na(t){if(\"array\"!==Ks(t))throw new Error(\"Level list must be an array\");this.levelList=Xs(t,ea),this.selectableLevelList=Ws(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._tileSearcher=new Vs(this),this._neighborsCache=new Ns(64),this._vec=Qs.create(),this._viewSize={}}ta.prototype.rotX=function(){return 0},ta.prototype.rotY=function(){return 0},ta.prototype.centerX=function(){var t=this._level.width(),e=this._level.tileWidth();return(this.x*e+.5*this.width())/t-.5},ta.prototype.centerY=function(){var t=this._level.height(),e=this._level.tileHeight();return.5-(this.y*e+.5*this.height())/t},ta.prototype.scaleX=function(){var t=this._level.width();return this.width()/t},ta.prototype.scaleY=function(){var t=this._level.height();return this.height()/t},ta.prototype.width=function(){var t=this._level.width(),e=this._level.tileWidth();return this.x===this._level.numHorizontalTiles()-1&&Us(t,e)||e},ta.prototype.height=function(){var t=this._level.height(),e=this._level.tileHeight();return this.y===this._level.numVerticalTiles()-1&&Us(t,e)||e},ta.prototype.levelWidth=function(){return this._level.width()},ta.prototype.levelHeight=function(){return this._level.height()},ta.prototype.vertices=function(t){t||(t=[Zs.create(),Zs.create(),Zs.create(),Zs.create()]);var e=this.centerX()-this.scaleX()/2,n=this.centerX()+this.scaleX()/2,i=this.centerY()-this.scaleY()/2,r=this.centerY()+this.scaleY()/2;return Zs.set(t[0],e,r),Zs.set(t[1],n,r),Zs.set(t[2],n,i),Zs.set(t[3],e,i),t},ta.prototype.parent=function(){if(0===this.z)return null;var t=this._geometry,e=this.z-1;return new ta(Math.floor(this.x/2),Math.floor(this.y/2),e,t)},ta.prototype.children=function(t){if(this.z===this._geometry.levelList.length-1)return null;var e=this._geometry,n=this.z+1;return(t=t||[]).push(new ta(2*this.x,2*this.y,n,e)),t.push(new ta(2*this.x,2*this.y+1,n,e)),t.push(new ta(2*this.x+1,2*this.y,n,e)),t.push(new ta(2*this.x+1,2*this.y+1,n,e)),t},ta.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,n=e.get(this);if(n)return n;for(var i=this.x,r=this.y,o=this.z,s=this._level,a=s.numHorizontalTiles()-1,l=s.numVerticalTiles()-1,c=[],u=0;u<Js.length;u++){var h=i+Js[u][0],f=r+Js[u][1],p=o;0<=h&&h<=a&&0<=f&&f<=l&&c.push(new ta(h,f,p,t))}return e.set(this,c),c},ta.prototype.hash=function(){return js(this.z,this.y,this.x)},ta.prototype.equals=function(t){return this._geometry===t._geometry&&this.z===t.z&&this.y===t.y&&this.x===t.x},ta.prototype.cmp=function(t){return Gs(this.z,t.z)||Gs(this.y,t.y)||Gs(this.x,t.x)},ta.prototype.str=function(){return\"FlatTile(\"+tile.x+\", \"+tile.y+\", \"+tile.z+\")\"},qs(ea,Bs),ea.prototype.width=function(){return this._width},ea.prototype.height=function(){return this._height},ea.prototype.tileWidth=function(){return this._tileWidth},ea.prototype.tileHeight=function(){return this._tileHeight},ea.prototype._validateWithParentLevel=function(t){var e=this.width(),n=this.height(),i=this.tileWidth(),r=this.tileHeight(),o=t.width(),s=t.height(),a=t.tileWidth(),l=t.tileHeight();return e%o!=0?new Error(\"Level width must be multiple of parent level: \"+e+\" vs. \"+o):n%s!=0?new Error(\"Level height must be multiple of parent level: \"+n+\" vs. \"+s):i%a!=0?new Error(\"Level tile width must be multiple of parent level: \"+i+\" vs. \"+a):r%l!=0?new Error(\"Level tile height must be multiple of parent level: \"+r+\" vs. \"+l):void 0},na.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},na.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t),i=t.numHorizontalTiles()-1,r=t.numVerticalTiles()-1;e||(e=[]);for(var o=0;o<=i;o++)for(var s=0;s<=r;s++)e.push(new ta(o,s,n,this));return e},na.prototype._closestTile=function(t,e){var n=this._vec;Qs.set(n,0,0,1,1),Qs.transformMat4(n,n,t.inverseProjection());var i=.5+n[0],r=.5-n[1],o=this.levelList.indexOf(e),s=e.width(),a=e.height(),l=e.tileWidth(),c=e.tileHeight(),u=e.numHorizontalTiles(),h=e.numVerticalTiles();return new ta(Ys(Math.floor(i*s/l),0,u-1),Ys(Math.floor(r*a/c),0,h-1),o,this)},na.prototype.visibleTiles=function(t,e,n){var i=this._viewSize,r=this._tileSearcher;if(n=n||[],t.size(i),0===i.width||0===i.height)return n;var o=this._closestTile(t,e);if(!r.search(t,o,n))throw new Error(\"Starting tile is not visible\");return n},na.Tile=na.prototype.Tile=ta,na.type=na.prototype.type=\"flat\",ta.type=ta.prototype.type=\"flat\";var ia=na,ra=de,oa=Ko,sa=cs,aa=hs,la=ls,ca=fs;function ua(t,e){this.z=t,this._geometry=e,this._level=e.levelList[t]}function ha(t){this.constructor.super_.call(this,t),this._width=t.width}function fa(t){if(\"array\"!==ca(t))throw new Error(\"Level list must be an array\");this.levelList=aa.makeLevelList(t,ha),this.selectableLevelList=aa.makeSelectableLevelList(this.levelList)}ua.prototype.rotX=function(){return 0},ua.prototype.rotY=function(){return 0},ua.prototype.centerX=function(){return.5},ua.prototype.centerY=function(){return.5},ua.prototype.scaleX=function(){return 1},ua.prototype.scaleY=function(){return 1},ua.prototype.parent=function(){return 0===this.z?null:new ua(this.z-1,this._geometry)},ua.prototype.children=function(t){return this.z===this._geometry.levelList.length-1?null:((t=t||[]).push(new ua(this.z+1,this._geometry)),t)},ua.prototype.neighbors=function(){return[]},ua.prototype.hash=function(){return oa(this.z)},ua.prototype.equals=function(t){return this._geometry===t._geometry&&this.z===t.z},ua.prototype.cmp=function(t){return sa(this.z,t.z)},ua.prototype.str=function(){return\"EquirectTile(\"+tile.z+\")\"},ra(ha,la),ha.prototype.width=function(){return this._width},ha.prototype.height=function(){return this._width/2},ha.prototype.tileWidth=function(){return this._width},ha.prototype.tileHeight=function(){return this._width/2},fa.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},fa.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t);return(e=e||[]).push(new ua(n,this)),e},fa.prototype.visibleTiles=function(t,e,n){var i=new ua(this.levelList.indexOf(e),this);(n=n||[]).length=0,n.push(i)},fa.Tile=fa.prototype.Tile=ua,fa.type=fa.prototype.type=\"equirect\",ua.type=ua.prototype.type=\"equirect\";var pa=fa;function da(t,e,n){return 2*Math.atan(n*Math.tan(t/2)/e)}var ma={convert:da,htov:function(t,e,n){return da(t,e,n)},htod:function(t,e,n){return da(t,e,Math.sqrt(e*e+n*n))},vtoh:function(t,e,n){return da(t,n,e)},vtod:function(t,e,n){return da(t,n,Math.sqrt(e*e+n*n))},dtoh:function(t,e,n){return da(t,Math.sqrt(e*e+n*n),e)},dtov:function(t,e,n){return da(t,Math.sqrt(e*e+n*n),n)}};var va=function(t){return\"number\"==typeof t&&isFinite(t)};var _a=function(t){return t.toPrecision(15)};var ya=function(){var t=arguments;return function(e){for(var n=e,i=0;i<t.length;i++){n=t[i].call(null,n)}return n}},ga=Ft,wa=Or.mat4,$a=Or.vec4,ba=ke,xa=ma,Ma=Zo,Ea=va,Ta=Rr,La=_a,Ca=ya,Sa=Kt,ka=Math.PI/4,Ia=1e-6;function Pa(t,e){this._yaw=t&&null!=t.yaw?t.yaw:0,this._pitch=t&&null!=t.pitch?t.pitch:0,this._roll=t&&null!=t.roll?t.roll:0,this._fov=t&&null!=t.fov?t.fov:ka,this._width=t&&null!=t.width?t.width:0,this._height=t&&null!=t.height?t.height:0,this._projectionCenterX=t&&null!=t.projectionCenterX?t.projectionCenterX:0,this._projectionCenterY=t&&null!=t.projectionCenterY?t.projectionCenterY:0,this._limiter=e||null,this._projMatrix=wa.create(),this._invProjMatrix=wa.create(),this._frustum=[$a.create(),$a.create(),$a.create(),$a.create(),$a.create()],this._projectionChanged=!0,this._params={},this._fovs={},this._tmpVec=$a.create(),this._update()}ga(Pa),Pa.prototype.destroy=function(){Sa(this)},Pa.prototype.yaw=function(){return this._yaw},Pa.prototype.pitch=function(){return this._pitch},Pa.prototype.roll=function(){return this._roll},Pa.prototype.projectionCenterX=function(){return this._projectionCenterX},Pa.prototype.projectionCenterY=function(){return this._projectionCenterY},Pa.prototype.fov=function(){return this._fov},Pa.prototype.width=function(){return this._width},Pa.prototype.height=function(){return this._height},Pa.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},Pa.prototype.parameters=function(t){return(t=t||{}).yaw=this._yaw,t.pitch=this._pitch,t.roll=this._roll,t.fov=this._fov,t},Pa.prototype.limiter=function(){return this._limiter},Pa.prototype.setYaw=function(t){this._resetParams(),this._params.yaw=t,this._update(this._params)},Pa.prototype.setPitch=function(t){this._resetParams(),this._params.pitch=t,this._update(this._params)},Pa.prototype.setRoll=function(t){this._resetParams(),this._params.roll=t,this._update(this._params)},Pa.prototype.setFov=function(t){this._resetParams(),this._params.fov=t,this._update(this._params)},Pa.prototype.setProjectionCenterX=function(t){this._resetParams(),this._params.projectionCenterX=t,this._update(this._params)},Pa.prototype.setProjectionCenterY=function(t){this._resetParams(),this._params.projectionCenterY=t,this._update(this._params)},Pa.prototype.offsetYaw=function(t){this.setYaw(this._yaw+t)},Pa.prototype.offsetPitch=function(t){this.setPitch(this._pitch+t)},Pa.prototype.offsetRoll=function(t){this.setRoll(this._roll+t)},Pa.prototype.offsetFov=function(t){this.setFov(this._fov+t)},Pa.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},Pa.prototype.setParameters=function(t){this._resetParams(),this._params.yaw=t.yaw,this._params.pitch=t.pitch,this._params.roll=t.roll,this._params.fov=t.fov,this._params.projectionCenterX=t.projectionCenterX,this._params.projectionCenterY=t.projectionCenterY,this._update(this._params)},Pa.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},Pa.prototype._resetParams=function(){var t=this._params;t.yaw=null,t.pitch=null,t.roll=null,t.fov=null,t.width=null,t.height=null},Pa.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._yaw,n=this._pitch,i=this._roll,r=this._fov,o=this._projectionCenterX,s=this._projectionCenterY,a=this._width,l=this._height;if(t.yaw=null!=t.yaw?t.yaw:e,t.pitch=null!=t.pitch?t.pitch:n,t.roll=null!=t.roll?t.roll:i,t.fov=null!=t.fov?t.fov:r,t.width=null!=t.width?t.width:a,t.height=null!=t.height?t.height:l,t.projectionCenterX=null!=t.projectionCenterX?t.projectionCenterX:o,t.projectionCenterY=null!=t.projectionCenterY?t.projectionCenterY:s,this._limiter&&!(t=this._limiter(t)))throw new Error(\"Bad view limiter\");var c=(t=this._normalize(t)).yaw,u=t.pitch,h=t.roll,f=t.fov,p=t.width,d=t.height,m=t.projectionCenterX,v=t.projectionCenterY;if(!(Ea(c)&&Ea(u)&&Ea(h)&&Ea(f)&&Ea(p)&&Ea(d)&&Ea(m)&&Ea(v)))throw new Error(\"Bad view - suspect a broken limiter\");this._yaw=c,this._pitch=u,this._roll=h,this._fov=f,this._width=p,this._height=d,this._projectionCenterX=m,this._projectionCenterY=v,c===e&&u===n&&h===i&&f===r&&p===a&&d===l&&m===o&&v===s||(this._projectionChanged=!0,this.emit(\"change\")),p===a&&d===l||this.emit(\"resize\")},Pa.prototype._normalize=function(t){this._normalizeCoordinates(t);var e=xa.htov(Math.PI,t.width,t.height),n=isNaN(e)?Math.PI:Math.min(Math.PI,e);return t.fov=Ta(t.fov,Ia,n-Ia),t},Pa.prototype._normalizeCoordinates=function(t){return\"yaw\"in t&&(t.yaw=Ma(t.yaw-Math.PI,-2*Math.PI)+Math.PI),\"pitch\"in t&&(t.pitch=Ma(t.pitch-Math.PI,-2*Math.PI)+Math.PI),\"roll\"in t&&(t.roll=Ma(t.roll-Math.PI,-2*Math.PI)+Math.PI),t},Pa.prototype.normalizeToClosest=function(t,e){var n=this._yaw,i=this._pitch,r=t.yaw,o=t.pitch,s=r-2*Math.PI,a=r+2*Math.PI;Math.abs(s-n)<Math.abs(r-n)?r=s:Math.abs(a-n)<Math.abs(r-n)&&(r=a);var l=o-2*Math.PI,c=o+2*Math.PI;return Math.abs(l-i)<Math.abs(o-i)?o=l:Math.abs(l-i)<Math.abs(o-i)&&(o=c),(e=e||{}).yaw=r,e.pitch=o,e},Pa.prototype.updateWithControlParameters=function(t){var e=this._fov,n=xa.vtoh(e,this._width,this._height);isNaN(n)&&(n=e),this.offsetYaw(t.axisScaledX*n+2*t.x*n+t.yaw),this.offsetPitch(t.axisScaledY*e+2*t.y*n+t.pitch),this.offsetRoll(-t.roll),this.offsetFov(t.zoom*e)},Pa.prototype._updateProjection=function(){var t=this._projMatrix,e=this._invProjMatrix,n=this._frustum;if(this._projectionChanged){var i=this._width,r=this._height,o=this._fov,s=xa.vtoh(o,i,r),a=i/r,l=this._projectionCenterX,c=this._projectionCenterY;if(0!==l||0!==c){var u=Math.atan(2*l*Math.tan(s/2)),h=Math.atan(2*c*Math.tan(o/2)),f=this._fovs;f.leftDegrees=180*(s/2+u)/Math.PI,f.rightDegrees=180*(s/2-u)/Math.PI,f.upDegrees=180*(o/2+h)/Math.PI,f.downDegrees=180*(o/2-h)/Math.PI,wa.perspectiveFromFieldOfView(t,f,-1,1)}else wa.perspective(t,o,a,-1,1);wa.rotateZ(t,t,this._roll),wa.rotateX(t,t,this._pitch),wa.rotateY(t,t,this._yaw),wa.invert(e,t),this._matrixToFrustum(t,n),this._projectionChanged=!1}},Pa.prototype._matrixToFrustum=function(t,e){$a.set(e[0],t[3]+t[0],t[7]+t[4],t[11]+t[8],0),$a.set(e[1],t[3]-t[0],t[7]-t[4],t[11]-t[8],0),$a.set(e[2],t[3]+t[1],t[7]+t[5],t[11]+t[9],0),$a.set(e[3],t[3]-t[1],t[7]-t[5],t[11]-t[9],0),$a.set(e[4],t[3]+t[2],t[7]+t[6],t[11]+t[10],0)},Pa.prototype.projection=function(){return this._updateProjection(),this._projMatrix},Pa.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},Pa.prototype.intersects=function(t){this._updateProjection();for(var e=this._frustum,n=this._tmpVec,i=0;i<e.length;i++){for(var r=e[i],o=!1,s=0;s<t.length;s++){var a=t[s];$a.set(n,a[0],a[1],a[2],0),$a.dot(r,n)>=0&&(o=!0)}if(!o)return!1}return!0},Pa.prototype.selectLevel=function(t){for(var e=ba()*this._height,n=Math.tan(.5*this._fov),i=0;i<t.length;i++){var r=t[i];if(n*r.height()>=e)return r}return t[t.length-1]},Pa.prototype.coordinatesToScreen=function(t,e){var n=this._tmpVec;e||(e={});var i=this._width,r=this._height;if(i<=0||r<=0)return e.x=null,e.y=null,null;var o=t.yaw,s=t.pitch,a=Math.sin(o)*Math.cos(s),l=-Math.sin(s),c=-Math.cos(o)*Math.cos(s);return $a.set(n,a,l,c,1),$a.transformMat4(n,n,this.projection()),n[3]>=0?(e.x=i*(n[0]/n[3]+1)/2,e.y=r*(1-n[1]/n[3])/2,e):(e.x=null,e.y=null,null)},Pa.prototype.screenToCoordinates=function(t,e){var n=this._tmpVec;e||(e={});var i=this._width,r=this._height,o=2*t.x/i-1,s=1-2*t.y/r;$a.set(n,o,s,1,1),$a.transformMat4(n,n,this.inverseProjection());var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return e.yaw=Math.atan2(n[0],-n[2]),e.pitch=Math.acos(n[1]/a)-Math.PI/2,this._normalizeCoordinates(e),e},Pa.prototype.coordinatesToPerspectiveTransform=function(t,e,n){n=n||\"\";var i=this._height,r=this._width,o=this._fov,s=.5*i/Math.tan(o/2),a=\"\";return a+=\"translateX(\"+La(r/2)+\"px) \",a+=\"translateY(\"+La(i/2)+\"px) \",a+=\"translateX(-50%) translateY(-50%) \",a+=\"perspective(\"+La(s)+\"px) \",a+=\"translateZ(\"+La(s)+\"px) \",a+=\"rotateZ(\"+La(-this._roll)+\"rad) \",a+=\"rotateX(\"+La(-this._pitch)+\"rad) \",a+=\"rotateY(\"+La(this._yaw)+\"rad) \",a+=\"rotateY(\"+La(-t.yaw)+\"rad) \",a+=\"rotateX(\"+La(t.pitch)+\"rad) \",a+=\"translateZ(\"+La(-e)+\"px) \",a+=n+\" \"},Pa.limit={yaw:function(t,e){return function(n){return n.yaw=Ta(n.yaw,t,e),n}},pitch:function(t,e){return function(n){return n.pitch=Ta(n.pitch,t,e),n}},roll:function(t,e){return function(n){return n.roll=Ta(n.roll,t,e),n}},hfov:function(t,e){return function(n){var i=n.width,r=n.height;if(i>0&&r>0){var o=xa.htov(t,i,r),s=xa.htov(e,i,r);n.fov=Ta(n.fov,o,s)}return n}},vfov:function(t,e){return function(n){return n.fov=Ta(n.fov,t,e),n}},resolution:function(t){return function(e){var n=e.height;if(n){var i=ba()*n,r=2*Math.atan(i/t);e.fov=Ta(e.fov,r,1/0)}return e}},traditional:function(t,e,n){return n=null!=n?n:e,Ca(Pa.limit.resolution(t),Pa.limit.vfov(0,e),Pa.limit.hfov(0,n),Pa.limit.pitch(-Math.PI/2,Math.PI/2))}},Pa.type=Pa.prototype.type=\"rectilinear\";var Aa=Pa,za=Ft,Oa=Or.mat4,Ra=Or.vec4,Ha=ke,Da=va,Fa=Rr,qa=Kt,ja=[1,0,1,0],Va=[-1,-1,1,1];function Na(t,e){if(!t||null==t.mediaAspectRatio)throw new Error(\"mediaAspectRatio must be defined\");this._x=t&&null!=t.x?t.x:.5,this._y=t&&null!=t.y?t.y:.5,this._zoom=t&&null!=t.zoom?t.zoom:1,this._mediaAspectRatio=t.mediaAspectRatio,this._width=t&&null!=t.width?t.width:0,this._height=t&&null!=t.height?t.height:0,this._limiter=e||null,this._projMatrix=Oa.create(),this._invProjMatrix=Oa.create(),this._frustum=[0,0,0,0],this._projectionChanged=!0,this._params={},this._vec=Ra.create(),this._update()}za(Na),Na.prototype.destroy=function(){qa(this)},Na.prototype.x=function(){return this._x},Na.prototype.y=function(){return this._y},Na.prototype.zoom=function(){return this._zoom},Na.prototype.mediaAspectRatio=function(){return this._mediaAspectRatio},Na.prototype.width=function(){return this._width},Na.prototype.height=function(){return this._height},Na.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},Na.prototype.parameters=function(t){return(t=t||{}).x=this._x,t.y=this._y,t.zoom=this._zoom,t.mediaAspectRatio=this._mediaAspectRatio,t},Na.prototype.limiter=function(){return this._limiter},Na.prototype.setX=function(t){this._resetParams(),this._params.x=t,this._update(this._params)},Na.prototype.setY=function(t){this._resetParams(),this._params.y=t,this._update(this._params)},Na.prototype.setZoom=function(t){this._resetParams(),this._params.zoom=t,this._update(this._params)},Na.prototype.offsetX=function(t){this.setX(this._x+t)},Na.prototype.offsetY=function(t){this.setY(this._y+t)},Na.prototype.offsetZoom=function(t){this.setZoom(this._zoom+t)},Na.prototype.setMediaAspectRatio=function(t){this._resetParams(),this._params.mediaAspectRatio=t,this._update(this._params)},Na.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},Na.prototype.setParameters=function(t){this._resetParams(),this._params.x=t.x,this._params.y=t.y,this._params.zoom=t.zoom,this._params.mediaAspectRatio=t.mediaAspectRatio,this._update(this._params)},Na.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},Na.prototype._resetParams=function(){var t=this._params;t.x=null,t.y=null,t.zoom=null,t.mediaAspectRatio=null,t.width=null,t.height=null},Na.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._x,n=this._y,i=this._zoom,r=this._mediaAspectRatio,o=this._width,s=this._height;if(t.x=null!=t.x?t.x:e,t.y=null!=t.y?t.y:n,t.zoom=null!=t.zoom?t.zoom:i,t.mediaAspectRatio=null!=t.mediaAspectRatio?t.mediaAspectRatio:r,t.width=null!=t.width?t.width:o,t.height=null!=t.height?t.height:s,this._limiter&&!(t=this._limiter(t)))throw new Error(\"Bad view limiter\");var a=t.x,l=t.y,c=t.zoom,u=t.mediaAspectRatio,h=t.width,f=t.height;if(!(Da(a)&&Da(l)&&Da(c)&&Da(u)&&Da(h)&&Da(f)))throw new Error(\"Bad view - suspect a broken limiter\");c=Fa(c,1e-6,1/0),this._x=a,this._y=l,this._zoom=c,this._mediaAspectRatio=u,this._width=h,this._height=f,a===e&&l===n&&c===i&&u===r&&h===o&&f===s||(this._projectionChanged=!0,this.emit(\"change\")),h===o&&f===s||this.emit(\"resize\")},Na.prototype._zoomX=function(){return this._zoom},Na.prototype._zoomY=function(){var t=this._mediaAspectRatio,e=this._width/this._height,n=this._zoom,i=n*t/e;return isNaN(i)&&(i=n),i},Na.prototype.updateWithControlParameters=function(t){var e=this.zoom(),n=this._zoomX(),i=this._zoomY();this.offsetX(t.axisScaledX*n+t.x*e),this.offsetY(t.axisScaledY*i+t.y*e),this.offsetZoom(t.zoom*e)},Na.prototype._updateProjection=function(){var t=this._projMatrix,e=this._invProjMatrix,n=this._frustum;if(this._projectionChanged){var i=this._x,r=this._y,o=this._zoomX(),s=this._zoomY(),a=n[0]=.5-r+.5*s,l=n[1]=i-.5+.5*o,c=n[2]=.5-r-.5*s,u=n[3]=i-.5-.5*o;Oa.ortho(t,u,l,c,a,-1,1),Oa.invert(e,t),this._projectionChanged=!1}},Na.prototype.projection=function(){return this._updateProjection(),this._projMatrix},Na.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},Na.prototype.intersects=function(t){this._updateProjection();for(var e=this._frustum,n=0;n<e.length;n++){for(var i=e[n],r=ja[n],o=Va[n],s=!1,a=0;a<t.length;a++){var l=t[a];if(o<0&&l[r]<i||o>0&&l[r]>i){s=!0;break}}if(!s)return!1}return!0},Na.prototype.selectLevel=function(t){for(var e=Ha()*this.width(),n=this._zoom,i=0;i<t.length;i++){var r=t[i];if(n*r.width()>=e)return r}return t[t.length-1]},Na.prototype.coordinatesToScreen=function(t,e){var n=this._vec;e||(e={});var i=this._width,r=this._height;if(i<=0||r<=0)return e.x=null,e.y=null,null;var o=t&&null!=t.x?t.x:.5,s=t&&null!=t.y?t.y:.5;Ra.set(n,o-.5,.5-s,-1,1),Ra.transformMat4(n,n,this.projection());for(var a=0;a<3;a++)n[a]/=n[3];return e.x=i*(n[0]+1)/2,e.y=r*(1-n[1])/2,e},Na.prototype.screenToCoordinates=function(t,e){var n=this._vec;e||(e={});var i=this._width,r=this._height,o=2*t.x/i-1,s=1-2*t.y/r;return Ra.set(n,o,s,1,1),Ra.transformMat4(n,n,this.inverseProjection()),e.x=.5+n[0],e.y=.5-n[1],e},Na.limit={x:function(t,e){return function(n){return n.x=Fa(n.x,t,e),n}},y:function(t,e){return function(n){return n.y=Fa(n.y,t,e),n}},zoom:function(t,e){return function(n){return n.zoom=Fa(n.zoom,t,e),n}},resolution:function(t){return function(e){if(e.width<=0||e.height<=0)return e;var n=e.width,i=Ha()*n/t;return e.zoom=Fa(e.zoom,i,1/0),e}},visibleX:function(t,e){return function(n){var i=e-t;n.zoom>i&&(n.zoom=i);var r=t+.5*n.zoom,o=e-.5*n.zoom;return n.x=Fa(n.x,r,o),n}},visibleY:function(t,e){return function(n){if(n.width<=0||n.height<=0)return n;var i=n.width/n.height/n.mediaAspectRatio,r=(e-t)*i;n.zoom>r&&(n.zoom=r);var o=t+.5*n.zoom/i,s=e-.5*n.zoom/i;return n.y=Fa(n.y,o,s),n}},letterbox:function(){return function(t){if(t.width<=0||t.height<=0)return t;var e,n,i,r,o=t.width/t.height,s=o/t.mediaAspectRatio;return t.mediaAspectRatio>=o&&(t.zoom=Math.min(t.zoom,1)),t.mediaAspectRatio<=o&&(t.zoom=Math.min(t.zoom,s)),t.zoom>1?e=n=.5:(e=0+.5*t.zoom/1,n=1-.5*t.zoom/1),t.zoom>s?i=r=.5:(i=0+.5*t.zoom/s,r=1-.5*t.zoom/s),t.x=Fa(t.x,e,n),t.y=Fa(t.y,i,r),t}}},Na.type=Na.prototype.type=\"flat\";var Ba=Na,Xa=Bt,Wa=Zo;function Ya(t){this._concurrency=t&&t.concurrency||1,this._paused=t&&!!t.paused||!1,this._pool=[];for(var e=0;e<this._concurrency;e++)this._pool.push(new Xa(t));this._next=0}Ya.prototype.length=function(){for(var t=0,e=0;e<this._pool.length;e++)t+=this._pool[e].length();return t},Ya.prototype.push=function(t,e){var n=this._next,i=this._pool[n].push(t,e);return this._next=Wa(this._next+1,this._concurrency),i},Ya.prototype.pause=function(){if(!this._paused){this._paused=!0;for(var t=0;t<this._concurrency;t++)this._pool[t].pause()}},Ya.prototype.resume=function(){if(this._paused){this._paused=!1;for(var t=0;t<this._concurrency;t++)this._pool[t].resume()}};var Ua=function(){},Ga=Ua;var Ka=function(){var t=Array.prototype.slice.call(arguments,0);return function(){var e=t.slice(0),n=null,i=null,r=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],o=arguments.length?arguments[arguments.length-1]:Ga;function s(){var t=arguments[0];if(t)return n=i=null,void o.apply(null,arguments);if(!e.length)return n=i=null,void o.apply(null,arguments);var r=n=e.shift(),a=Array.prototype.slice.call(arguments,1);a.push(s);var l=n.apply(null,a);if(r===n){if(\"function\"!=typeof l)throw new Error(\"chain: chaining on non-cancellable function\");i=l}}function a(){i&&i.apply(null,arguments)}return r.unshift(null),s.apply(null,r),a}};var Za=function(t,e){var n=null;return n=setTimeout((function(){null!=n&&(n=null,e(null))}),t),function(){null!=n&&(clearTimeout(n),n=null,e.apply(null,arguments))}},Qa=ge,Ja=Ya,tl=Ka,el=Za,nl=qt,il={x:\"x\",y:\"y\",z:\"z\",f:\"face\"};function rl(t,e){e=e||{},this._loadPool=new Ja({concurrency:e.concurrency||4}),this._retryDelay=e.retryDelay||1e4,this._retryMap={},this._sourceFromTile=t}function ol(t){return new RegExp(\"\\\\{(\"+t+\")\\\\}\",\"g\")}Ft(rl),rl.prototype.loadAsset=function(t,e,n){var i,r=this,o=this._retryDelay,s=this._retryMap,a=this._sourceFromTile(e),l=a.url,c=a.rect,u=t.loadImage.bind(t,l,c),h=s[l];if(null!=h){var f=nl()-h;f<o?i=o-f:(i=0,delete s[l])}var p=el.bind(null,i);return tl(p,(function(t){return r._loadPool.push(u,(function(n,i){n?(n instanceof Qa&&(s[l]=nl(),r.emit(\"networkError\",n,e)),t(n,e)):(delete s[l],t(null,e,i))}))}))(n)},rl.fromString=function(t,e){var n=(e=e||{})&&e.cubeMapPreviewFaceOrder||\"bdflru\";return new rl(e.cubeMapPreviewUrl?function(t){return 0===t.z?function(t){var i=n.indexOf(t.face)/6;return{url:e.cubeMapPreviewUrl,rect:{x:0,y:i,width:1,height:1/6}}}(t):i(t)}:i,e);function i(e){var n=t;for(var i in il){var r=il[i],o=ol(i),s=e.hasOwnProperty(r)?e[r]:\"\";n=n.replace(o,s)}return{url:n}}};var sl=rl;function al(t){this._asset=t}al.prototype.asset=function(){return this._asset},al.prototype.loadAsset=function(t,e,n){var i=this,r=setTimeout((function(){n(null,e,i._asset)}),0);return function(){clearTimeout(r),n.apply(null,arguments)}};var ll=al,cl=Ft,ul=Kt;function hl(t){this.constructor.super_.call(this,t),this._timestamp=0}de(hl,pe),cl(hl),hl.prototype.destroy=function(){ul(this)},hl.prototype.timestamp=function(){return this._timestamp},hl.prototype.isDynamic=function(){return!0},hl.prototype.markDirty=function(){this._timestamp++,this.emit(\"change\")};var fl=hl,pl=Zo;function dl(t){if(null!=t&&(!isFinite(t)||Math.floor(t)!==t||t<1))throw new Error(\"Map: invalid capacity\");this._capacity=t||64,this._keyBuckets=[],this._valBuckets=[];for(var e=0;e<this._capacity;e++)this._keyBuckets.push([]),this._valBuckets.push([]);this._size=0}dl.prototype.get=function(t){for(var e=pl(t.hash(),this._capacity),n=this._keyBuckets[e],i=0;i<n.length;i++){var r=n[i];if(t.equals(r))return this._valBuckets[e][i]}return null},dl.prototype.set=function(t,e){for(var n=pl(t.hash(),this._capacity),i=this._keyBuckets[n],r=this._valBuckets[n],o=0;o<i.length;o++){var s=i[o];if(t.equals(s)){var a=r[o];return i[o]=t,r[o]=e,a}}return i.push(t),r.push(e),this._size++,null},dl.prototype.del=function(t){for(var e=pl(t.hash(),this._capacity),n=this._keyBuckets[e],i=this._valBuckets[e],r=0;r<n.length;r++){var o=n[r];if(t.equals(o)){for(var s=i[r],a=r;a<n.length-1;a++)n[a]=n[a+1],i[a]=i[a+1];return n.length=n.length-1,i.length=i.length-1,this._size--,s}}return null},dl.prototype.has=function(t){for(var e=pl(t.hash(),this._capacity),n=this._keyBuckets[e],i=0;i<n.length;i++){var r=n[i];if(t.equals(r))return!0}return!1},dl.prototype.size=function(){return this._size},dl.prototype.clear=function(){for(var t=0;t<this._capacity;t++)this._keyBuckets[t].length=0,this._valBuckets[t].length=0;this._size=0},dl.prototype.forEach=function(t){for(var e=0,n=0;n<this._capacity;n++)for(var i=this._keyBuckets[n],r=this._valBuckets[n],o=0;o<i.length;o++)t(i[o],r[o]),e+=1;return e};var ml=dl,vl=Zo;function _l(t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new Error(\"LruSet: invalid capacity\");this._capacity=t,this._elements=new Array(this._capacity),this._start=0,this._size=0}_l.prototype._index=function(t){return vl(this._start+t,this._capacity)},_l.prototype.add=function(t){if(0===this._capacity)return t;this.remove(t);var e=this._size===this._capacity?this._elements[this._index(0)]:null;return this._elements[this._index(this._size)]=t,this._size<this._capacity?this._size++:this._start=this._index(1),e},_l.prototype.remove=function(t){for(var e=0;e<this._size;e++){var n=this._elements[this._index(e)];if(t.equals(n)){for(var i=e;i<this._size-1;i++)this._elements[this._index(i)]=this._elements[this._index(i+1)];return this._size--,n}}return null},_l.prototype.has=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._elements[this._index(e)]))return!0;return!1},_l.prototype.size=function(){return this._size},_l.prototype.clear=function(){this._elements.length=0,this._start=0,this._size=0},_l.prototype.forEach=function(t){for(var e=0,n=0;n<this._size;n++)t(this._elements[this._index(n)]),e+=1;return e};var yl=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},gl=Ua;var wl=function(t){return function(){var e=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],n=arguments.length?arguments[arguments.length-1]:gl,i=null,r=!1;function o(){var o=arguments[0];!o||r?n.apply(null,arguments):i=t.apply(null,e)}return e.push(o),o(!0),function(){r=!0,i.apply(null,arguments)}}},$l=ml,bl=ts,xl=_l,Ml=Ft,El=yl,Tl=wl,Ll=Ka,Cl=de,Sl=Kt,kl=\"undefined\"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.textureStore,Il=0,Pl=1,Al=2,zl=3,Ol={previouslyVisibleCacheSize:512},Rl=0;function Hl(){}function Dl(t,e){var n=this,i=Rl++;n._id=i,n._store=t,n._tile=e,n._asset=null,n._texture=null,n._changeHandler=function(){t.emit(\"textureInvalid\",e)};var r=t.source(),o=t.stage(),s=r.loadAsset.bind(r),a=o.createTexture.bind(o),l=Ll(Tl(s),a);t.emit(\"textureStartLoad\",e),kl&&console.log(\"loading\",i,e),n._cancel=l(o,e,(function(r,o,s,a){if(n._cancel=null,r)return s&&s.destroy(),a&&a.destroy(),void(r instanceof Hl?(t.emit(\"textureCancel\",e),kl&&console.log(\"cancel\",i,e)):(t.emit(\"textureError\",e,r),kl&&console.log(\"error\",i,e)));n._texture=a,s.isDynamic()?(n._asset=s,s.addEventListener(\"change\",n._changeHandler)):s.destroy(),t.emit(\"textureLoad\",e),kl&&console.log(\"load\",i,e)}))}function Fl(t,e,n){n=El(n||{},Ol),this._source=t,this._stage=e,this._state=Il,this._delimCount=0,this._itemMap=new $l,this._visible=new bl,this._previouslyVisible=new xl(n.previouslyVisibleCacheSize),this._pinMap=new $l,this._newVisible=new bl,this._noLongerVisible=[],this._visibleAgain=[],this._evicted=[]}Cl(Hl,Error),Dl.prototype.asset=function(){return this._asset},Dl.prototype.texture=function(){return this._texture},Dl.prototype.destroy=function(){var t=this._id,e=this._store,n=this._tile,i=this._asset,r=this._texture,o=this._cancel;o?o(new Hl(\"Texture load cancelled\")):(i&&(i.removeEventListener(\"change\",this._changeHandler),i.destroy()),r&&r.destroy(),e.emit(\"textureUnload\",n),kl&&console.log(\"unload\",t,n),Sl(this))},Ml(Dl),Ml(Fl),Fl.prototype.destroy=function(){this.clear(),Sl(this)},Fl.prototype.stage=function(){return this._stage},Fl.prototype.source=function(){return this._source},Fl.prototype.clear=function(){var t=this;t._evicted.length=0,t._itemMap.forEach((function(e){t._evicted.push(e)})),t._evicted.forEach((function(e){t._unloadTile(e)})),t._itemMap.clear(),t._visible.clear(),t._previouslyVisible.clear(),t._pinMap.clear(),t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},Fl.prototype.clearNotPinned=function(){var t=this;t._evicted.length=0,t._itemMap.forEach((function(e){t._pinMap.has(e)||t._evicted.push(e)})),t._evicted.forEach((function(e){t._unloadTile(e)})),t._visible.clear(),t._previouslyVisible.clear(),t._evicted.length=0},Fl.prototype.startFrame=function(){if(this._state!==Il&&this._state!==Pl)throw new Error(\"TextureStore: startFrame called out of sequence\");this._state=Pl,this._delimCount++},Fl.prototype.markTile=function(t){if(this._state!==Pl&&this._state!==Al)throw new Error(\"TextureStore: markTile called out of sequence\");this._state=Al;var e=this._itemMap.get(t),n=e&&e.texture(),i=e&&e.asset();n&&i&&n.refresh(t,i),this._newVisible.add(t)},Fl.prototype.endFrame=function(){if(this._state!==Pl&&this._state!==Al&&this._state!==zl)throw new Error(\"TextureStore: endFrame called out of sequence\");this._state=zl,this._delimCount--,this._delimCount||(this._update(),this._state=Il)},Fl.prototype._update=function(){var t=this;t._noLongerVisible.length=0,t._visible.forEach((function(e){t._newVisible.has(e)||t._noLongerVisible.push(e)})),t._visibleAgain.length=0,t._newVisible.forEach((function(e){t._previouslyVisible.has(e)&&t._visibleAgain.push(e)})),t._visibleAgain.forEach((function(e){t._previouslyVisible.remove(e)})),t._evicted.length=0,t._noLongerVisible.forEach((function(e){var n=t._itemMap.get(e);if(n&&n.texture()){var i=t._previouslyVisible.add(e);null!=i&&t._evicted.push(i)}else n&&t._unloadTile(e)})),t._evicted.forEach((function(e){t._pinMap.has(e)||t._unloadTile(e)})),t._newVisible.forEach((function(e){t._itemMap.get(e)||t._loadTile(e)}));var e=t._visible;t._visible=t._newVisible,t._newVisible=e,t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},Fl.prototype._loadTile=function(t){if(this._itemMap.has(t))throw new Error(\"TextureStore: loading texture already in cache\");var e=new Dl(this,t);this._itemMap.set(t,e)},Fl.prototype._unloadTile=function(t){var e=this._itemMap.del(t);if(!e)throw new Error(\"TextureStore: unloading texture not in cache\");e.destroy()},Fl.prototype.asset=function(t){var e=this._itemMap.get(t);return e?e.asset():null},Fl.prototype.texture=function(t){var e=this._itemMap.get(t);return e?e.texture():null},Fl.prototype.pin=function(t){var e=(this._pinMap.get(t)||0)+1;return this._pinMap.set(t,e),this._itemMap.has(t)||this._loadTile(t),e},Fl.prototype.unpin=function(t){var e=this._pinMap.get(t);if(!e)throw new Error(\"TextureStore: unpin when not pinned\");return--e>0?this._pinMap.set(t,e):(this._pinMap.del(t),this._visible.has(t)||this._previouslyVisible.has(t)||this._unloadTile(t)),e},Fl.prototype.query=function(t){var e=this._itemMap.get(t),n=this._pinMap.get(t)||0;return{visible:this._visible.has(t),previouslyVisible:this._previouslyVisible.has(t),hasAsset:null!=e&&null!=e.asset(),hasTexture:null!=e&&null!=e.texture(),pinned:0!==n,pinCount:n}};var ql=Fl;var jl=function(t,e){for(var n in e)t[n]=e[n];return t},Vl=jl,Nl=Kt;function Bl(t,e,n,i,r){r=r||{};var o=this;this._source=t,this._geometry=e,this._view=n,this._textureStore=i,this._effects=r.effects||{},this._fixedLevelIndex=null,this._viewChangeHandler=function(){o.emit(\"viewChange\",o.view())},this._view.addEventListener(\"change\",this._viewChangeHandler),this._textureStoreChangeHandler=function(){o.emit(\"textureStoreChange\",o.textureStore())},this._textureStore.addEventListener(\"textureLoad\",this._textureStoreChangeHandler),this._textureStore.addEventListener(\"textureError\",this._textureStoreChangeHandler),this._textureStore.addEventListener(\"textureInvalid\",this._textureStoreChangeHandler)}Ft(Bl),Bl.prototype.destroy=function(){this._view.removeEventListener(\"change\",this._viewChangeHandler),this._textureStore.removeEventListener(\"textureLoad\",this._textureStoreChangeHandler),this._textureStore.removeEventListener(\"textureError\",this._textureStoreChangeHandler),this._textureStore.removeEventListener(\"textureInvalid\",this._textureStoreChangeHandler),Nl(this)},Bl.prototype.source=function(){return this._source},Bl.prototype.geometry=function(){return this._geometry},Bl.prototype.view=function(){return this._view},Bl.prototype.textureStore=function(){return this._textureStore},Bl.prototype.effects=function(){return this._effects},Bl.prototype.setEffects=function(t){this._effects=t,this.emit(\"effectsChange\",this._effects)},Bl.prototype.mergeEffects=function(t){Vl(this._effects,t),this.emit(\"effectsChange\",this._effects)},Bl.prototype.fixedLevel=function(){return this._fixedLevelIndex},Bl.prototype.setFixedLevel=function(t){if(t!==this._fixedLevelIndex){if(null!=t&&(t>=this._geometry.levelList.length||t<0))throw new Error(\"Level index out of range: \"+t);this._fixedLevelIndex=t,this.emit(\"fixedLevelChange\",this._fixedLevelIndex)}},Bl.prototype._selectLevel=function(){return null!=this._fixedLevelIndex?this._geometry.levelList[this._fixedLevelIndex]:this._view.selectLevel(this._geometry.selectableLevelList)},Bl.prototype.visibleTiles=function(t){var e=this._selectLevel();return this._geometry.visibleTiles(this._view,e,t)},Bl.prototype.pinLevel=function(t){for(var e=this._geometry.levelList[t],n=this._geometry.levelTiles(e),i=0;i<n.length;i++)this._textureStore.pin(n[i])},Bl.prototype.unpinLevel=function(t){for(var e=this._geometry.levelList[t],n=this._geometry.levelTiles(e),i=0;i<n.length;i++)this._textureStore.unpin(n[i])},Bl.prototype.pinFirstLevel=function(){return this.pinLevel(0)},Bl.prototype.unpinFirstLevel=function(){return this.unpinLevel(0)};var Xl=Bl,Wl=Kt;function Yl(t){var e=this;this._stage=t,this._running=!1,this._rendering=!1,this._requestHandle=null,this._boundLoop=this._loop.bind(this),this._renderInvalidHandler=function(){e._rendering||e.renderOnNextFrame()},this._stage.addEventListener(\"renderInvalid\",this._renderInvalidHandler)}Ft(Yl),Yl.prototype.destroy=function(){this.stop(),this._stage.removeEventListener(\"renderInvalid\",this._renderInvalidHandler),Wl(this)},Yl.prototype.stage=function(){return this._stage},Yl.prototype.start=function(){this._running=!0,this.renderOnNextFrame()},Yl.prototype.stop=function(){this._requestHandle&&(window.cancelAnimationFrame(this._requestHandle),this._requestHandle=null),this._running=!1},Yl.prototype.renderOnNextFrame=function(){this._running&&!this._requestHandle&&(this._requestHandle=window.requestAnimationFrame(this._boundLoop))},Yl.prototype._loop=function(){if(!this._running)throw new Error(\"Render loop running while in stopped state\");this._requestHandle=null,this._rendering=!0,this.emit(\"beforeRender\"),this._rendering=!1,this._stage.render(),this.emit(\"afterRender\")};var Ul=Yl;function Gl(){this.velocity=null,this.friction=null,this.offset=null}Gl.equals=function(t,e){return t.velocity===e.velocity&&t.friction===e.friction&&t.offset===e.offset},Gl.prototype.equals=function(t){return Gl.equals(this,t)},Gl.prototype.update=function(t,e){t.offset&&(this.offset=this.offset||0,this.offset+=t.offset);var n=this.offsetFromVelocity(e);n&&(this.offset=this.offset||0,this.offset+=n),this.velocity=t.velocity,this.friction=t.friction},Gl.prototype.reset=function(){this.velocity=null,this.friction=null,this.offset=null},Gl.prototype.velocityAfter=function(t){return this.velocity?this.friction?function(t,e){if(t<0)return Math.min(0,t+e);if(t>0)return Math.max(0,t-e);return 0}(this.velocity,this.friction*t):this.velocity:null},Gl.prototype.offsetFromVelocity=function(t){t=Math.min(t,this.nullVelocityTime());var e=this.velocityAfter(t);return(this.velocity+e)/2*t},Gl.prototype.nullVelocityTime=function(){return null==this.velocity?0:this.velocity&&!this.friction?1/0:Math.abs(this.velocity/this.friction)};var Kl=Gl,Zl=Kl,Ql=Kt;function Jl(t,e,n,i,r){if(!t)throw new Error(\"KeyControlMethod: keyCode must be defined\");if(!e)throw new Error(\"KeyControlMethod: parameter must be defined\");if(!n)throw new Error(\"KeyControlMethod: velocity must be defined\");if(!i)throw new Error(\"KeyControlMethod: friction must be defined\");r=r||document,this._keyCode=t,this._parameter=e,this._velocity=n,this._friction=i,this._element=r,this._keydownHandler=this._handlePress.bind(this),this._keyupHandler=this._handleRelease.bind(this),this._blurHandler=this._handleBlur.bind(this),this._element.addEventListener(\"keydown\",this._keydownHandler),this._element.addEventListener(\"keyup\",this._keyupHandler),window.addEventListener(\"blur\",this._blurHandler),this._dynamics=new Zl,this._pressing=!1}Ft(Jl),Jl.prototype.destroy=function(){this._element.removeEventListener(\"keydown\",this._keydownHandler),this._element.removeEventListener(\"keyup\",this._keyupHandler),window.removeEventListener(\"blur\",this._blurHandler),Ql(this)},Jl.prototype._handlePress=function(t){t.keyCode===this._keyCode&&(this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit(\"parameterDynamics\",this._parameter,this._dynamics),this.emit(\"active\"))},Jl.prototype._handleRelease=function(t){t.keyCode===this._keyCode&&(this._pressing&&(this._dynamics.friction=this._friction,this.emit(\"parameterDynamics\",this._parameter,this._dynamics),this.emit(\"inactive\")),this._pressing=!1)},Jl.prototype._handleBlur=function(){this._dynamics.velocity=0,this.emit(\"parameterDynamics\",this._parameter,this._dynamics),this.emit(\"inactive\"),this._pressing=!1};var tc=Jl,ec={exports:{}};\n/*! Hammer.JS - v2.0.4 - 2014-09-28\n     * http://hammerjs.github.io/\n     *\n     * Copyright (c) 2014 Jorik Tangelder;\n     * Licensed under the MIT license */\n!function(t){!function(e,n,i,r){var o=[\"\",\"webkit\",\"moz\",\"MS\",\"ms\",\"o\"],s=n.createElement(\"div\"),a=\"function\",l=Math.round,c=Math.abs,u=Date.now;function h(t,e,n){return setTimeout(_(t,n),e)}function f(t,e,n){return!!Array.isArray(t)&&(p(t,n[e],n),!0)}function p(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==r)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function d(t,e,n){for(var i=Object.keys(e),o=0;o<i.length;)(!n||n&&t[i[o]]===r)&&(t[i[o]]=e[i[o]]),o++;return t}function m(t,e){return d(t,e,!0)}function v(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&d(i,n)}function _(t,e){return function(){return t.apply(e,arguments)}}function y(t,e){return typeof t==a?t.apply(e&&e[0]||r,e):t}function g(t,e){return t===r?e:t}function w(t,e,n){p(M(e),(function(e){t.addEventListener(e,n,!1)}))}function $(t,e,n){p(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function b(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function x(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\\s+/g)}function E(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function T(t){return Array.prototype.slice.call(t,0)}function L(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];E(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function C(t,e){for(var n,i,s=e[0].toUpperCase()+e.slice(1),a=0;a<o.length;){if((i=(n=o[a])?n+s:e)in t)return i;a++}return r}var S=1;function k(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}var I=\"ontouchstart\"in e,P=C(e,\"PointerEvent\")!==r,A=I&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z=\"touch\",O=\"mouse\",R=24,H=[\"x\",\"y\"],D=[\"clientX\",\"clientY\"];function F(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){y(t.options.enable,[t])&&n.handler(e)},this.init()}function q(t,e,n){var i=n.pointers.length,o=n.changedPointers.length,s=1&e&&i-o==0,a=12&e&&i-o==0;n.isFirst=!!s,n.isFinal=!!a,s&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,o=i.length;n.firstInput||(n.firstInput=j(e));o>1&&!n.firstMultiple?n.firstMultiple=j(e):1===o&&(n.firstMultiple=!1);var s=n.firstInput,a=n.firstMultiple,l=a?a.center:s.center,h=e.center=V(i);e.timeStamp=u(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=X(l,h),e.distance=B(l,h),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=N(e.deltaX,e.deltaY),e.scale=a?(f=a.pointers,p=i,B(p[0],p[1],D)/B(f[0],f[1],D)):1,e.rotation=a?function(t,e){return X(e[1],e[0],D)-X(t[1],t[0],D)}(a.pointers,i):0,function(t,e){var n,i,o,s,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(l>25||a.velocity===r)){var u=a.deltaX-e.deltaX,h=a.deltaY-e.deltaY,f=function(t,e,n){return{x:e/t||0,y:n/t||0}}(l,u,h);i=f.x,o=f.y,n=c(f.x)>c(f.y)?f.x:f.y,s=N(u,h),t.lastInterval=e}else n=a.velocity,i=a.velocityX,o=a.velocityY,s=a.direction;e.velocity=n,e.velocityX=i,e.velocityY=o,e.direction=s}(n,e);var f,p;var d=t.element;b(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,n),t.emit(\"hammer.input\",n),t.recognize(n),t.session.prevInput=n}function j(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:l(t.pointers[n].clientX),clientY:l(t.pointers[n].clientY)},n++;return{timeStamp:u(),pointers:e,center:V(e),deltaX:t.deltaX,deltaY:t.deltaY}}function V(t){var e=t.length;if(1===e)return{x:l(t[0].clientX),y:l(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:l(n/e),y:l(i/e)}}function N(t,e){return t===e?1:c(t)>=c(e)?t>0?2:4:e>0?8:16}function B(t,e,n){n||(n=H);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function X(t,e,n){n||(n=H);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}F.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$(this.element,this.evEl,this.domHandler),this.evTarget&&$(this.target,this.evTarget,this.domHandler),this.evWin&&$(k(this.element),this.evWin,this.domHandler)}};var W={mousedown:1,mousemove:2,mouseup:4},Y=\"mousedown\",U=\"mousemove mouseup\";function G(){this.evEl=Y,this.evWin=U,this.allow=!0,this.pressed=!1,F.apply(this,arguments)}v(G,F,{handler:function(t){var e=W[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&this.allow&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:O,srcEvent:t}))}});var K={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Z={2:z,3:\"pen\",4:O,5:\"kinect\"},Q=\"pointerdown\",J=\"pointermove pointerup pointercancel\";function tt(){this.evEl=Q,this.evWin=J,F.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&(Q=\"MSPointerDown\",J=\"MSPointerMove MSPointerUp MSPointerCancel\"),v(tt,F,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace(\"ms\",\"\"),r=K[i],o=Z[t.pointerType]||t.pointerType,s=o==z,a=E(e,t.pointerId,\"pointerId\");1&r&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&r&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8},nt=\"touchstart\",it=\"touchstart touchmove touchend touchcancel\";function rt(){this.evTarget=nt,this.evWin=it,this.started=!1,F.apply(this,arguments)}function ot(t,e){var n=T(t.touches),i=T(t.changedTouches);return 12&e&&(n=L(n.concat(i),\"identifier\",!0)),[n,i]}v(rt,F,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=ot.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:z,srcEvent:t})}}});var st={touchstart:1,touchmove:2,touchend:4,touchcancel:8},at=\"touchstart touchmove touchend touchcancel\";function lt(){this.evTarget=at,this.targetIds={},F.apply(this,arguments)}function ct(t,e){var n=T(t.touches),i=this.targetIds;if(3&e&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=T(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return b(t.target,l)})),1===e)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),12&e&&delete i[s[r].identifier],r++;return a.length?[L(o.concat(a),\"identifier\",!0),a]:void 0}function ut(){F.apply(this,arguments);var t=_(this.handler,this);this.touch=new lt(this.manager,t),this.mouse=new G(this.manager,t)}v(lt,F,{handler:function(t){var e=st[t.type],n=ct.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:z,srcEvent:t})}}),v(ut,F,{handler:function(t,e,n){var i=n.pointerType==z,r=n.pointerType==O;if(i)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;12&e&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ht=C(s.style,\"touchAction\"),ft=ht!==r,pt=\"compute\",dt=\"auto\",mt=\"manipulation\",vt=\"none\",_t=\"pan-x\",yt=\"pan-y\";function gt(t,e){this.manager=t,this.set(e)}gt.prototype={set:function(t){t==pt&&(t=this.compute()),ft&&(this.manager.element.style[ht]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return p(this.manager.recognizers,(function(e){y(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(x(t,vt))return vt;var e=x(t,_t),n=x(t,yt);if(e&&n)return\"pan-x pan-y\";if(e||n)return e?_t:yt;if(x(t,mt))return mt;return dt}(t.join(\" \"))},preventDefaults:function(t){if(!ft){var e=t.srcEvent,n=t.offsetDirection;if(!this.manager.session.prevented){var i=this.actions,r=x(i,vt),o=x(i,yt),s=x(i,_t);return r||o&&6&n||s&&n&R?this.preventSrc(e):void 0}e.preventDefault()}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var wt=16,$t=32;function bt(t){this.id=S++,this.manager=null,this.options=m(t||{},this.defaults),this.options.enable=g(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function xt(t){return 16==t?\"down\":8==t?\"up\":2==t?\"left\":4==t?\"right\":\"\"}function Mt(t,e){var n=e.manager;return n?n.get(t):t}function Et(){bt.apply(this,arguments)}function Tt(){Et.apply(this,arguments),this.pX=null,this.pY=null}function Lt(){Et.apply(this,arguments)}function Ct(){bt.apply(this,arguments),this._timer=null,this._input=null}function St(){Et.apply(this,arguments)}function kt(){Et.apply(this,arguments)}function It(){bt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Pt(t,e){return(e=e||{}).recognizers=g(e.recognizers,Pt.defaults.preset),new At(t,e)}bt.prototype={defaults:{},set:function(t){return d(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(f(t,\"recognizeWith\",this))return this;var e=this.simultaneous;return e[(t=Mt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return f(t,\"dropRecognizeWith\",this)||(t=Mt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(f(t,\"requireFailure\",this))return this;var e=this.requireFail;return-1===E(e,t=Mt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(f(t,\"dropRequireFailure\",this))return this;t=Mt(t,this);var e=E(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(i){e.manager.emit(e.options.event+(i?function(t){if(t&wt)return\"cancel\";if(8&t)return\"end\";if(4&t)return\"move\";if(2&t)return\"start\";return\"\"}(n):\"\"),t)}n<8&&i(!0),i(),n>=8&&i(!0)},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=$t},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=d({},t);if(!y(this.options.enable,[this,e]))return this.reset(),void(this.state=$t);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},v(Et,bt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,r=this.attrTest(t);return i&&(8&n||!r)?e|wt:i||r?4&n?8|e:2&e?4|e:2:$t}}),v(Tt,Et,{defaults:{event:\"pan\",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(yt),t&R&&e.push(_t),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(6&e.direction?(r=0===o?1:o<0?2:4,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?1:s<0?8:16,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return Et.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=xt(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),v(Lt,Et,{defaults:{event:\"pinch\",threshold:0,pointers:2},getTouchAction:function(){return[vt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?\"in\":\"out\";this.manager.emit(this.options.event+e,t)}}}),v(Ct,bt,{defaults:{event:\"press\",pointers:1,time:500,threshold:5},getTouchAction:function(){return[dt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=h((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return $t},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+\"up\",t):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}}),v(St,Et,{defaults:{event:\"rotate\",threshold:0,pointers:2},getTouchAction:function(){return[vt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),v(kt,Et,{defaults:{event:\"swipe\",threshold:10,velocity:.65,direction:30,pointers:1},getTouchAction:function(){return Tt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.velocity:6&n?e=t.velocityX:n&R&&(e=t.velocityY),this._super.attrTest.call(this,t)&&n&t.direction&&t.distance>this.options.threshold&&c(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=xt(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),v(It,bt,{defaults:{event:\"tap\",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[mt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||B(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=h((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return $t},failTimeout:function(){return this._timer=h((function(){this.state=$t}),this.options.interval,this),$t},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Pt.VERSION=\"2.0.4\",Pt.defaults={domEvents:!1,touchAction:pt,enable:!0,inputTarget:null,inputClass:null,preset:[[St,{enable:!1}],[Lt,{enable:!1},[\"rotate\"]],[kt,{direction:6}],[Tt,{direction:6},[\"swipe\"]],[It],[It,{event:\"doubletap\",taps:2},[\"tap\"]],[Ct]],cssProps:{userSelect:\"none\",touchSelect:\"none\",touchCallout:\"none\",contentZooming:\"none\",userDrag:\"none\",tapHighlightColor:\"rgba(0,0,0,0)\"}};function At(t,e){var n;e=e||{},this.options=m(e,Pt.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=new((n=this).options.inputClass||(P?tt:A?lt:I?ut:G))(n,q),this.touchAction=new gt(this,this.options.touchAction),zt(this,!0),p(e.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function zt(t,e){var n=t.element;p(t.options.cssProps,(function(t,i){n.style[C(n.style,i)]=e?t:\"\"}))}At.prototype={set:function(t){return d(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&8&r.state)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&14&n.state&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof bt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(f(t,\"add\",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(f(t,\"remove\",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(E(e,t),1),this.touchAction.update(),this},on:function(t,e){var n=this.handlers;return p(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this},off:function(t,e){var n=this.handlers;return p(M(t),(function(t){e?n[t].splice(E(n[t],e),1):delete n[t]})),this},emit:function(t,e){this.options.domEvents&&function(t,e){var i=n.createEvent(\"Event\");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<i.length;)i[r](e),r++}},destroy:function(){this.element&&zt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},d(Pt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:wt,STATE_FAILED:$t,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:R,DIRECTION_ALL:30,Manager:At,Input:F,TouchAction:gt,TouchInput:lt,MouseInput:G,PointerEventInput:tt,TouchMouseInput:ut,SingleTouchInput:rt,Recognizer:bt,AttrRecognizer:Et,Tap:It,Pan:Tt,Swipe:kt,Pinch:Lt,Rotate:St,Press:Ct,on:w,off:$,each:p,merge:m,extend:d,inherit:v,bindFn:_,prefixed:C}),t.exports?t.exports=Pt:e.Hammer=Pt}(window,document)}(ec);var nc=ec.exports,ic=1,rc=\"MarzipanoHammerElementId\";function oc(t,e){return t[rc]||(t[rc]=ic++),e+t[rc]}function sc(){this._managers={},this._refCount={}}function ac(t,e,n,i){this._manager=e,this._element=n,this._type=i,this._hammerGestures=t,this._eventHandlers=[]}sc.prototype.get=function(t,e){var n=oc(t,e);return this._managers[n]||(this._managers[n]=this._createManager(t,e),this._refCount[n]=0),this._refCount[n]++,new ac(this,this._managers[n],t,e)},sc.prototype._createManager=function(t,e){var n=new nc.Manager(t);return\"mouse\"===e?n.add(new nc.Pan({direction:nc.DIRECTION_ALL,threshold:0})):\"touch\"!==e&&\"pen\"!==e&&\"kinect\"!==e||(n.add(new nc.Pan({direction:nc.DIRECTION_ALL,threshold:20,pointers:1})),n.add(new nc.Pinch)),n},sc.prototype._releaseHandle=function(t,e){var n=oc(t,e);this._refCount[n]&&(this._refCount[n]--,this._refCount[n]||(this._managers[n].destroy(),delete this._managers[n],delete this._refCount[n]))},ac.prototype.on=function(t,e){var n=this._type,i=function(t){n===t.pointerType&&e(t)};this._eventHandlers.push({events:t,handler:i}),this._manager.on(t,i)},ac.prototype.release=function(){for(var t=0;t<this._eventHandlers.length;t++){var e=this._eventHandlers[t];this._manager.off(e.events,e.handler)}this._hammerGestures._releaseHandle(this._element,this._type),this._manager=null,this._element=null,this._type=null,this._hammerGestures=null},ac.prototype.manager=function(){return this._manager};var lc=new sc;function cc(t,e,n,i){var r=Math.atan(e/t);i[0]=n*Math.cos(r),i[1]=n*Math.sin(r)}var uc=function(t,e,n,i,r){var o=Math.sqrt(Math.pow(e,2)+Math.pow(n,2));cc(e,n,t=Math.max(t,o/i),r),r[0]=Math.abs(r[0]),r[1]=Math.abs(r[1])},hc=Ft,fc=Kl,pc=lc,dc=yl,mc=uc,vc=Kt,_c={friction:6,maxFrictionTime:.3,hammerEvent:\"pan\"},yc=\"undefined\"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function gc(t,e,n){if(this._element=t,this._opts=dc(n||{},_c),this._startEvent=null,this._lastEvent=null,this._active=!1,this._dynamics={x:new fc,y:new fc},this._hammer=pc.get(t,e),this._hammer.on(\"hammer.input\",this._handleHammerEvent.bind(this)),\"pan\"!=this._opts.hammerEvent&&\"pinch\"!=this._opts.hammerEvent)throw new Error(this._opts.hammerEvent+\" is not a hammerEvent managed in DragControlMethod\");this._hammer.on(this._opts.hammerEvent+\"start\",this._handleStart.bind(this)),this._hammer.on(this._opts.hammerEvent+\"move\",this._handleMove.bind(this)),this._hammer.on(this._opts.hammerEvent+\"end\",this._handleEnd.bind(this)),this._hammer.on(this._opts.hammerEvent+\"cancel\",this._handleEnd.bind(this))}hc(gc),gc.prototype.destroy=function(){this._hammer.release(),vc(this)},gc.prototype._handleHammerEvent=function(t){if(t.isFirst){if(yc&&this._active)throw new Error(\"DragControlMethod active detected when already active\");this._active=!0,this.emit(\"active\")}if(t.isFinal){if(yc&&!this._active)throw new Error(\"DragControlMethod inactive detected when already inactive\");this._active=!1,this.emit(\"inactive\")}},gc.prototype._handleStart=function(t){t.preventDefault(),this._startEvent=t},gc.prototype._handleMove=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsMove(t),this.emit(\"parameterDynamics\",\"axisScaledX\",this._dynamics.x),this.emit(\"parameterDynamics\",\"axisScaledY\",this._dynamics.y))},gc.prototype._handleEnd=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsRelease(t),this.emit(\"parameterDynamics\",\"axisScaledX\",this._dynamics.x),this.emit(\"parameterDynamics\",\"axisScaledY\",this._dynamics.y)),this._startEvent=!1,this._lastEvent=!1},gc.prototype._updateDynamicsMove=function(t){var e=t.deltaX,n=t.deltaY,i=this._lastEvent||this._startEvent;i&&(e-=i.deltaX,n-=i.deltaY);var r=this._element.getBoundingClientRect();e/=r.right-r.left,n/=r.bottom-r.top,this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.offset=-e,this._dynamics.y.offset=-n,this._lastEvent=t};var wc=[null,null];gc.prototype._updateDynamicsRelease=function(t){var e=this._element.getBoundingClientRect(),n=e.right-e.left,i=e.bottom-e.top,r=1e3*t.velocityX/n,o=1e3*t.velocityY/i;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=r,this._dynamics.y.velocity=o,mc(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,wc),this._dynamics.x.friction=wc[0],this._dynamics.y.friction=wc[1]};var $c=gc,bc=Kl,xc=lc,Mc=yl,Ec=uc,Tc=Kt,Lc={speed:8,friction:6,maxFrictionTime:.3};function Cc(t,e,n){this._element=t,this._opts=Mc(n||{},Lc),this._active=!1,this._hammer=xc.get(t,e),this._dynamics={x:new bc,y:new bc},this._hammer.on(\"panstart\",this._handleStart.bind(this)),this._hammer.on(\"panmove\",this._handleMove.bind(this)),this._hammer.on(\"panend\",this._handleRelease.bind(this)),this._hammer.on(\"pancancel\",this._handleRelease.bind(this))}Ft(Cc),Cc.prototype.destroy=function(){this._hammer.release(),Tc(this)},Cc.prototype._handleStart=function(t){t.preventDefault(),this._active||(this._active=!0,this.emit(\"active\"))},Cc.prototype._handleMove=function(t){t.preventDefault(),this._updateDynamics(t,!1)},Cc.prototype._handleRelease=function(t){t.preventDefault(),this._updateDynamics(t,!0),this._active&&(this._active=!1,this.emit(\"inactive\"))};var Sc=[null,null];Cc.prototype._updateDynamics=function(t,e){var n=this._element.getBoundingClientRect(),i=n.right-n.left,r=n.bottom-n.top,o=Math.max(i,r),s=t.deltaX/o*this._opts.speed,a=t.deltaY/o*this._opts.speed;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=s,this._dynamics.y.velocity=a,e&&(Ec(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,Sc),this._dynamics.x.friction=Sc[0],this._dynamics.y.friction=Sc[1]),this.emit(\"parameterDynamics\",\"x\",this._dynamics.x),this.emit(\"parameterDynamics\",\"y\",this._dynamics.y)};var kc=Cc,Ic=Kl,Pc=yl,Ac=Kt,zc={frictionTime:.2,zoomDelta:.001};function Oc(t,e){this._element=t,this._opts=Pc(e||{},zc),this._dynamics=new Ic,this._eventList=[];var n=this._opts.frictionTime?this.withSmoothing:this.withoutSmoothing;this._wheelListener=n.bind(this),t.addEventListener(\"wheel\",this._wheelListener)}function Rc(t){var e=1==t.deltaMode?20:1;return t.deltaY*e}Ft(Oc),Oc.prototype.destroy=function(){this._element.removeEventListener(\"wheel\",this._wheelListener),Ac(this)},Oc.prototype.withoutSmoothing=function(t){this._dynamics.offset=Rc(t)*this._opts.zoomDelta,this.emit(\"parameterDynamics\",\"zoom\",this._dynamics),t.preventDefault(),this.emit(\"active\"),this.emit(\"inactive\")},Oc.prototype.withSmoothing=function(t){var e=t.timeStamp;for(this._eventList.push(t);this._eventList[0].timeStamp<e-1e3*this._opts.frictionTime;)this._eventList.shift(0);for(var n=0,i=0;i<this._eventList.length;i++){n+=Rc(this._eventList[i])*this._opts.zoomDelta/this._opts.frictionTime}this._dynamics.velocity=n,this._dynamics.friction=Math.abs(n)/this._opts.frictionTime,this.emit(\"parameterDynamics\",\"zoom\",this._dynamics),t.preventDefault(),this.emit(\"active\"),this.emit(\"inactive\")};var Hc=Oc,Dc=Kl,Fc=lc,qc=Kt;function jc(t,e,n){this._hammer=Fc.get(t,e),this._lastEvent=null,this._active=!1,this._dynamics=new Dc,this._hammer.on(\"pinchstart\",this._handleStart.bind(this)),this._hammer.on(\"pinch\",this._handleEvent.bind(this)),this._hammer.on(\"pinchend\",this._handleEnd.bind(this)),this._hammer.on(\"pinchcancel\",this._handleEnd.bind(this))}Ft(jc),jc.prototype.destroy=function(){this._hammer.release(),qc(this)},jc.prototype._handleStart=function(){this._active||(this._active=!0,this.emit(\"active\"))},jc.prototype._handleEnd=function(){this._lastEvent=null,this._active&&(this._active=!1,this.emit(\"inactive\"))},jc.prototype._handleEvent=function(t){var e=t.scale;this._lastEvent&&(e/=this._lastEvent.scale),this._dynamics.offset=-1*(e-1),this.emit(\"parameterDynamics\",\"zoom\",this._dynamics),this._lastEvent=t};var Vc=jc,Nc=Kl,Bc=Kt;function Xc(t){if(!t)throw new Error(\"VelocityControlMethod: parameter must be defined\");this._parameter=t,this._dynamics=new Nc}Ft(Xc),Xc.prototype.destroy=function(){Bc(this)},Xc.prototype.setVelocity=function(t){this._dynamics.velocity=t,this.emit(\"parameterDynamics\",this._parameter,this._dynamics)},Xc.prototype.setFriction=function(t){this._dynamics.friction=t,this.emit(\"parameterDynamics\",this._parameter,this._dynamics)};var Wc=Xc,Yc=Kl,Uc=Kt;function Gc(t,e,n,i){if(!t)throw new Error(\"ElementPressControlMethod: element must be defined\");if(!e)throw new Error(\"ElementPressControlMethod: parameter must be defined\");if(!n)throw new Error(\"ElementPressControlMethod: velocity must be defined\");if(!i)throw new Error(\"ElementPressControlMethod: friction must be defined\");this._element=t,this._pressHandler=this._handlePress.bind(this),this._releaseHandler=this._handleRelease.bind(this),t.addEventListener(\"mousedown\",this._pressHandler),t.addEventListener(\"mouseup\",this._releaseHandler),t.addEventListener(\"mouseleave\",this._releaseHandler),t.addEventListener(\"touchstart\",this._pressHandler),t.addEventListener(\"touchmove\",this._releaseHandler),t.addEventListener(\"touchend\",this._releaseHandler),this._parameter=e,this._velocity=n,this._friction=i,this._dynamics=new Yc,this._pressing=!1}Ft(Gc),Gc.prototype.destroy=function(){this._element.removeEventListener(\"mousedown\",this._pressHandler),this._element.removeEventListener(\"mouseup\",this._releaseHandler),this._element.removeEventListener(\"mouseleave\",this._releaseHandler),this._element.removeEventListener(\"touchstart\",this._pressHandler),this._element.removeEventListener(\"touchmove\",this._releaseHandler),this._element.removeEventListener(\"touchend\",this._releaseHandler),Uc(this)},Gc.prototype._handlePress=function(){this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit(\"parameterDynamics\",this._parameter,this._dynamics),this.emit(\"active\")},Gc.prototype._handleRelease=function(){this._pressing&&(this._dynamics.friction=this._friction,this.emit(\"parameterDynamics\",this._parameter,this._dynamics),this.emit(\"inactive\")),this._pressing=!1};var Kc=Gc,Zc=Kl,Qc=qt,Jc=Kt;function tu(t){t=t||{},this._methods=[],this._parameters=[\"x\",\"y\",\"axisScaledX\",\"axisScaledY\",\"zoom\",\"yaw\",\"pitch\",\"roll\"],this._now=t.nowForTesting||Qc,this._composedOffsets={},this._composeReturn={offsets:this._composedOffsets,changing:null}}Ft(tu),tu.prototype.add=function(t){if(!this.has(t)){var e={};this._parameters.forEach((function(t){e[t]={dynamics:new Zc,time:null}}));var n=this._updateDynamics.bind(this,e),i={instance:t,dynamics:e,parameterDynamicsHandler:n};t.addEventListener(\"parameterDynamics\",n),this._methods.push(i)}},tu.prototype.remove=function(t){var e=this._indexOfInstance(t);if(e>=0){var n=this._methods.splice(e,1)[0];n.instance.removeEventListener(\"parameterDynamics\",n.parameterDynamicsHandler)}},tu.prototype.has=function(t){return this._indexOfInstance(t)>=0},tu.prototype._indexOfInstance=function(t){for(var e=0;e<this._methods.length;e++)if(this._methods[e].instance===t)return e;return-1},tu.prototype.list=function(){for(var t=[],e=0;e<this._methods.length;e++)t.push(this._methods[e].instance);return t},tu.prototype._updateDynamics=function(t,e,n){var i=t[e];if(!i)throw new Error(\"Unknown control parameter \"+e);var r=this._now();i.dynamics.update(n,(r-i.time)/1e3),i.time=r,this.emit(\"change\")},tu.prototype._resetComposedOffsets=function(){for(var t=0;t<this._parameters.length;t++)this._composedOffsets[this._parameters[t]]=0},tu.prototype.offsets=function(){var t,e=!1,n=this._now();this._resetComposedOffsets();for(var i=0;i<this._methods.length;i++)for(var r=this._methods[i].dynamics,o=0;o<this._parameters.length;o++){var s=r[t=this._parameters[o]],a=s.dynamics;null!=a.offset&&(this._composedOffsets[t]+=a.offset,a.offset=null);var l=(n-s.time)/1e3,c=a.offsetFromVelocity(l);c&&(this._composedOffsets[t]+=c);var u=a.velocityAfter(l);a.velocity=u,u&&(e=!0),s.time=n}return this._composeReturn.changing=e,this._composeReturn},tu.prototype.destroy=function(){for(var t=this.list(),e=0;e<t.length;e++)this.remove(t[e]);Jc(this)};var eu=Ft,nu=tu,iu=Kt,ru=\"undefined\"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function ou(t){t=t||{},this._methods={},this._methodGroups={},this._composer=new nu,this._enabled=!t||!t.enabled||!!t.enabled,this._activeCount=0,this.updatedViews_=[],this._attachedRenderLoop=null}eu(ou),ou.prototype.destroy=function(){this.detach(),this._composer.destroy(),iu(this)},ou.prototype.methods=function(){var t={};for(var e in this._methods)t[e]=this._methods[e];return t},ou.prototype.method=function(t){return this._methods[t]},ou.prototype.registerMethod=function(t,e,n){if(this._methods[t])throw new Error(\"Control method already registered with id \"+t);this._methods[t]={instance:e,enabled:!1,active:!1,activeHandler:this._handleActive.bind(this,t),inactiveHandler:this._handleInactive.bind(this,t)},n&&this.enableMethod(t,e)},ou.prototype.unregisterMethod=function(t){var e=this._methods[t];if(!e)throw new Error(\"No control method registered with id \"+t);e.enabled&&this.disableMethod(t),delete this._methods[t]},ou.prototype.enableMethod=function(t){var e=this._methods[t];if(!e)throw new Error(\"No control method registered with id \"+t);e.enabled||(e.enabled=!0,e.active&&this._incrementActiveCount(),this._listen(t),this._updateComposer(),this.emit(\"methodEnabled\",t))},ou.prototype.disableMethod=function(t){var e=this._methods[t];if(!e)throw new Error(\"No control method registered with id \"+t);e.enabled&&(e.enabled=!1,e.active&&this._decrementActiveCount(),this._unlisten(t),this._updateComposer(),this.emit(\"methodDisabled\",t))},ou.prototype.addMethodGroup=function(t,e){this._methodGroups[t]=e},ou.prototype.removeMethodGroup=function(t){delete this._methodGroups[t]},ou.prototype.methodGroups=function(){var t={};for(var e in this._methodGroups)t[e]=this._methodGroups[e];return t},ou.prototype.enableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach((function(t){e.enableMethod(t)}))},ou.prototype.disableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach((function(t){e.disableMethod(t)}))},ou.prototype.enabled=function(){return this._enabled},ou.prototype.enable=function(){this._enabled||(this._enabled=!0,this._activeCount>0&&this.emit(\"active\"),this.emit(\"enabled\"),this._updateComposer())},ou.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._activeCount>0&&this.emit(\"inactive\"),this.emit(\"disabled\"),this._updateComposer())},ou.prototype.attach=function(t){this._attachedRenderLoop&&this.detach(),this._attachedRenderLoop=t,this._beforeRenderHandler=this._updateViewsWithControls.bind(this),this._changeHandler=t.renderOnNextFrame.bind(t),this._attachedRenderLoop.addEventListener(\"beforeRender\",this._beforeRenderHandler),this._composer.addEventListener(\"change\",this._changeHandler)},ou.prototype.detach=function(){this._attachedRenderLoop&&(this._attachedRenderLoop.removeEventListener(\"beforeRender\",this._beforeRenderHandler),this._composer.removeEventListener(\"change\",this._changeHandler),this._beforeRenderHandler=null,this._changeHandler=null,this._attachedRenderLoop=null)},ou.prototype.attached=function(){return null!=this._attachedRenderLoop},ou.prototype._listen=function(t){var e=this._methods[t];if(!e)throw new Error(\"Bad method id\");e.instance.addEventListener(\"active\",e.activeHandler),e.instance.addEventListener(\"inactive\",e.inactiveHandler)},ou.prototype._unlisten=function(t){var e=this._methods[t];if(!e)throw new Error(\"Bad method id\");e.instance.removeEventListener(\"active\",e.activeHandler),e.instance.removeEventListener(\"inactive\",e.inactiveHandler)},ou.prototype._handleActive=function(t){var e=this._methods[t];if(!e)throw new Error(\"Bad method id\");if(!e.enabled)throw new Error(\"Should not receive event from disabled control method\");e.active||(e.active=!0,this._incrementActiveCount())},ou.prototype._handleInactive=function(t){var e=this._methods[t];if(!e)throw new Error(\"Bad method id\");if(!e.enabled)throw new Error(\"Should not receive event from disabled control method\");e.active&&(e.active=!1,this._decrementActiveCount())},ou.prototype._incrementActiveCount=function(){this._activeCount++,ru&&this._checkActiveCount(),this._enabled&&1===this._activeCount&&this.emit(\"active\")},ou.prototype._decrementActiveCount=function(){this._activeCount--,ru&&this._checkActiveCount(),this._enabled&&0===this._activeCount&&this.emit(\"inactive\")},ou.prototype._checkActiveCount=function(){var t=0;for(var e in this._methods){var n=this._methods[e];n.enabled&&n.active&&t++}if(t!=this._activeCount)throw new Error(\"Bad control state\")},ou.prototype._updateComposer=function(){var t=this._composer;for(var e in this._methods){var n=this._methods[e],i=this._enabled&&n.enabled;i&&!t.has(n.instance)&&t.add(n.instance),!i&&t.has(n.instance)&&t.remove(n.instance)}},ou.prototype._updateViewsWithControls=function(){var t=this._composer.offsets();t.changing&&this._attachedRenderLoop.renderOnNextFrame(),this.updatedViews_.length=0;for(var e=this._attachedRenderLoop.stage().listLayers(),n=0;n<e.length;n++){var i=e[n].view();this.updatedViews_.indexOf(i)<0&&(e[n].view().updateWithControlParameters(t.offsets),this.updatedViews_.push(i))}};var su=ou,au=Re.setTransform,lu=_a;var cu=function(t,e,n,i){i=i||\"\";var r=\"translateX(\"+lu(e)+\"px) translateY(\"+lu(n)+\"px) translateZ(0) \"+i;au(t,r)},uu=Ft,hu=cu,fu=Re.setTransform,pu=Kt;function du(t,e,n,i,r){(r=r||{}).perspective=r.perspective||{},r.perspective.extraTransforms=null!=r.perspective.extraTransforms?r.perspective.extraTransforms:\"\",this._domElement=t,this._parentDomElement=e,this._view=n,this._coords={},this._perspective={},this.setPosition(i),this._parentDomElement.appendChild(this._domElement),this.setPerspective(r.perspective),this._visible=!0,this._position={x:0,y:0}}uu(du),du.prototype.destroy=function(){this._parentDomElement.removeChild(this._domElement),pu(this)},du.prototype.domElement=function(){return this._domElement},du.prototype.position=function(){return this._coords},du.prototype.setPosition=function(t){for(var e in t)this._coords[e]=t[e];this._update()},du.prototype.perspective=function(){return this._perspective},du.prototype.setPerspective=function(t){for(var e in t)this._perspective[e]=t[e];this._update()},du.prototype.show=function(){this._visible||(this._visible=!0,this._update())},du.prototype.hide=function(){this._visible&&(this._visible=!1,this._update())},du.prototype._update=function(){var t,e,n=this._domElement,i=this._coords,r=this._position,o=!1;if(this._visible){var s=this._view;this._perspective.radius?(o=!0,this._setEmbeddedPosition(s,i)):(s.coordinatesToScreen(i,r),t=r.x,e=r.y,null!=t&&null!=e&&(o=!0,this._setPosition(t,e)))}o?(n.style.display=\"block\",n.style.position=\"absolute\"):(n.style.display=\"none\",n.style.position=\"\")},du.prototype._setEmbeddedPosition=function(t,e){var n=t.coordinatesToPerspectiveTransform(e,this._perspective.radius,this._perspective.extraTransforms);fu(this._domElement,n)},du.prototype._setPosition=function(t,e){hu(this._domElement,t,e,this._perspective.extraTransforms)};var mu=du,vu=Ft,_u=mu,yu=Xt,gu=cu,wu=Re.setAbsolute,$u=Re.setOverflowHidden,bu=Re.setOverflowVisible,xu=Re.setNullSize,Mu=Re.setPixelSize,Eu=Re.setWithVendorPrefix(\"pointer-events\"),Tu=Kt;function Lu(t,e,n,i,r){r=r||{},this._parentDomElement=t,this._stage=e,this._view=n,this._renderLoop=i,this._hotspots=[],this._visible=!0,this._rect=r.rect,this._visibilityOrRectChanged=!0,this._stageWidth=null,this._stageHeight=null,this._tmpRect={},this._hotspotContainerWrapper=document.createElement(\"div\"),wu(this._hotspotContainerWrapper),Eu(this._hotspotContainerWrapper,\"none\"),this._parentDomElement.appendChild(this._hotspotContainerWrapper),this._hotspotContainer=document.createElement(\"div\"),wu(this._hotspotContainer),Eu(this._hotspotContainer,\"all\"),this._hotspotContainerWrapper.appendChild(this._hotspotContainer),this._updateHandler=this._update.bind(this),this._renderLoop.addEventListener(\"afterRender\",this._updateHandler)}vu(Lu),Lu.prototype.destroy=function(){for(;this._hotspots.length;)this.destroyHotspot(this._hotspots[0]);this._parentDomElement.removeChild(this._hotspotContainerWrapper),this._renderLoop.removeEventListener(\"afterRender\",this._updateHandler),Tu(this)},Lu.prototype.domElement=function(){return this._hotspotContainer},Lu.prototype.setRect=function(t){this._rect=t,this._visibilityOrRectChanged=!0},Lu.prototype.rect=function(){return this._rect},Lu.prototype.createHotspot=function(t,e,n){e=e||{};var i=new _u(t,this._hotspotContainer,this._view,e,n);return this._hotspots.push(i),i._update(),this.emit(\"hotspotsChange\"),i},Lu.prototype.hasHotspot=function(t){return this._hotspots.indexOf(t)>=0},Lu.prototype.listHotspots=function(){return[].concat(this._hotspots)},Lu.prototype.destroyHotspot=function(t){var e=this._hotspots.indexOf(t);if(e<0)throw new Error(\"No such hotspot\");this._hotspots.splice(e,1),t.destroy(),this.emit(\"hotspotsChange\")},Lu.prototype.hide=function(){this._visible&&(this._visible=!1,this._visibilityOrRectChanged=!0,this._update())},Lu.prototype.show=function(){this._visible||(this._visible=!0,this._visibilityOrRectChanged=!0,this._update())},Lu.prototype._update=function(){var t=this._hotspotContainerWrapper,e=this._stage.width(),n=this._stage.height(),i=this._tmpRect;if(this._visibilityOrRectChanged||this._rect&&(e!==this._stageWidth||n!==this._stageHeight)){var r=this._visible;t.style.display=r?\"block\":\"none\",r&&(this._rect?(yu(e,n,this._rect,i),gu(t,e*i.x,n*i.y),Mu(t,e*i.width,n*i.height),$u(t)):(gu(t,0,0),xu(t),bu(t))),this._stageWidth=e,this._stageHeight=n,this._visibilityOrRectChanged=!1}for(var o=0;o<this._hotspots.length;o++)this._hotspots[o]._update()};var Cu=Lu,Su=Xl,ku=ql,Iu=Cu,Pu=qt,Au=Ua,zu=fs,Ou=yl,Ru=Kt;function Hu(t,e){this._viewer=t,this._view=e,this._layers=[],this._hotspotContainer=new Iu(t._controlContainer,t.stage(),this._view,t.renderLoop()),this._movement=null,this._movementStartTime=null,this._movementStep=null,this._movementParams=null,this._movementCallback=null,this._updateMovementHandler=this._updateMovement.bind(this),this._updateHotspotContainerHandler=this._updateHotspotContainer.bind(this),this._viewer.addEventListener(\"sceneChange\",this._updateHotspotContainerHandler),this._viewChangeHandler=this.emit.bind(this,\"viewChange\"),this._view.addEventListener(\"change\",this._viewChangeHandler),this._updateHotspotContainer()}Ft(Hu),Hu.prototype.destroy=function(){this._view.removeEventListener(\"change\",this._viewChangeHandler),this._viewer.removeEventListener(\"sceneChange\",this._updateHotspotContainerHandler),this._movement&&this.stopMovement(),this._hotspotContainer.destroy(),this.destroyAllLayers(),Ru(this)},Hu.prototype.hotspotContainer=function(){return this._hotspotContainer},Hu.prototype.layer=function(){return this._layers[0]},Hu.prototype.listLayers=function(){return[].concat(this._layers)},Hu.prototype.view=function(){return this._view},Hu.prototype.viewer=function(){return this._viewer},Hu.prototype.visible=function(){return this._viewer.scene()===this},Hu.prototype.createLayer=function(t){var e=(t=t||{}).textureStoreOpts||{},n=t.layerOpts||{},i=t.source,r=t.geometry,o=this._view,s=this._viewer.stage(),a=new ku(i,s,e),l=new Su(i,r,o,a,n);return this._layers.push(l),t.pinFirstLevel&&l.pinFirstLevel(),this.emit(\"layerChange\"),l},Hu.prototype.destroyLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw new Error(\"No such layer in scene\");this._layers.splice(e,1),this.emit(\"layerChange\"),t.textureStore().destroy(),t.destroy()},Hu.prototype.destroyAllLayers=function(){for(;this._layers.length>0;)this.destroyLayer(this._layers[0])},Hu.prototype.switchTo=function(t,e){return this._viewer.switchScene(this,t,e)},Hu.prototype.lookTo=function(t,e,n){var i=this;if(e=e||{},n=n||Au,\"object\"!==zu(t))throw new Error(\"Target view parameters must be an object\");var r=null!=e.ease?e.ease:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},o=null!=e.controlsInterrupt&&e.controlsInterrupt,s=null!=e.transitionDuration?e.transitionDuration:1e3,a=null==e.shortest||e.shortest,l=this._view,c=l.parameters(),u={};Ou(u,t),Ou(u,c),a&&l.normalizeToClosest&&l.normalizeToClosest(u,u);var h=this._viewer.controls().enabled();o||this._viewer.controls().disable(),this.startMovement((function(){var t=!1;return function(e,n){if(n>=s&&t)return null;var i=Math.min(n/s,1);for(var o in e){var a=c[o],l=u[o];e[o]=a+r(i)*(l-a)}return t=n>=s,e}}),(function(){h&&i._viewer.controls().enable(),n()}))},Hu.prototype.startMovement=function(t,e){var n=this._viewer.renderLoop();this._movement&&this.stopMovement();var i=t();if(\"function\"!=typeof i)throw new Error(\"Bad movement\");this._movement=t,this._movementStep=i,this._movementStartTime=Pu(),this._movementParams={},this._movementCallback=e,n.addEventListener(\"beforeRender\",this._updateMovementHandler),n.renderOnNextFrame()},Hu.prototype.stopMovement=function(){var t=this._movementCallback,e=this._viewer.renderLoop();this._movement&&(this._movement=null,this._movementStep=null,this._movementStartTime=null,this._movementParams=null,this._movementCallback=null,e.removeEventListener(\"beforeRender\",this._updateMovementHandler),t&&t())},Hu.prototype.movement=function(){return this._movement},Hu.prototype._updateMovement=function(){if(!this._movement)throw new Error(\"Should not call update\");var t=this._viewer.renderLoop(),e=this._view,n=Pu()-this._movementStartTime,i=this._movementStep,r=this._movementParams;null==(r=i(r=e.parameters(r),n))?this.stopMovement():(e.setParameters(r),t.renderOnNextFrame())},Hu.prototype._updateHotspotContainer=function(){this.visible()?this._hotspotContainer.show():this._hotspotContainer.hide()};var Du=Hu,Fu=yl,qu=qt,ju={duration:1/0};function Vu(t){t=Fu(t||{},ju),this._duration=t.duration,this._startTime=null,this._handle=null,this._check=this._check.bind(this)}Ft(Vu),Vu.prototype.start=function(){this._startTime=qu(),null==this._handle&&this._duration<1/0&&this._setup(this._duration)},Vu.prototype.started=function(){return null!=this._startTime},Vu.prototype.stop=function(){this._startTime=null,null!=this._handle&&(clearTimeout(this._handle),this._handle=null)},Vu.prototype._setup=function(t){this._handle=setTimeout(this._check,t)},Vu.prototype._teardown=function(){clearTimeout(this._handle),this._handle=null},Vu.prototype._check=function(){var t=qu()-this._startTime,e=this._duration-t;this._teardown(),e<=0?(this.emit(\"timeout\"),this._startTime=null):e<1/0&&this._setup(e)},Vu.prototype.duration=function(){return this._duration},Vu.prototype.setDuration=function(t){this._duration=t,null!=this._startTime&&this._check()};var Nu=Vu,Bu=yl,Xu=Kt,Wu={active:\"move\",inactive:\"default\",disabled:\"default\"};function Yu(t,e,n,i){i=Bu(i||{},Wu),this._element=n,this._controls=t,this._id=e,this._attached=!1,this._setActiveCursor=this._setCursor.bind(this,i.active),this._setInactiveCursor=this._setCursor.bind(this,i.inactive),this._setDisabledCursor=this._setCursor.bind(this,i.disabled),this._setOriginalCursor=this._setCursor.bind(this,this._element.style.cursor),this._updateAttachmentHandler=this._updateAttachment.bind(this),t.addEventListener(\"methodEnabled\",this._updateAttachmentHandler),t.addEventListener(\"methodDisabled\",this._updateAttachmentHandler),t.addEventListener(\"enabled\",this._updateAttachmentHandler),t.addEventListener(\"disabled\",this._updateAttachmentHandler),this._updateAttachment()}Yu.prototype.destroy=function(){this._detachFromControlMethod(this._controls.method(this._id)),this._setOriginalCursor(),this._controls.removeEventListener(\"methodEnabled\",this._updateAttachmentHandler),this._controls.removeEventListener(\"methodDisabled\",this._updateAttachmentHandler),this._controls.removeEventListener(\"enabled\",this._updateAttachmentHandler),this._controls.removeEventListener(\"disabled\",this._updateAttachmentHandler),Xu(this)},Yu.prototype._updateAttachment=function(){var t=this._controls,e=this._id;t.enabled()&&t.method(e).enabled?this._attachToControlMethod(t.method(e)):this._detachFromControlMethod(t.method(e))},Yu.prototype._attachToControlMethod=function(t){this._attached||(t.instance.addEventListener(\"active\",this._setActiveCursor),t.instance.addEventListener(\"inactive\",this._setInactiveCursor),t.active?this._setActiveCursor():this._setInactiveCursor(),this._attached=!0)},Yu.prototype._detachFromControlMethod=function(t){this._attached&&(t.instance.removeEventListener(\"active\",this._setActiveCursor),t.instance.removeEventListener(\"inactive\",this._setInactiveCursor),this._setDisabledCursor(),this._attached=!1)},Yu.prototype._setCursor=function(t){this._element.style.cursor=t};var Uu=yl,Gu=$c,Ku=kc,Zu=Hc,Qu=Vc,Ju=tc,th={mouseViewMode:\"drag\",dragMode:\"pan\"};var eh=function(t,e,n){n=Uu(n||{},th);var i={mouseViewDrag:new Gu(e,\"mouse\"),mouseViewQtvr:new Ku(e,\"mouse\"),leftArrowKey:new Ju(37,\"x\",-.7,3),rightArrowKey:new Ju(39,\"x\",.7,3),upArrowKey:new Ju(38,\"y\",-.7,3),downArrowKey:new Ju(40,\"y\",.7,3),plusKey:new Ju(107,\"zoom\",-.7,3),minusKey:new Ju(109,\"zoom\",.7,3),wKey:new Ju(87,\"y\",-.7,3),aKey:new Ju(65,\"x\",-.7,3),sKey:new Ju(83,\"y\",.7,3),dKey:new Ju(68,\"x\",.7,3),qKey:new Ju(81,\"roll\",.7,3),eKey:new Ju(69,\"roll\",-.7,3)},r=[\"scrollZoom\",\"touchView\",\"pinch\"];!1!==n.scrollZoom&&(i.scrollZoom=new Zu(e));var o={arrowKeys:[\"leftArrowKey\",\"rightArrowKey\",\"upArrowKey\",\"downArrowKey\"],plusMinusKeys:[\"plusKey\",\"minusKey\"],wasdKeys:[\"wKey\",\"aKey\",\"sKey\",\"dKey\"],qeKeys:[\"qKey\",\"eKey\"]};switch(n.dragMode){case\"pinch\":i.pinch=new Gu(e,\"touch\",{hammerEvent:\"pinch\"});break;case\"pan\":i.touchView=new Gu(e,\"touch\"),i.pinch=new Qu(e,\"touch\");break;default:throw new Error(\"Unknown drag mode: \"+n.dragMode)}switch(n.mouseViewMode){case\"drag\":r.push(\"mouseViewDrag\");break;case\"qtvr\":r.push(\"mouseViewQtvr\");break;default:throw new Error(\"Unknown mouse view mode: \"+n.mouseViewMode)}for(var s in i){var a=i[s];t.registerMethod(s,a),r.indexOf(s)>=0&&t.enableMethod(s)}for(var l in o){var c=o[l];t.addMethodGroup(l,c)}return i},nh=qt;var ih=function(t,e,n){var i=!1,r=nh();return e(0),requestAnimationFrame((function o(){if(!i){var s=(nh()-r)/t;s<1?(e(s),requestAnimationFrame(o)):(e(1),n())}})),function(){i=!0,n.apply(null,arguments)}},rh=Ft,oh=Ul,sh=su,ah=Du,lh=Nu,ch=Ge,uh=Yu,hh=lc,fh=eh,ph=Go,dh=Re.setOverflowHidden,mh=Re.setAbsolute,vh=Re.setFullSize,_h=ih,yh=Ua,gh=Kt;function wh(t,e){e=e||{},this._domElement=t,dh(t),this._stage=new ch(e.stage),ph(this._stage),this._domElement.appendChild(this._stage.domElement()),this._controlContainer=document.createElement(\"div\"),mh(this._controlContainer),vh(this._controlContainer),t.appendChild(this._controlContainer),this._size={},this.updateSize(),this._updateSizeListener=this.updateSize.bind(this),window.addEventListener(\"resize\",this._updateSizeListener),this._renderLoop=new oh(this._stage),this._controls=new sh,this._controlMethods=fh(this._controls,this._controlContainer,e.controls),this._controls.attach(this._renderLoop),this._hammerManagerTouch=hh.get(this._controlContainer,\"touch\"),this._hammerManagerMouse=hh.get(this._controlContainer,\"mouse\"),this._dragCursor=new uh(this._controls,\"mouseViewDrag\",t,e.cursors&&e.cursors.drag||{}),this._renderLoop.start(),this._scenes=[],this._currentScene=null,this._replacedScene=null,this._cancelCurrentTween=null,this._layerChangeHandler=this._updateSceneLayers.bind(this),this._viewChangeHandler=this.emit.bind(this,\"viewChange\"),this._idleTimer=new lh,this._idleTimer.start(),this._resetIdleTimerHandler=this._resetIdleTimer.bind(this),this.addEventListener(\"viewChange\",this._resetIdleTimerHandler),this._triggerIdleTimerHandler=this._triggerIdleTimer.bind(this),this._idleTimer.addEventListener(\"timeout\",this._triggerIdleTimerHandler),this._stopMovementHandler=this.stopMovement.bind(this),this._controls.addEventListener(\"active\",this._stopMovementHandler),this.addEventListener(\"sceneChange\",this._stopMovementHandler),this._idleMovement=null}rh(wh),wh.prototype.destroy=function(){for(var t in window.removeEventListener(\"resize\",this._updateSizeListener),this._currentScene&&this._removeSceneEventListeners(this._currentScene),this._replacedScene&&this._removeSceneEventListeners(this._replacedScene),this._dragCursor.destroy(),this._controlMethods)this._controlMethods[t].destroy();for(;this._scenes.length;)this.destroyScene(this._scenes[0]);this._domElement.removeChild(this._stage.domElement()),this._stage.destroy(),this._renderLoop.destroy(),this._controls.destroy(),this._controls=null,this._cancelCurrentTween&&this._cancelCurrentTween(),gh(this)},wh.prototype.updateSize=function(){var t=this._size;t.width=this._domElement.clientWidth,t.height=this._domElement.clientHeight,this._stage.setSize(t)},wh.prototype.stage=function(){return this._stage},wh.prototype.renderLoop=function(){return this._renderLoop},wh.prototype.controls=function(){return this._controls},wh.prototype.domElement=function(){return this._domElement},wh.prototype.createScene=function(t){t=t||{};var e=this.createEmptyScene({view:t.view});return e.createLayer({source:t.source,geometry:t.geometry,pinFirstLevel:t.pinFirstLevel,textureStoreOpts:t.textureStoreOpts,layerOpts:t.layerOpts}),e},wh.prototype.createEmptyScene=function(t){var e=new ah(this,(t=t||{}).view);return this._scenes.push(e),e},wh.prototype._updateSceneLayers=function(){var t,e,n=this._stage,i=this._currentScene,r=this._replacedScene,o=n.listLayers(),s=[];if(r&&(s=s.concat(r.listLayers())),i&&(s=s.concat(i.listLayers())),1!==Math.abs(o.length-s.length))throw new Error(\"Stage and scene out of sync\");if(s.length<o.length)for(t=0;t<o.length;t++)if(e=o[t],s.indexOf(e)<0){this._removeLayerFromStage(e);break}if(s.length>o.length)for(t=0;t<s.length;t++)e=s[t],o.indexOf(e)<0&&this._addLayerToStage(e,t)},wh.prototype._addLayerToStage=function(t,e){t.pinFirstLevel(),this._stage.addLayer(t,e)},wh.prototype._removeLayerFromStage=function(t){this._stage.removeLayer(t),t.unpinFirstLevel(),t.textureStore().clearNotPinned()},wh.prototype._addSceneEventListeners=function(t){t.addEventListener(\"layerChange\",this._layerChangeHandler),t.addEventListener(\"viewChange\",this._viewChangeHandler)},wh.prototype._removeSceneEventListeners=function(t){t.removeEventListener(\"layerChange\",this._layerChangeHandler),t.removeEventListener(\"viewChange\",this._viewChangeHandler)},wh.prototype.destroyScene=function(t){var e,n,i=this._scenes.indexOf(t);if(i<0)throw new Error(\"No such scene in viewer\");if(this._currentScene===t){for(this._removeSceneEventListeners(t),n=t.listLayers(),e=0;e<n.length;e++)this._removeLayerFromStage(n[e]);this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null),this._currentScene=null,this.emit(\"sceneChange\")}if(this._replacedScene===t){for(this._removeSceneEventListeners(t),n=t.listLayers(),e=0;e<n.length;e++)this._removeLayerFromStage(n[e]);this._replacedScene=null}this._scenes.splice(i,1),t.destroy()},wh.prototype.destroyAllScenes=function(){for(;this._scenes.length>0;)this.destroyScene(this._scenes[0])},wh.prototype.hasScene=function(t){return this._scenes.indexOf(t)>=0},wh.prototype.listScenes=function(){return[].concat(this._scenes)},wh.prototype.scene=function(){return this._currentScene},wh.prototype.view=function(){var t=this._currentScene;return t?t.view():null},wh.prototype.lookTo=function(t,e,n){var i=this._currentScene;i&&i.lookTo(t,e,n)},wh.prototype.startMovement=function(t,e){var n=this._currentScene;n&&n.startMovement(t,e)},wh.prototype.stopMovement=function(){var t=this._currentScene;t&&t.stopMovement()},wh.prototype.movement=function(){var t=this._currentScene;if(t)return t.movement()},wh.prototype.setIdleMovement=function(t,e){this._idleTimer.setDuration(t),this._idleMovement=e},wh.prototype.breakIdleMovement=function(){this.stopMovement(),this._resetIdleTimer()},wh.prototype._resetIdleTimer=function(){this._idleTimer.start()},wh.prototype._triggerIdleTimer=function(){var t=this._idleMovement;t&&this.startMovement(t)};function $h(t,e,n){e.listLayers().forEach((function(e){e.mergeEffects({opacity:t})})),e._hotspotContainer.domElement().style.opacity=t}wh.prototype.switchScene=function(t,e,n){var i=this;e=e||{},n=n||yh;var r=this._stage,o=this._currentScene;if(o!==t){if(this._scenes.indexOf(t)<0)throw new Error(\"No such scene in viewer\");this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null);var s=o?o.listLayers():[],a=t.listLayers(),l=r.listLayers();if(o&&(l.length!==s.length||l.length>1&&l[0]!=s[0]))throw new Error(\"Stage not in sync with viewer\");for(var c=null!=e.transitionDuration?e.transitionDuration:1e3,u=null!=e.transitionUpdate?e.transitionUpdate:$h,h=0;h<a.length;h++)this._addLayerToStage(a[h]);this._cancelCurrentTween=_h(c,(function(e){u(e,t,o)}),(function(){if(i._replacedScene){i._removeSceneEventListeners(i._replacedScene),s=i._replacedScene.listLayers();for(var t=0;t<s.length;t++)i._removeLayerFromStage(s[t]);i._replacedScene=null}i._cancelCurrentTween=null,n()})),this._currentScene=t,this._replacedScene=o,this.emit(\"sceneChange\"),this.emit(\"viewChange\"),this._addSceneEventListeners(t)}else n()};var bh=wh,xh=Or.vec4,Mh=Or.mat4;function Eh(t,e,n){var i,r,o,s,a,l,c;i=n,r=t,o=e.colorMatrix,s=r[0],a=r[1],l=r[2],c=r[3],i[0]=o[0]*s+o[1]*a+o[2]*l+o[3]*c,i[1]=o[4]*s+o[5]*a+o[6]*l+o[7]*c,i[2]=o[8]*s+o[9]*a+o[10]*l+o[11]*c,i[3]=o[12]*s+o[13]*a+o[14]*l+o[15]*c,xh.add(n,n,e.colorOffset)}var Th=xh.create();var Lh={identity:function(t){var e=t||{};return e.colorOffset=e.colorOffset||xh.create(),e.colorMatrix=e.colorMatrix||Mh.create(),e},applyToPixel:Eh,applyToImageData:function(t,e){for(var n=t.width,i=t.height,r=t.data,o=0;o<n*i;o++)xh.set(Th,r[4*o+0]/255,r[4*o+1]/255,r[4*o+2]/255,r[4*o+3]/255),Eh(Th,e,Th),r[4*o+0]=255*Th[0],r[4*o+1]=255*Th[1],r[4*o+2]=255*Th[2],r[4*o+3]=255*Th[3]}},Ch=yl,Sh=.01,kh={yawSpeed:.1,pitchSpeed:.1,fovSpeed:.1,yawAccel:Sh,pitchAccel:Sh,fovAccel:Sh,targetPitch:0,targetFov:null};var Ih={WebGlStage:Ge,WebGlCubeRenderer:wo,WebGlFlatRenderer:bo,WebGlEquirectRenderer:Xo,registerDefaultRenderers:Go,CubeGeometry:Fs,FlatGeometry:ia,EquirectGeometry:pa,RectilinearView:Aa,FlatView:Ba,ImageUrlSource:sl,SingleAssetSource:ll,StaticAsset:pe,DynamicAsset:fl,TextureStore:ql,Layer:Xl,RenderLoop:Ul,KeyControlMethod:tc,DragControlMethod:$c,QtvrControlMethod:kc,ScrollZoomControlMethod:Hc,PinchZoomControlMethod:Vc,VelocityControlMethod:Wc,ElementPressControlMethod:Kc,Controls:su,Dynamics:Kl,Viewer:bh,Scene:Du,Hotspot:mu,HotspotContainer:Cu,colorEffects:Lh,registerDefaultControls:eh,autorotate:function(t){var e=(t=Ch(t||{},kh)).yawSpeed,n=t.pitchSpeed,i=t.fovSpeed,r=t.yawAccel,o=t.pitchAccel,s=t.fovAccel,a=t.targetPitch,l=t.targetFov;return function(){var t,c,u,h,f=0,p=0,d=0,m=0,v=0,_=0,y=0;return function(g,w){if(t=(w-f)/1e3,v=Math.min(p+t*r,e),c=v*t,g.yaw=g.yaw+c,null!=a&&g.pitch!==a){var $=.5*d*d/o;_=Math.abs(a-g.pitch)>$?Math.min(d+t*o,n):Math.max(d-t*o,0),u=_*t,a<g.pitch&&(g.pitch=Math.max(a,g.pitch-u)),a>g.pitch&&(g.pitch=Math.min(a,g.pitch+u))}if(null!=l&&g.fov!==a){var b=.5*m*m/s;y=Math.abs(l-g.fov)>b?Math.min(m+t*s,i):Math.max(m-t*s,0),h=y*t,l<g.fov&&(g.fov=Math.max(l,g.fov-h)),l>g.fov&&(g.fov=Math.min(l,g.fov+h))}return f=w,p=v,d=_,m=y,g}}},util:{async:Wt,cancelize:Gt,chain:Ka,clamp:Rr,clearOwnProperties:Kt,cmp:cs,compose:ya,convertFov:ma,decimal:_a,defaults:yl,defer:function(t,e){setTimeout((function(){e&&e.length>0?t.apply(null,e):t()}),0)},degToRad:function(t){return t*Math.PI/180},delay:Za,dom:Re,extend:jl,hash:Ko,inherits:de,mod:Zo,noop:Ua,now:qt,once:Yt,pixelRatio:ke,radToDeg:function(t){return 180*t/Math.PI},real:va,retry:wl,tween:ih,type:fs},dependencies:{bowser:we.exports,glMatrix:Or,eventEmitter:Ft,hammerjs:ec.exports}};const Ph=()=>new URL(customProperties.api.url,window.location.origin).href,Ah=t=>t?`${Ph()}file/${t}`:\"\";const zh=(t,e)=>{function n(){const n=(t=>getTemplateSrv().replace(`$${t}`))(t);return e?Number(n):n}const{set:i,subscribe:r,update:o}=Tt(n());return{set:i,subscribe:r,update:o,setVariable:e=>((t,e)=>getLocationSrv().update({query:{[`var-${t}`]:e},partial:!0}))(t,String(e)),updateVariable:t=>{const e=n();e!=t&&i(e)}}},{editable:Oh,templateVariables:{area:Rh,autoRotate:Hh,scene:Dh}}=customProperties,Fh=zh(Rh,!0),qh=zh(Dh,!0),jh=zh(Hh,!1),Vh=Tt(data),Nh=Tt(),Bh=Tt(Ot()),Xh=Lt(Bh,(({areas:t})=>t)),Wh=Lt(Bh,(({scenes:t})=>t)),Yh=Lt(Bh,(({hotspots:t})=>t)),Uh=Tt({}),Gh=Lt([Xh,Uh],(([t,e])=>t.map((t=>Object.assign(Object.assign({},t),e[t.area_key]))))),Kh=Lt(Oh?Gh:Xh,(t=>t)),Zh=Tt({}),Qh=Tt([]),Jh=Lt([Yh,Zh,Qh],(([t,e,n])=>[...t,...n].map((t=>Object.assign(Object.assign({},t),e[t.hotspot_key]))))),tf=Lt([Oh?Jh:Yh,Nh],(([t,e])=>e&&t?t:[])),ef=Tt({}),nf=Lt([Wh,ef],(([t,e])=>t.map((t=>Object.assign(Object.assign({},t),e[t.scene_key]))))),rf=Lt([Oh?nf:Wh,Nh],(([t,e])=>e&&t?t:[])),of=Lt([rf,Nh],(async([t,e])=>e&&t?await async function(t,e){e.destroyAllScenes();const n=Promise.all(t.map((async t=>{const n=Ah(t.file_id),i=Ih.ImageUrlSource.fromString(n),r=new Ih.EquirectGeometry([{width:4096}]),o=Ih.util.compose(Ih.RectilinearView.limit.vfov(.1,3),Ih.RectilinearView.limit.hfov(.1,3),Ih.RectilinearView.limit.pitch(-Math.PI/2,Math.PI/2)),s=new Ih.RectilinearView({yaw:t.facing_yaw,pitch:t.facing_pitch,fov:t.fov*Math.PI/180},o),a=e.createScene({source:i,geometry:r,view:s,pinFirstLevel:!0});return{name:t.scene_name,key:t.scene_key,scene:a}})));return n}(t,e):[])),sf=Lt([Nh,of,qh],(async([t,e,n])=>{const i=await e;if(t&&0!==i.length)return i.find((t=>t.key===n))})),af=Tt(null),lf=Tt(1),cf=Tt({pitch:0,yaw:0}),uf=Tt([]);var hf=function t(e,n){if(e===n)return!0;if(e&&n&&\"object\"==typeof e&&\"object\"==typeof n){if(e.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(e)){if((i=e.length)!=n.length)return!1;for(r=i;0!=r--;)if(!t(e[r],n[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((i=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(r=i;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;0!=r--;){var s=o[r];if(!t(e[s],n[s]))return!1}return!0}return e!=e&&n!=n};const ff=t=>({}),pf=t=>({}),df=t=>({}),mf=t=>({});function vf(t){let e,n,i,r,o,s,a,l,c,u,h,f;const p=t[6].title,m=d(p,t,t[5],mf),g=m||function(t){let e;return{c(){e=L(t[0])},m(t,n){b(t,e,n)},p(t,n){1&n&&O(e,t[0])},d(t){t&&x(e)}}}(t),w=t[6].value,M=d(w,t,t[5],pf),C=M||function(t){let e;return{c(){e=L(t[3])},m(t,n){b(t,e,n)},p(t,n){8&n&&O(e,t[3])},d(t){t&&x(e)}}}(t),S=t[6].default,P=d(S,t,t[5],null);return{c(){e=E(\"div\"),n=T(\"svg\"),i=T(\"g\"),r=T(\"g\"),o=T(\"rect\"),s=T(\"rect\"),l=T(\"text\"),g&&g.c(),c=T(\"text\"),C&&C.c(),P&&P.c(),I(o,\"width\",\"204\"),I(o,\"height\",\"60\"),I(o,\"stroke\",\"none\"),I(s,\"x\",\"-2.5\"),I(s,\"y\",\"-2.5\"),I(s,\"width\",\"209\"),I(s,\"height\",\"65\"),I(s,\"fill\",\"none\"),I(r,\"transform\",\"translate(657 552)\"),I(r,\"fill\",\"#1b191c\"),I(r,\"stroke\",a=t[1]??\"#000\"),I(r,\"stroke-width\",\"5\"),I(r,\"opacity\",\"0.88\"),I(l,\"class\",\"type svelte-11tniiw\"),I(l,\"transform\",\"translate(669 573)\"),I(l,\"fill\",\"#d6d6d6\"),I(l,\"font-size\",\"16\"),I(l,\"font-family\",\"OpenSans, Open Sans\"),I(l,\"letter-spacing\",\"0.01em\"),I(c,\"class\",\"value\"),I(c,\"transform\",\"translate(669 602)\"),I(c,\"fill\",\"#fcfcfc\"),I(c,\"font-size\",\"26\"),I(c,\"font-family\",\"OpenSans-Semibold, Open Sans\"),I(c,\"font-weight\",\"600\"),I(i,\"transform\",\"translate(-652 -547)\"),I(n,\"xmlns\",\"http://www.w3.org/2000/svg\"),I(n,\"width\",\"100%\"),I(n,\"height\",\"100%\"),I(n,\"viewBox\",\"0 0 214 70\"),I(e,\"class\",\"hotspot svelte-11tniiw\"),F(e,\"link\",t[2])},m(a,p){b(a,e,p),$(e,n),$(n,i),$(i,r),$(r,o),$(r,s),$(i,l),g&&g.m(l,null),$(i,c),C&&C.m(c,null),P&&P.m(c,null),u=!0,h||(f=k(e,\"click\",t[4]),h=!0)},p(t,[n]){(!u||2&n&&a!==(a=t[1]??\"#000\"))&&I(r,\"stroke\",a),m?m.p&&(!u||32&n)&&_(m,p,t,t[5],u?v(p,t[5],n,df):y(t[5]),mf):g&&g.p&&(!u||1&n)&&g.p(t,u?n:-1),M?M.p&&(!u||32&n)&&_(M,w,t,t[5],u?v(w,t[5],n,ff):y(t[5]),pf):C&&C.p&&(!u||8&n)&&C.p(t,u?n:-1),P&&P.p&&(!u||32&n)&&_(P,S,t,t[5],u?v(S,t[5],n,null):y(t[5]),null),4&n&&F(e,\"link\",t[2])},i(t){u||(ht(g,t),ht(C,t),ht(P,t),u=!0)},o(t){ft(g,t),ft(C,t),ft(P,t),u=!1},d(t){t&&x(e),g&&g.d(t),C&&C.d(t),P&&P.d(t),h=!1,f()}}}function _f(t,e,n){let{$$slots:i={},$$scope:r}=e,{title:o}=e,{color:s}=e,{link:a=\"\"}=e,{value:l}=e;return t.$$set=t=>{\"title\"in t&&n(0,o=t.title),\"color\"in t&&n(1,s=t.color),\"link\"in t&&n(2,a=t.link),\"value\"in t&&n(3,l=t.value),\"$$scope\"in t&&n(5,r=t.$$scope)},[o,s,a,l,function(t){a&&window.open(a,t.ctrlKey?\"_blank\":\"_self\")},r,i]}class yf extends Mt{constructor(t){super(),xt(this,t,_f,vf,s,{title:0,color:1,link:2,value:3})}}function gf(e){let n;return{c(){n=E(\"div\"),n.textContent=\"Hello\",I(n,\"class\",\"hotspot svelte-zjwjw7\")},m(t,i){b(t,n,i),e[1](n)},p:t,i:t,o:t,d(t){t&&x(n),e[1](null)}}}function wf(t,e,n){let i;return[i,function(t){U[t?\"unshift\":\"push\"]((()=>{i=t,n(0,i)}))}]}class $f extends Mt{constructor(t){super(),xt(this,t,wf,gf,s,{})}}function bf(e){let n,i,r;return{c(){n=E(\"div\"),n.innerHTML='<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"0 0 95 95\"><g id=\"Group_2\" data-name=\"Group 2\" transform=\"translate(-1406 -828)\"><circle id=\"Ellipse_1\" data-name=\"Ellipse 1\" cx=\"47.5\" cy=\"47.5\" r=\"47.5\" transform=\"translate(1406 828)\" fill=\"#1b191c\" opacity=\"0.88\"></circle><path id=\"Path_1\" data-name=\"Path 1\" d=\"M846.277,2011.457l19.539-19.539,19.539,19.539\" transform=\"translate(587.223 -1126.417)\" fill=\"none\" stroke=\"#f5f5f5\" stroke-width=\"5\"></path></g></svg>',I(n,\"class\",\"hotspot svelte-1l62dig\")},m(t,o){b(t,n,o),i||(r=k(n,\"click\",e[0]),i=!0)},p:t,i:t,o:t,d(t){t&&x(n),i=!1,r()}}}function xf(t,e,n){let{go_to_scene_key:i}=e;return t.$$set=t=>{\"go_to_scene_key\"in t&&n(1,i=t.go_to_scene_key)},[function(){i?customProperties.editable||qh.setVariable(i):console.warn(\"Missing go_to_scene_key\")},i]}class Mf extends Mt{constructor(t){super(),xt(this,t,xf,bf,s,{go_to_scene_key:1})}}function Ef(e){let n,i;return{c(){n=T(\"tspan\"),i=L(e[0]),I(n,\"class\",\"grafana-value\")},m(t,e){b(t,n,e),$(n,i)},p(t,[e]){1&e&&O(i,t[0])},i:t,o:t,d(t){t&&x(n)}}}function Tf(t,e,n){let{alias:i}=e,{unit:r=\"\"}=e,{decimals:o=1}=e,s=\"No data\",a=!0;function l(){if(!i)return;const t=zt(i,{noDataValue:\"No data\"});n(0,s=\"number\"==typeof t?`${t.toFixed(o)} ${r}`:\"No data\")}return Vh.subscribe(l),t.$$set=t=>{\"alias\"in t&&n(1,i=t.alias),\"unit\"in t&&n(2,r=t.unit),\"decimals\"in t&&n(3,o=t.decimals)},t.$$.update=()=>{18&t.$$.dirty&&i&&(a||l(),n(4,a=!1))},[s,i,r,o,a]}class Lf extends Mt{constructor(t){super(),xt(this,t,Tf,Ef,s,{alias:1,unit:2,decimals:3})}}function Cf(t){let e,n;const i=t[5].default,r=d(i,t,t[4],null);return{c(){e=E(\"div\"),r&&r.c()},m(t,i){b(t,e,i),r&&r.m(e,null),n=!0},p(t,e){r&&r.p&&(!n||16&e)&&_(r,i,t,t[4],n?v(i,t[4],e,null):y(t[4]),null)},i(t){n||(ht(r,t),n=!0)},o(t){ft(r,t),n=!1},d(t){t&&x(e),r&&r.d(t)}}}function Sf(t){let e,n,i,r;const o=t[5].default,s=d(o,t,t[4],null);return{c(){e=E(\"div\"),s&&s.c(),I(e,\"class\",\"draggable svelte-1uh541o\")},m(o,a){b(o,e,a),s&&s.m(e,null),t[6](e),n=!0,i||(r=k(e,\"mousedown\",t[2]),i=!0)},p(t,e){s&&s.p&&(!n||16&e)&&_(s,o,t,t[4],n?v(o,t[4],e,null):y(t[4]),null)},i(t){n||(ht(s,t),n=!0)},o(t){ft(s,t),n=!1},d(n){n&&x(e),s&&s.d(n),t[6](null),i=!1,r()}}}function kf(t){let e,n,i,r;const o=[Sf,Cf],s=[];function a(t,e){return t[0]?0:1}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),i=S()},m(t,n){s[e].m(t,n),b(t,i,n),r=!0},p(t,[r]){let l=e;e=a(t),e===l?s[e].p(t,r):(ct(),ft(s[l],1,1,(()=>{s[l]=null})),ut(),n=s[e],n?n.p(t,r):(n=s[e]=o[e](t),n.c()),ht(n,1),n.m(i.parentNode,i))},i(t){r||(ht(n),r=!0)},o(t){ft(n),r=!1},d(t){s[e].d(t),t&&x(i)}}}function If(t,e,n){let i;p(t,Nh,(t=>n(9,i=t)));let{$$slots:r={},$$scope:o}=e,{hotspot:s}=e,{editable:a}=e;const l=i,c=W();let u,h,f;function d(t){const{x:e,y:n}=l.domElement().getBoundingClientRect(),{x:i,y:r}=u.getBoundingClientRect(),o=t.x-h+i-e,a=t.y-f+r-n;h=t.x,f=t.y,s.setPosition(l.view().screenToCoordinates({x:o,y:a}))}function m(){console.info(\"Hotspot position\",s.position()),c(\"newposition\",s.position()),window.removeEventListener(\"mousemove\",d),window.removeEventListener(\"mouseup\",m)}return t.$$set=t=>{\"hotspot\"in t&&n(3,s=t.hotspot),\"editable\"in t&&n(0,a=t.editable),\"$$scope\"in t&&n(4,o=t.$$scope)},[a,u,function(t){h=t.x,f=t.y,window.addEventListener(\"mousemove\",d),window.addEventListener(\"mouseup\",m)},s,o,r,function(t){U[t?\"unshift\":\"push\"]((()=>{u=t,n(1,u)}))}]}class Pf extends Mt{constructor(t){super(),xt(this,t,If,kf,s,{hotspot:3,editable:0})}}const{isGrafana:Af,api:{token:zf}}=customProperties,Of={[(Af?\"X-DS-\":\"\")+\"Authorization\"]:`Bearer ${zf}`},Rf=Object.assign(Object.assign({\"Content-Type\":\"application/json\"},Of),{Prefer:\"return=representation\"});const Hf=new class{constructor(){this.aborter=new AbortController}async request(t,e={}){return new Promise(((n,i)=>{const r=new URL(t);for(const t of Object.entries(e))r.searchParams.append(...t);fetch(r.href,{signal:this.aborter.signal}).then((t=>t.json().then(n).catch(i))).catch(i)}))}};async function Df(t={}){return Hf.request(`${Ph()}areas`,t)}async function Ff(t={}){return Hf.request(`${Ph()}scenes`,t)}async function qf(t={}){return Hf.request(`${Ph()}hotspots`,t)}async function jf(){Fh.updateVariable(f(Fh)),qh.updateVariable(f(qh)),jh.updateVariable(f(jh));const t=customProperties.editable?await async function(){const t=f(Fh);return Hf.aborter.abort(),Hf.aborter=new AbortController,new Promise(((e,n)=>{Promise.all([Df(),Ff({area_key:`eq.${t}`}),qf({area_key:`eq.${t}`})]).then((([t,n,i])=>{t.sort(((t,e)=>t.area_key-e.area_key)),n.sort(((t,e)=>t.scene_key-e.scene_key)),i.sort(((t,e)=>Number(t.hotspot_key)-Number(e.hotspot_key))),e({areas:t,scenes:n,hotspots:i})})).catch(n)}))}():Ot();t&&!hf(f(Bh),t)&&Bh.set(t);const e=f(Nh);e&&e.updateSize()}function Vf(t,{attachToNode:e=htmlNode,ignoreNodes:n=[],ignoreNodesStores:i=[]}={}){const r=e=>{const r=e.composedPath();[t,...n].concat(...i.map((t=>f(t)))).some((t=>r.includes(t)))||e.defaultPrevented||t.dispatchEvent(new CustomEvent(\"outsideclick\"))};return e.addEventListener(\"mousedown\",r,!0),{destroy(){e.removeEventListener(\"mousedown\",r,!0)}}}function Nf(t,e,n){const i=t.slice();return i[9]=e[n],i}function Bf(t,e,n){const i=t.slice();return i[12]=e[n],i}function Xf(t){let e,n,i=t[3],r=[];for(let e=0;e<i.length;e+=1)r[e]=Yf(Nf(t,i,e));return{c(){e=E(\"div\"),n=E(\"div\");for(let t=0;t<r.length;t+=1)r[t].c();I(n,\"class\",\"values-dropdown-grid svelte-w9c1hk\"),I(e,\"class\",\"values-dropdown svelte-w9c1hk\")},m(t,i){b(t,e,i),$(e,n);for(let t=0;t<r.length;t+=1)r[t].m(n,null)},p(t,e){if(73&e){let o;for(i=t[3],o=0;o<i.length;o+=1){const s=Nf(t,i,o);r[o]?r[o].p(s,e):(r[o]=Yf(s),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=i.length}},d(t){t&&x(e),M(r,t)}}}function Wf(t){let e,n,i;function r(){return t[8](t[12])}return{c(){e=E(\"button\"),H(e,\"background\",t[12]),I(e,\"class\",\"color-block svelte-w9c1hk\"),F(e,\"active\",t[12]==t[0])},m(t,o){b(t,e,o),n||(i=k(e,\"click\",r),n=!0)},p(n,i){t=n,9&i&&F(e,\"active\",t[12]==t[0])},d(t){t&&x(e),n=!1,i()}}}function Yf(t){let e,n=t[9],i=[];for(let e=0;e<n.length;e+=1)i[e]=Wf(Bf(t,n,e));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=S()},m(t,n){for(let e=0;e<i.length;e+=1)i[e].m(t,n);b(t,e,n)},p(t,r){if(73&r){let o;for(n=t[9],o=0;o<n.length;o+=1){const s=Bf(t,n,o);i[o]?i[o].p(s,r):(i[o]=Wf(s),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(t){M(i,t),t&&x(e)}}}function Uf(e){let n,i,o,s,a,l,c,u,h,f,p=e[1]&&Xf(e);return{c(){n=E(\"div\"),i=L(\"color\\n  \"),o=E(\"div\"),s=E(\"button\"),a=E(\"div\"),l=C(),c=E(\"input\"),u=C(),p&&p.c(),I(a,\"class\",\"caret svelte-w9c1hk\"),H(a,\"border-top-color\",e[2]),H(a,\"border-bottom-color\",e[2]),F(a,\"toggled\",e[1]),I(s,\"class\",\"select-color svelte-w9c1hk\"),H(s,\"background\",e[0]),I(c,\"type\",\"text\"),I(c,\"class\",\"svelte-w9c1hk\"),I(o,\"class\",\"color-picker-inner svelte-w9c1hk\"),I(n,\"class\",\"color-picker-holder svelte-w9c1hk\")},m(t,r){b(t,n,r),$(n,i),$(n,o),$(o,s),$(s,a),$(o,l),$(o,c),R(c,e[0]),$(n,u),p&&p.m(n,null),h||(f=[k(s,\"click\",e[4]),k(c,\"input\",e[7]),w(Vf.call(null,n)),k(n,\"outsideclick\",e[5])],h=!0)},p(t,[e]){4&e&&H(a,\"border-top-color\",t[2]),4&e&&H(a,\"border-bottom-color\",t[2]),2&e&&F(a,\"toggled\",t[1]),1&e&&H(s,\"background\",t[0]),1&e&&c.value!==t[0]&&R(c,t[0]),t[1]?p?p.p(t,e):(p=Xf(t),p.c(),p.m(n,null)):p&&(p.d(1),p=null)},i:t,o:t,d(t){t&&x(n),p&&p.d(),h=!1,r(f)}}}function Gf(t,e,n){let{value:i=\"#000\"}=e,r=!1,o=\"black\";const s=t=>{n(0,i=t),n(1,r=!1)};return t.$$set=t=>{\"value\"in t&&n(0,i=t.value)},t.$$.update=()=>{if(1&t.$$.dirty){const t=function(t){t=t.replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i,(function(t,e,n,i){return e+e+n+n+i+i}));const e=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(null!=i?i:\"\"),e=t?Math.round((299*t.r+587*t.g+114*t.b)/1e3):255;n(2,o=e>125?\"black\":\"white\")}},[i,r,o,[[\"#7A36D2\",\"#17C1B6\",\"#48ADE0\",\"#D648E0\"]],()=>n(1,r=!r),()=>n(1,r=!1),s,function(){i=this.value,n(0,i)},t=>s(t)]}class Kf extends Mt{constructor(t){super(),xt(this,t,Gf,Uf,s,{value:0})}}function Zf(e){let n,i,r;return{c(){n=E(\"button\"),n.textContent=\"Delete\",I(n,\"class\",\"svelte-1nqmnxb\")},m(t,o){b(t,n,o),i||(r=k(n,\"click\",e[3]),i=!0)},p:t,d(t){t&&x(n),i=!1,r()}}}function Qf(t){let e,n,i,s,a;return{c(){e=E(\"button\"),e.textContent=\"Confirm deletion\",n=C(),i=E(\"button\"),i.textContent=\"Cancel\",I(e,\"class\",\"confirm svelte-1nqmnxb\"),I(i,\"class\",\"cancel svelte-1nqmnxb\")},m(r,l){b(r,e,l),b(r,n,l),b(r,i,l),s||(a=[k(e,\"click\",(function(){o(t[0])&&t[0].apply(this,arguments)})),k(i,\"click\",t[2])],s=!0)},p(e,n){t=e},d(t){t&&x(e),t&&x(n),t&&x(i),s=!1,r(a)}}}function Jf(e){let n;function i(t,e){return t[1]?Qf:Zf}let r=i(e),o=r(e);return{c(){n=E(\"div\"),o.c(),I(n,\"class\",\"svelte-1nqmnxb\")},m(t,e){b(t,n,e),o.m(n,null)},p(t,[e]){r===(r=i(t))&&o?o.p(t,e):(o.d(1),o=r(t),o&&(o.c(),o.m(n,null)))},i:t,o:t,d(t){t&&x(n),o.d()}}}function tp(t,e,n){let{deleteFunc:i}=e,r=!1;return t.$$set=t=>{\"deleteFunc\"in t&&n(0,i=t.deleteFunc)},[i,r,()=>n(1,r=!1),()=>n(1,r=!0)]}class ep extends Mt{constructor(t){super(),xt(this,t,tp,Jf,s,{deleteFunc:0})}}function np(t){let e,n,i,r,o,s;const a=t[5].default,l=d(a,t,t[4],null);return{c(){e=E(\"div\"),l&&l.c(),n=C(),i=E(\"input\"),I(i,\"type\",\"number\"),I(i,\"step\",t[1]),I(i,\"min\",t[2]),I(i,\"max\",t[3]),I(i,\"class\",\"svelte-uhbt6z\"),I(e,\"class\",\"svelte-uhbt6z\")},m(a,c){b(a,e,c),l&&l.m(e,null),$(e,n),$(e,i),R(i,t[0]),r=!0,o||(s=k(i,\"input\",t[6]),o=!0)},p(t,[e]){l&&l.p&&(!r||16&e)&&_(l,a,t,t[4],r?v(a,t[4],e,null):y(t[4]),null),(!r||2&e)&&I(i,\"step\",t[1]),(!r||4&e)&&I(i,\"min\",t[2]),(!r||8&e)&&I(i,\"max\",t[3]),1&e&&z(i.value)!==t[0]&&R(i,t[0])},i(t){r||(ht(l,t),r=!0)},o(t){ft(l,t),r=!1},d(t){t&&x(e),l&&l.d(t),o=!1,s()}}}function ip(t,e,n){let{$$slots:i={},$$scope:r}=e,{value:o}=e,{step:s=1}=e,{min:a}=e,{max:l}=e;return t.$$set=t=>{\"value\"in t&&n(0,o=t.value),\"step\"in t&&n(1,s=t.step),\"min\"in t&&n(2,a=t.min),\"max\"in t&&n(3,l=t.max),\"$$scope\"in t&&n(4,r=t.$$scope)},[o,s,a,l,r,i,function(){o=z(this.value),n(0,o)}]}class rp extends Mt{constructor(t){super(),xt(this,t,ip,np,s,{value:0,step:1,min:2,max:3})}}function op(e){let n,i,r=e[0](e[1],e[2])+\"\";return{c(){n=E(\"div\"),I(n,\"class\",i=\"item \"+e[3]+\" svelte-3e0qet\")},m(t,e){b(t,n,e),n.innerHTML=r},p(t,[e]){7&e&&r!==(r=t[0](t[1],t[2])+\"\")&&(n.innerHTML=r),8&e&&i!==(i=\"item \"+t[3]+\" svelte-3e0qet\")&&I(n,\"class\",i)},i:t,o:t,d(t){t&&x(n)}}}function sp(t,e,n){let{isActive:i=!1}=e,{isFirst:r=!1}=e,{isHover:o=!1}=e,{isSelectable:s=!1}=e,{getOptionLabel:a}=e,{item:l}=e,{filterText:c=\"\"}=e,u=\"\";return t.$$set=t=>{\"isActive\"in t&&n(4,i=t.isActive),\"isFirst\"in t&&n(5,r=t.isFirst),\"isHover\"in t&&n(6,o=t.isHover),\"isSelectable\"in t&&n(7,s=t.isSelectable),\"getOptionLabel\"in t&&n(0,a=t.getOptionLabel),\"item\"in t&&n(1,l=t.item),\"filterText\"in t&&n(2,c=t.filterText)},t.$$.update=()=>{if(242&t.$$.dirty){const t=[];i&&t.push(\"active\"),r&&t.push(\"first\"),o&&t.push(\"hover\"),l.isGroupHeader&&t.push(\"groupHeader\"),l.isGroupItem&&t.push(\"groupItem\"),s||t.push(\"notSelectable\"),n(3,u=t.join(\" \"))}},[a,l,c,u,i,r,o,s]}class ap extends Mt{constructor(t){super(),xt(this,t,sp,op,s,{isActive:4,isFirst:5,isHover:6,isSelectable:7,getOptionLabel:0,item:1,filterText:2})}}function lp(t,e,n){const i=t.slice();return i[41]=e[n],i[42]=n,i}function cp(t){let e,n,i=t[1],r=[];for(let e=0;e<i.length;e+=1)r[e]=mp(lp(t,i,e));const o=t=>ft(r[t],1,1,(()=>{r[t]=null}));let s=null;return i.length||(s=hp(t)),{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=S(),s&&s.c()},m(t,i){for(let e=0;e<r.length;e+=1)r[e].m(t,i);b(t,e,i),s&&s.m(t,i),n=!0},p(t,n){if(114390&n[0]){let a;for(i=t[1],a=0;a<i.length;a+=1){const o=lp(t,i,a);r[a]?(r[a].p(o,n),ht(r[a],1)):(r[a]=mp(o),r[a].c(),ht(r[a],1),r[a].m(e.parentNode,e))}for(ct(),a=i.length;a<r.length;a+=1)o(a);ut(),!i.length&&s?s.p(t,n):i.length?s&&(s.d(1),s=null):(s=hp(t),s.c(),s.m(e.parentNode,e))}},i(t){if(!n){for(let t=0;t<i.length;t+=1)ht(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)ft(r[t]);n=!1},d(t){M(r,t),t&&x(e),s&&s.d(t)}}}function up(t){let e,n,i;var r=t[3];function o(t){return{props:{items:t[1],itemHeight:t[8],$$slots:{default:[vp,({item:t,i:e})=>({41:t,42:e}),({item:t,i:e})=>[0,(t?1024:0)|(e?2048:0)]]},$$scope:{ctx:t}}}}return r&&(e=new r(o(t))),{c(){e&&wt(e.$$.fragment),n=S()},m(t,r){e&&$t(e,t,r),b(t,n,r),i=!0},p(t,i){const s={};if(2&i[0]&&(s.items=t[1]),256&i[0]&&(s.itemHeight=t[8]),9814&i[0]|11264&i[1]&&(s.$$scope={dirty:i,ctx:t}),r!==(r=t[3])){if(e){ct();const t=e;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}r?(e=new r(o(t)),wt(e.$$.fragment),ht(e.$$.fragment,1),$t(e,n.parentNode,n)):e=null}else r&&e.$set(s)},i(t){i||(e&&ht(e.$$.fragment,t),i=!0)},o(t){e&&ft(e.$$.fragment,t),i=!1},d(t){t&&x(n),e&&bt(e,t)}}}function hp(t){let e,n=!t[11]&&fp(t);return{c(){n&&n.c(),e=S()},m(t,i){n&&n.m(t,i),b(t,e,i)},p(t,i){t[11]?n&&(n.d(1),n=null):n?n.p(t,i):(n=fp(t),n.c(),n.m(e.parentNode,e))},d(t){n&&n.d(t),t&&x(e)}}}function fp(t){let e,n;return{c(){e=E(\"div\"),n=L(t[12]),I(e,\"class\",\"empty svelte-1uyqfml\")},m(t,i){b(t,e,i),$(e,n)},p(t,e){4096&e[0]&&O(n,t[12])},d(t){t&&x(e)}}}function pp(t){let e,n,i,o,s,a;var l=t[4];function c(t){return{props:{item:t[41],filterText:t[13],getOptionLabel:t[6],isFirst:gp(t[42]),isActive:yp(t[41],t[9],t[10]),isHover:wp(t[2],t[41],t[42],t[1]),isSelectable:$p(t[41])}}}function u(){return t[29](t[42])}function h(){return t[30](t[42])}function f(...e){return t[31](t[41],t[42],...e)}return l&&(n=new l(c(t))),{c(){e=E(\"div\"),n&&wt(n.$$.fragment),i=C(),I(e,\"class\",\"listItem\"),I(e,\"tabindex\",\"-1\")},m(t,r){b(t,e,r),n&&$t(n,e,null),$(e,i),o=!0,s||(a=[k(e,\"mouseover\",u),k(e,\"focus\",h),k(e,\"click\",f)],s=!0)},p(r,o){t=r;const s={};if(2&o[0]&&(s.item=t[41]),8192&o[0]&&(s.filterText=t[13]),64&o[0]&&(s.getOptionLabel=t[6]),1538&o[0]&&(s.isActive=yp(t[41],t[9],t[10])),6&o[0]&&(s.isHover=wp(t[2],t[41],t[42],t[1])),2&o[0]&&(s.isSelectable=$p(t[41])),l!==(l=t[4])){if(n){ct();const t=n;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}l?(n=new l(c(t)),wt(n.$$.fragment),ht(n.$$.fragment,1),$t(n,e,i)):n=null}else l&&n.$set(s)},i(t){o||(n&&ht(n.$$.fragment,t),o=!0)},o(t){n&&ft(n.$$.fragment,t),o=!1},d(t){t&&x(e),n&&bt(n),s=!1,r(a)}}}function dp(e){let n,i,r=e[7](e[41])+\"\";return{c(){n=E(\"div\"),i=L(r),I(n,\"class\",\"listGroupTitle svelte-1uyqfml\")},m(t,e){b(t,n,e),$(n,i)},p(t,e){130&e[0]&&r!==(r=t[7](t[41])+\"\")&&O(i,r)},i:t,o:t,d(t){t&&x(n)}}}function mp(t){let e,n,i,r;const o=[dp,pp],s=[];function a(t,e){return t[41].isGroupHeader&&!t[41].isSelectable?0:1}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),i=S()},m(t,n){s[e].m(t,n),b(t,i,n),r=!0},p(t,r){let l=e;e=a(t),e===l?s[e].p(t,r):(ct(),ft(s[l],1,1,(()=>{s[l]=null})),ut(),n=s[e],n?n.p(t,r):(n=s[e]=o[e](t),n.c()),ht(n,1),n.m(i.parentNode,i))},i(t){r||(ht(n),r=!0)},o(t){ft(n),r=!1},d(t){s[e].d(t),t&&x(i)}}}function vp(t){let e,n,i,o,s;var a=t[4];function l(t){return{props:{item:t[41],filterText:t[13],getOptionLabel:t[6],isFirst:gp(t[42]),isActive:yp(t[41],t[9],t[10]),isHover:wp(t[2],t[41],t[42],t[1]),isSelectable:$p(t[41])}}}function c(){return t[26](t[42])}function u(){return t[27](t[42])}function h(...e){return t[28](t[41],t[42],...e)}return a&&(n=new a(l(t))),{c(){e=E(\"div\"),n&&wt(n.$$.fragment),I(e,\"class\",\"listItem\")},m(t,r){b(t,e,r),n&&$t(n,e,null),i=!0,o||(s=[k(e,\"mouseover\",c),k(e,\"focus\",u),k(e,\"click\",h)],o=!0)},p(i,r){t=i;const o={};if(1024&r[1]&&(o.item=t[41]),8192&r[0]&&(o.filterText=t[13]),64&r[0]&&(o.getOptionLabel=t[6]),2048&r[1]&&(o.isFirst=gp(t[42])),1536&r[0]|1024&r[1]&&(o.isActive=yp(t[41],t[9],t[10])),6&r[0]|3072&r[1]&&(o.isHover=wp(t[2],t[41],t[42],t[1])),1024&r[1]&&(o.isSelectable=$p(t[41])),a!==(a=t[4])){if(n){ct();const t=n;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}a?(n=new a(l(t)),wt(n.$$.fragment),ht(n.$$.fragment,1),$t(n,e,null)):n=null}else a&&n.$set(o)},i(t){i||(n&&ht(n.$$.fragment,t),i=!0)},o(t){n&&ft(n.$$.fragment,t),i=!1},d(t){t&&x(e),n&&bt(n),o=!1,r(s)}}}function _p(t){let e,n,i,o,s,a;const l=[up,cp],c=[];function u(t,e){return t[5]?0:1}return n=u(t),i=c[n]=l[n](t),{c(){e=E(\"div\"),i.c(),I(e,\"class\",\"listContainer svelte-1uyqfml\"),I(e,\"style\",t[14]),F(e,\"virtualList\",t[5])},m(i,r){b(i,e,r),c[n].m(e,null),t[32](e),o=!0,s||(a=[k(window,\"keydown\",t[17]),k(window,\"resize\",t[18])],s=!0)},p(t,r){let s=n;n=u(t),n===s?c[n].p(t,r):(ct(),ft(c[s],1,1,(()=>{c[s]=null})),ut(),i=c[n],i?i.p(t,r):(i=c[n]=l[n](t),i.c()),ht(i,1),i.m(e,null)),(!o||16384&r[0])&&I(e,\"style\",t[14]),32&r[0]&&F(e,\"virtualList\",t[5])},i(t){o||(ht(i),o=!0)},o(t){ft(i),o=!1},d(i){i&&x(e),c[n].d(),t[32](null),s=!1,r(a)}}}function yp(t,e,n){return e&&e[n]===t[n]}function gp(t){return 0===t}function wp(t,e,n,i){return $p(e)&&(t===n||1===i.length)}function $p(t){return t.isGroupHeader&&t.isSelectable||t.selectable||!t.hasOwnProperty(\"selectable\")}function bp(t,e,n){const i=W();let r,o,{container:s}=e,{VirtualList:a=null}=e,{Item:l=ap}=e,{isVirtualList:c=!1}=e,{items:u=[]}=e,{labelIdentifier:h=\"label\"}=e,{getOptionLabel:f=((t,e)=>{if(t)return t.isCreator?`Create \"${e}\"`:t[h]})}=e,{getGroupHeaderLabel:p=null}=e,{itemHeight:d=40}=e,{hoverItemIndex:m=0}=e,{value:v}=e,{optionIdentifier:_=\"value\"}=e,{hideEmptyState:y=!1}=e,{noOptionsMessage:g=\"No options\"}=e,{isMulti:w=!1}=e,{activeItemIndex:$=0}=e,{filterText:b=\"\"}=e,{parent:x=null}=e,{listPlacement:M=null}=e,{listAutoWidth:E=null}=e,{listOffset:T=5}=e,L=0,C=!1;function S(t){t.isCreator||i(\"itemSelected\",t)}function k(t){C||n(2,m=t)}function I(t){const{item:e,i:r,event:o}=t;if(o.stopPropagation(),v&&!w&&v[_]===e[_])return P();e.isCreator?i(\"itemCreated\",b):$p(e)&&(n(19,$=r),n(2,m=r),S(e))}function P(){i(\"closeList\")}async function A(t){if(c)return;let e=!0;for(;e;)t>0&&m===u.length-1?n(2,m=0):n(2,t<0&&0===m?m=u.length-1:m+=t),e=!$p(u[m]);await tt(),z(\"hover\")}function z(t){if(c||!s)return;let e;const i=s.querySelector(`.listItem .${t}`);i&&(e=s.getBoundingClientRect().bottom-i.getBoundingClientRect().bottom),n(0,s.scrollTop-=e,s)}function O(){const{top:t,height:e,width:i}=x.getBoundingClientRect();n(14,o=\"\"),n(14,o+=`min-width:${i}px;width:${E?\"auto\":\"100%\"};`),\"top\"===M||\"auto\"===M&&function(t){const e=t.getBoundingClientRect(),n={};return n.top=e.top<0,n.left=e.left<0,n.bottom=e.bottom>(window.innerHeight||document.documentElement.clientHeight),n.right=e.right>(window.innerWidth||document.documentElement.clientWidth),n.any=n.top||n.left||n.bottom||n.right,n}(x).bottom?n(14,o+=`bottom:${e+T}px;`):n(14,o+=`top:${e+T}px;`)}B((()=>{if(u.length>0&&!w&&v){const t=u.findIndex((t=>t[_]===v[_]));t&&n(2,m=t)}z(\"active\"),s.addEventListener(\"scroll\",(()=>{clearTimeout(L),L=setTimeout((()=>{C=!1}),100)}),!1)})),N((()=>{u||n(1,u=[]),u!==r&&u.length>0&&n(2,m=0),r=u}));return t.$$set=t=>{\"container\"in t&&n(0,s=t.container),\"VirtualList\"in t&&n(3,a=t.VirtualList),\"Item\"in t&&n(4,l=t.Item),\"isVirtualList\"in t&&n(5,c=t.isVirtualList),\"items\"in t&&n(1,u=t.items),\"labelIdentifier\"in t&&n(20,h=t.labelIdentifier),\"getOptionLabel\"in t&&n(6,f=t.getOptionLabel),\"getGroupHeaderLabel\"in t&&n(7,p=t.getGroupHeaderLabel),\"itemHeight\"in t&&n(8,d=t.itemHeight),\"hoverItemIndex\"in t&&n(2,m=t.hoverItemIndex),\"value\"in t&&n(9,v=t.value),\"optionIdentifier\"in t&&n(10,_=t.optionIdentifier),\"hideEmptyState\"in t&&n(11,y=t.hideEmptyState),\"noOptionsMessage\"in t&&n(12,g=t.noOptionsMessage),\"isMulti\"in t&&n(21,w=t.isMulti),\"activeItemIndex\"in t&&n(19,$=t.activeItemIndex),\"filterText\"in t&&n(13,b=t.filterText),\"parent\"in t&&n(22,x=t.parent),\"listPlacement\"in t&&n(23,M=t.listPlacement),\"listAutoWidth\"in t&&n(24,E=t.listAutoWidth),\"listOffset\"in t&&n(25,T=t.listOffset)},t.$$.update=()=>{4194305&t.$$.dirty[0]&&x&&s&&O()},[s,u,m,a,l,c,f,p,d,v,_,y,g,b,o,k,I,function(t){switch(t.key){case\"Escape\":t.preventDefault(),P();break;case\"ArrowDown\":t.preventDefault(),u.length&&A(1);break;case\"ArrowUp\":t.preventDefault(),u.length&&A(-1);break;case\"Enter\":if(t.preventDefault(),0===u.length)break;const e=u[m];if(v&&!w&&v[_]===e[_]){P();break}e.isCreator?i(\"itemCreated\",b):(n(19,$=m),S(u[m]));break;case\"Tab\":if(t.preventDefault(),0===u.length)return P();if(v&&v[_]===u[m][_])return P();n(19,$=m),S(u[m])}},O,$,h,w,x,M,E,T,t=>k(t),t=>k(t),(t,e,n)=>I({item:t,i:e,event:n}),t=>k(t),t=>k(t),(t,e,n)=>I({item:t,i:e,event:n}),function(t){U[t?\"unshift\":\"push\"]((()=>{s=t,n(0,s)}))}]}class xp extends Mt{constructor(t){super(),xt(this,t,bp,_p,s,{container:0,VirtualList:3,Item:4,isVirtualList:5,items:1,labelIdentifier:20,getOptionLabel:6,getGroupHeaderLabel:7,itemHeight:8,hoverItemIndex:2,value:9,optionIdentifier:10,hideEmptyState:11,noOptionsMessage:12,isMulti:21,activeItemIndex:19,filterText:13,parent:22,listPlacement:23,listAutoWidth:24,listOffset:25},null,[-1,-1])}}function Mp(e){let n,i=e[0](e[1])+\"\";return{c(){n=E(\"div\"),I(n,\"class\",\"selection svelte-pu1q1n\")},m(t,e){b(t,n,e),n.innerHTML=i},p(t,[e]){3&e&&i!==(i=t[0](t[1])+\"\")&&(n.innerHTML=i)},i:t,o:t,d(t){t&&x(n)}}}function Ep(t,e,n){let{getSelectionLabel:i}=e,{item:r}=e;return t.$$set=t=>{\"getSelectionLabel\"in t&&n(0,i=t.getSelectionLabel),\"item\"in t&&n(1,r=t.item)},[i,r]}class Tp extends Mt{constructor(t){super(),xt(this,t,Ep,Mp,s,{getSelectionLabel:0,item:1})}}function Lp(t,e,n){const i=t.slice();return i[9]=e[n],i[11]=n,i}function Cp(t){let e,n,i;function r(...e){return t[6](t[11],...e)}return{c(){e=E(\"div\"),e.innerHTML='<svg width=\"100%\" height=\"100%\" viewBox=\"-2 -2 50 50\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\" class=\"svelte-liu9pa\"><path d=\"M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124 l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z\"></path></svg>',I(e,\"class\",\"multiSelectItem_clear svelte-liu9pa\")},m(t,o){b(t,e,o),n||(i=k(e,\"click\",r),n=!0)},p(e,n){t=e},d(t){t&&x(e),n=!1,i()}}}function Sp(t){let e,n,i,r,o,s,a,l=t[4](t[9])+\"\",c=!t[2]&&!t[3]&&Cp(t);function u(...e){return t[7](t[11],...e)}return{c(){e=E(\"div\"),n=E(\"div\"),i=C(),c&&c.c(),r=C(),I(n,\"class\",\"multiSelectItem_label svelte-liu9pa\"),I(e,\"class\",o=\"multiSelectItem \"+(t[1]===t[11]?\"active\":\"\")+\" \"+(t[2]?\"disabled\":\"\")+\" svelte-liu9pa\")},m(t,o){b(t,e,o),$(e,n),n.innerHTML=l,$(e,i),c&&c.m(e,null),$(e,r),s||(a=k(e,\"click\",u),s=!0)},p(i,s){t=i,17&s&&l!==(l=t[4](t[9])+\"\")&&(n.innerHTML=l),t[2]||t[3]?c&&(c.d(1),c=null):c?c.p(t,s):(c=Cp(t),c.c(),c.m(e,r)),6&s&&o!==(o=\"multiSelectItem \"+(t[1]===t[11]?\"active\":\"\")+\" \"+(t[2]?\"disabled\":\"\")+\" svelte-liu9pa\")&&I(e,\"class\",o)},d(t){t&&x(e),c&&c.d(),s=!1,a()}}}function kp(e){let n,i=e[0],r=[];for(let t=0;t<i.length;t+=1)r[t]=Sp(Lp(e,i,t));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();n=S()},m(t,e){for(let n=0;n<r.length;n+=1)r[n].m(t,e);b(t,n,e)},p(t,[e]){if(63&e){let o;for(i=t[0],o=0;o<i.length;o+=1){const s=Lp(t,i,o);r[o]?r[o].p(s,e):(r[o]=Sp(s),r[o].c(),r[o].m(n.parentNode,n))}for(;o<r.length;o+=1)r[o].d(1);r.length=i.length}},i:t,o:t,d(t){M(r,t),t&&x(n)}}}function Ip(t,e,n){const i=W();let{value:r=[]}=e,{activeValue:o}=e,{isDisabled:s=!1}=e,{multiFullItemClearable:a=!1}=e,{getSelectionLabel:l}=e;function c(t,e){e.stopPropagation(),i(\"multiItemClear\",{i:t})}return t.$$set=t=>{\"value\"in t&&n(0,r=t.value),\"activeValue\"in t&&n(1,o=t.activeValue),\"isDisabled\"in t&&n(2,s=t.isDisabled),\"multiFullItemClearable\"in t&&n(3,a=t.multiFullItemClearable),\"getSelectionLabel\"in t&&n(4,l=t.getSelectionLabel)},[r,o,s,a,l,c,(t,e)=>c(t,e),(t,e)=>a?c(t,e):{}]}class Pp extends Mt{constructor(t){super(),xt(this,t,Ip,kp,s,{value:0,activeValue:1,isDisabled:2,multiFullItemClearable:3,getSelectionLabel:4})}}function Ap(t,e,n){const i=t.slice();return i[23]=e[n],i}const zp=t=>({item:32&t,i:32&t,hoverItemIndex:2&t}),Op=t=>({item:t[23].data,i:t[23].index,hoverItemIndex:t[1]});function Rp(t,e){let n,i,r;const o=e[15].default,s=d(o,e,e[14],Op),a=s||function(t){let e;return{c(){e=L(\"Missing template\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}();return{key:t,first:null,c(){n=E(\"svelte-virtual-list-row\"),a&&a.c(),i=C(),A(n,\"class\",\"svelte-g2cagw\"),this.first=n},m(t,e){b(t,n,e),a&&a.m(n,null),$(n,i),r=!0},p(t,n){e=t,s&&s.p&&(!r||16418&n)&&_(s,o,e,e[14],r?v(o,e[14],n,zp):y(e[14]),Op)},i(t){r||(ht(a,t),r=!0)},o(t){ft(a,t),r=!1},d(t){t&&x(n),a&&a.d(t)}}}function Hp(t){let e,n,i,r,o,s,a=[],l=new Map,c=t[5];const u=t=>t[23].index;for(let e=0;e<c.length;e+=1){let n=Ap(t,c,e),i=u(n);l.set(i,a[e]=Rp(i,n))}return{c(){e=E(\"svelte-virtual-list-viewport\"),n=E(\"svelte-virtual-list-contents\");for(let t=0;t<a.length;t+=1)a[t].c();H(n,\"padding-top\",t[6]+\"px\"),H(n,\"padding-bottom\",t[7]+\"px\"),A(n,\"class\",\"svelte-g2cagw\"),H(e,\"height\",t[0]),A(e,\"class\",\"svelte-g2cagw\"),et((()=>t[18].call(e)))},m(l,c){b(l,e,c),$(e,n);for(let t=0;t<a.length;t+=1)a[t].m(n,null);t[16](n),t[17](e),i=function(t,e){\"static\"===getComputedStyle(t).position&&(t.style.position=\"relative\");const n=E(\"iframe\");n.setAttribute(\"style\",\"display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;\"),n.setAttribute(\"aria-hidden\",\"true\"),n.tabIndex=-1;const i=D();let r;return i?(n.src=\"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\\/script>\",r=k(window,\"message\",(t=>{t.source===n.contentWindow&&e()}))):(n.src=\"about:blank\",n.onload=()=>{r=k(n.contentWindow,\"resize\",e)}),$(t,n),()=>{(i||r&&n.contentWindow)&&r(),x(n)}}(e,t[18].bind(e)),r=!0,o||(s=k(e,\"scroll\",t[8]),o=!0)},p(t,[i]){16418&i&&(c=t[5],ct(),a=vt(a,i,u,1,t,c,l,n,mt,Rp,null,Ap),ut()),(!r||64&i)&&H(n,\"padding-top\",t[6]+\"px\"),(!r||128&i)&&H(n,\"padding-bottom\",t[7]+\"px\"),(!r||1&i)&&H(e,\"height\",t[0])},i(t){if(!r){for(let t=0;t<c.length;t+=1)ht(a[t]);r=!0}},o(t){for(let t=0;t<a.length;t+=1)ft(a[t]);r=!1},d(n){n&&x(e);for(let t=0;t<a.length;t+=1)a[t].d();t[16](null),t[17](null),i(),o=!1,s()}}}function Dp(t,e,n){let i,r,o,s,a,l,{$$slots:c={},$$scope:u}=e,{items:h}=e,{height:f=\"100%\"}=e,{itemHeight:p=40}=e,{hoverItemIndex:d=0}=e,{start:m=0}=e,{end:v=0}=e,_=[],y=0,g=0,w=0;return B((()=>{i=o.getElementsByTagName(\"svelte-virtual-list-row\"),n(13,a=!0)})),t.$$set=t=>{\"items\"in t&&n(11,h=t.items),\"height\"in t&&n(0,f=t.height),\"itemHeight\"in t&&n(12,p=t.itemHeight),\"hoverItemIndex\"in t&&n(1,d=t.hoverItemIndex),\"start\"in t&&n(9,m=t.start),\"end\"in t&&n(10,v=t.end),\"$$scope\"in t&&n(14,u=t.$$scope)},t.$$.update=()=>{3584&t.$$.dirty&&n(5,s=h.slice(m,v).map(((t,e)=>({index:e+m,data:t})))),14340&t.$$.dirty&&a&&async function(t,e,o){const{scrollTop:s}=r;await tt();let a=g-s,c=m;for(;a<e&&c<t.length;){let t=i[c-m];t||(n(10,v=c+1),await tt(),t=i[c-m]),a+=_[c]=o||t.offsetHeight,c+=1}n(10,v=c);const u=t.length-v;l=(g+a)/v,n(7,w=u*l),_.length=t.length,r&&n(3,r.scrollTop=0,r)}(h,y,p)},[f,d,y,r,o,s,g,w,async function(){const{scrollTop:t}=r,e=m;for(let t=0;t<i.length;t+=1)_[m+t]=p||i[t].offsetHeight;let o=0,s=0;for(;o<h.length;){const e=_[o]||l;if(s+e>t){n(9,m=o),n(6,g=s);break}s+=e,o+=1}for(;o<h.length&&(s+=_[o]||l,o+=1,!(s>t+y)););n(10,v=o);const a=h.length-v;for(l=s/v;o<h.length;)_[o++]=l;if(n(7,w=a*l),m<e){await tt();let n=0,o=0;for(let t=m;t<e;t+=1)i[t-m]&&(n+=_[t],o+=p||i[t-m].offsetHeight);const s=o-n;r.scrollTo(0,t+s)}},m,v,h,p,a,u,c,function(t){U[t?\"unshift\":\"push\"]((()=>{o=t,n(4,o)}))},function(t){U[t?\"unshift\":\"push\"]((()=>{r=t,n(3,r)}))},function(){y=this.offsetHeight,n(2,y)}]}class Fp extends Mt{constructor(t){super(),xt(this,t,Dp,Hp,s,{items:11,height:0,itemHeight:12,hoverItemIndex:1,start:9,end:10})}}function qp(e){let n,i;return{c(){n=T(\"svg\"),i=T(\"path\"),I(i,\"fill\",\"currentColor\"),I(i,\"d\",\"M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124\\n    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z\"),I(n,\"width\",\"100%\"),I(n,\"height\",\"100%\"),I(n,\"viewBox\",\"-2 -2 50 50\"),I(n,\"focusable\",\"false\"),I(n,\"aria-hidden\",\"true\"),I(n,\"role\",\"presentation\")},m(t,e){b(t,n,e),$(n,i)},p:t,i:t,o:t,d(t){t&&x(n)}}}class jp extends Mt{constructor(t){super(),xt(this,t,null,qp,s,{})}}function Vp(t,e,n){const i=t.slice();return i[103]=e[n],i}function Np(t){let e,n,i,r,o;return{c(){e=E(\"span\"),n=L(t[33]),i=C(),r=E(\"span\"),o=L(t[32]),I(e,\"id\",\"aria-selection\"),I(r,\"id\",\"aria-context\")},m(t,s){b(t,e,s),$(e,n),b(t,i,s),b(t,r,s),$(r,o)},p(t,e){4&e[1]&&O(n,t[33]),2&e[1]&&O(o,t[32])},d(t){t&&x(e),t&&x(i),t&&x(r)}}}function Bp(t){let n,i,r;const o=[t[18]];var s=t[17];function a(t){let n={};for(let t=0;t<o.length;t+=1)n=e(n,o[t]);return{props:n}}return s&&(n=new s(a())),{c(){n&&wt(n.$$.fragment),i=S()},m(t,e){n&&$t(n,t,e),b(t,i,e),r=!0},p(t,e){const r=262144&e[0]?_t(o,[yt(t[18])]):{};if(s!==(s=t[17])){if(n){ct();const t=n;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}s?(n=new s(a()),wt(n.$$.fragment),ht(n.$$.fragment,1),$t(n,i.parentNode,i)):n=null}else s&&n.$set(r)},i(t){r||(n&&ht(n.$$.fragment,t),r=!0)},o(t){n&&ft(n.$$.fragment,t),r=!1},d(t){t&&x(i),n&&bt(n,t)}}}function Xp(t){let e,n,i;var r=t[26];function o(t){return{props:{value:t[2],getSelectionLabel:t[12],activeValue:t[30],isDisabled:t[9],multiFullItemClearable:t[8]}}}return r&&(e=new r(o(t)),e.$on(\"multiItemClear\",t[38]),e.$on(\"focus\",t[40])),{c(){e&&wt(e.$$.fragment),n=S()},m(t,r){e&&$t(e,t,r),b(t,n,r),i=!0},p(t,i){const s={};if(4&i[0]&&(s.value=t[2]),4096&i[0]&&(s.getSelectionLabel=t[12]),1073741824&i[0]&&(s.activeValue=t[30]),512&i[0]&&(s.isDisabled=t[9]),256&i[0]&&(s.multiFullItemClearable=t[8]),r!==(r=t[26])){if(e){ct();const t=e;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}r?(e=new r(o(t)),e.$on(\"multiItemClear\",t[38]),e.$on(\"focus\",t[40]),wt(e.$$.fragment),ht(e.$$.fragment,1),$t(e,n.parentNode,n)):e=null}else r&&e.$set(s)},i(t){i||(e&&ht(e.$$.fragment,t),i=!0)},o(t){e&&ft(e.$$.fragment,t),i=!1},d(t){t&&x(n),e&&bt(e,t)}}}function Wp(t){let e,n,i,r,o;var s=t[25];function a(t){return{props:{item:t[2],getSelectionLabel:t[12]}}}return s&&(n=new s(a(t))),{c(){e=E(\"div\"),n&&wt(n.$$.fragment),I(e,\"class\",\"selectedItem svelte-17l1npl\")},m(s,a){b(s,e,a),n&&$t(n,e,null),i=!0,r||(o=k(e,\"focus\",t[40]),r=!0)},p(t,i){const r={};if(4&i[0]&&(r.item=t[2]),4096&i[0]&&(r.getSelectionLabel=t[12]),s!==(s=t[25])){if(n){ct();const t=n;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}s?(n=new s(a(t)),wt(n.$$.fragment),ht(n.$$.fragment,1),$t(n,e,null)):n=null}else s&&n.$set(r)},i(t){i||(n&&ht(n.$$.fragment,t),i=!0)},o(t){n&&ft(n.$$.fragment,t),i=!1},d(t){t&&x(e),n&&bt(n),r=!1,o()}}}function Yp(t){let e,n,i,r,o;var s=t[23];return s&&(n=new s({})),{c(){e=E(\"div\"),n&&wt(n.$$.fragment),I(e,\"class\",\"clearSelect svelte-17l1npl\"),I(e,\"aria-hidden\",\"true\")},m(s,a){var l;b(s,e,a),n&&$t(n,e,null),i=!0,r||(o=k(e,\"click\",(l=t[27],function(t){return t.preventDefault(),l.call(this,t)})),r=!0)},p(t,i){if(s!==(s=t[23])){if(n){ct();const t=n;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}s?(n=new s({}),wt(n.$$.fragment),ht(n.$$.fragment,1),$t(n,e,null)):n=null}},i(t){i||(n&&ht(n.$$.fragment,t),i=!0)},o(t){n&&ft(n.$$.fragment,t),i=!1},d(t){t&&x(e),n&&bt(n),r=!1,o()}}}function Up(t){let e;function n(t,e){return t[22]?Kp:Gp}let i=n(t),r=i(t);return{c(){e=E(\"div\"),r.c(),I(e,\"class\",\"indicator svelte-17l1npl\"),I(e,\"aria-hidden\",\"true\")},m(t,n){b(t,e,n),r.m(e,null)},p(t,o){i===(i=n(t))&&r?r.p(t,o):(r.d(1),r=i(t),r&&(r.c(),r.m(e,null)))},d(t){t&&x(e),r.d()}}}function Gp(e){let n,i;return{c(){n=T(\"svg\"),i=T(\"path\"),I(i,\"d\",\"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747\\n          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0\\n          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502\\n          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0\\n          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z\"),I(n,\"width\",\"100%\"),I(n,\"height\",\"100%\"),I(n,\"viewBox\",\"0 0 20 20\"),I(n,\"focusable\",\"false\"),I(n,\"aria-hidden\",\"true\"),I(n,\"class\",\"svelte-17l1npl\")},m(t,e){b(t,n,e),$(n,i)},p:t,d(t){t&&x(n)}}}function Kp(t){let e,n;return{c(){e=new q,n=S(),e.a=n},m(i,r){e.m(t[22],i,r),b(i,n,r)},p(t,n){4194304&n[0]&&e.p(t[22])},d(t){t&&x(n),t&&e.d()}}}function Zp(t){let e;return{c(){e=E(\"div\"),e.innerHTML='<svg class=\"spinner_icon svelte-17l1npl\" viewBox=\"25 25 50 50\"><circle class=\"spinner_path svelte-17l1npl\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"5\" stroke-miterlimit=\"10\"></circle></svg>',I(e,\"class\",\"spinner svelte-17l1npl\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function Qp(t){let n,i,r,o;const s=[t[34]];function a(e){t[84](e)}var l=t[24];function c(t){let n={};for(let t=0;t<s.length;t+=1)n=e(n,s[t]);return void 0!==t[28]&&(n.hoverItemIndex=t[28]),{props:n}}return l&&(n=new l(c(t)),U.push((()=>gt(n,\"hoverItemIndex\",a))),n.$on(\"itemSelected\",t[43]),n.$on(\"itemCreated\",t[44]),n.$on(\"closeList\",t[45])),{c(){n&&wt(n.$$.fragment),r=S()},m(t,e){n&&$t(n,t,e),b(t,r,e),o=!0},p(t,e){const o=8&e[1]?_t(s,[yt(t[34])]):{};if(!i&&268435456&e[0]&&(i=!0,o.hoverItemIndex=t[28],nt((()=>i=!1))),l!==(l=t[24])){if(n){ct();const t=n;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}l?(n=new l(c(t)),U.push((()=>gt(n,\"hoverItemIndex\",a))),n.$on(\"itemSelected\",t[43]),n.$on(\"itemCreated\",t[44]),n.$on(\"closeList\",t[45]),wt(n.$$.fragment),ht(n.$$.fragment,1),$t(n,r.parentNode,r)):n=null}else l&&n.$set(o)},i(t){o||(n&&ht(n.$$.fragment,t),o=!0)},o(t){n&&ft(n.$$.fragment,t),o=!1},d(t){t&&x(r),n&&bt(n,t)}}}function Jp(t){let e,n,i;return{c(){e=E(\"input\"),I(e,\"name\",n=t[16].name),I(e,\"type\",\"hidden\"),e.value=i=t[2]?t[12](t[2]):null,I(e,\"class\",\"svelte-17l1npl\")},m(t,n){b(t,e,n)},p(t,r){65536&r[0]&&n!==(n=t[16].name)&&I(e,\"name\",n),4100&r[0]&&i!==(i=t[2]?t[12](t[2]):null)&&(e.value=i)},d(t){t&&x(e)}}}function td(t){let e,n=t[2],i=[];for(let e=0;e<n.length;e+=1)i[e]=ed(Vp(t,n,e));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=S()},m(t,n){for(let e=0;e<i.length;e+=1)i[e].m(t,n);b(t,e,n)},p(t,r){if(69636&r[0]){let o;for(n=t[2],o=0;o<n.length;o+=1){const s=Vp(t,n,o);i[o]?i[o].p(s,r):(i[o]=ed(s),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(t){M(i,t),t&&x(e)}}}function ed(t){let e,n,i;return{c(){e=E(\"input\"),I(e,\"name\",n=t[16].name),I(e,\"type\",\"hidden\"),e.value=i=t[103]?t[12](t[103]):null,I(e,\"class\",\"svelte-17l1npl\")},m(t,n){b(t,e,n)},p(t,r){65536&r[0]&&n!==(n=t[16].name)&&I(e,\"name\",n),4100&r[0]&&i!==(i=t[103]?t[12](t[103]):null)&&(e.value=i)},d(t){t&&x(e)}}}function nd(t){let n,i,o,s,a,l,c,u,h,f,p,d,m,v,_,y,g,w,M=t[1]&&Np(t),T=t[17]&&Bp(t),L=t[35]&&Xp(t),S=[{readOnly:c=!t[13]},t[31],{placeholder:t[36]},{style:t[14]},{disabled:t[9]}],A={};for(let t=0;t<S.length;t+=1)A=e(A,S[t]);let z=!t[7]&&t[29]&&Wp(t),O=t[37]&&Yp(t),H=!t[37]&&(t[20]||t[19]&&!t[2]||!t[13]&&!t[9]&&!t[4]&&(t[29]&&!t[15]||!t[29]))&&Up(t),D=t[4]&&Zp(),q=t[5]&&Qp(t),j=(!t[7]||t[7]&&!t[35])&&Jp(t),V=t[7]&&t[35]&&td(t);return{c(){n=E(\"div\"),i=E(\"span\"),M&&M.c(),o=C(),T&&T.c(),s=C(),L&&L.c(),a=C(),l=E(\"input\"),u=C(),z&&z.c(),h=C(),O&&O.c(),f=C(),H&&H.c(),p=C(),D&&D.c(),d=C(),q&&q.c(),m=C(),j&&j.c(),v=C(),V&&V.c(),I(i,\"aria-live\",\"polite\"),I(i,\"aria-atomic\",\"false\"),I(i,\"aria-relevant\",\"additions text\"),I(i,\"class\",\"a11yText svelte-17l1npl\"),P(l,A),F(l,\"svelte-17l1npl\",!0),I(n,\"class\",_=\"selectContainer \"+t[21]+\" svelte-17l1npl\"),I(n,\"style\",t[11]),F(n,\"hasError\",t[10]),F(n,\"multiSelect\",t[7]),F(n,\"disabled\",t[9]),F(n,\"focused\",t[1])},m(e,r){b(e,n,r),$(n,i),M&&M.m(i,null),$(n,o),T&&T.m(n,null),$(n,s),L&&L.m(n,null),$(n,a),$(n,l),l.autofocus&&l.focus(),t[82](l),R(l,t[3]),$(n,u),z&&z.m(n,null),$(n,h),O&&O.m(n,null),$(n,f),H&&H.m(n,null),$(n,p),D&&D.m(n,null),$(n,d),q&&q.m(n,null),$(n,m),j&&j.m(n,null),$(n,v),V&&V.m(n,null),t[85](n),y=!0,g||(w=[k(window,\"click\",t[41]),k(window,\"focusin\",t[41]),k(window,\"keydown\",t[39]),k(l,\"focus\",t[40]),k(l,\"input\",t[83]),k(n,\"click\",t[42])],g=!0)},p(t,e){t[1]?M?M.p(t,e):(M=Np(t),M.c(),M.m(i,null)):M&&(M.d(1),M=null),t[17]?T?(T.p(t,e),131072&e[0]&&ht(T,1)):(T=Bp(t),T.c(),ht(T,1),T.m(n,s)):T&&(ct(),ft(T,1,1,(()=>{T=null})),ut()),t[35]?L?(L.p(t,e),16&e[1]&&ht(L,1)):(L=Xp(t),L.c(),ht(L,1),L.m(n,a)):L&&(ct(),ft(L,1,1,(()=>{L=null})),ut()),P(l,A=_t(S,[(!y||8192&e[0]&&c!==(c=!t[13]))&&{readOnly:c},1&e[1]&&t[31],(!y||32&e[1])&&{placeholder:t[36]},(!y||16384&e[0])&&{style:t[14]},(!y||512&e[0])&&{disabled:t[9]}])),8&e[0]&&l.value!==t[3]&&R(l,t[3]),F(l,\"svelte-17l1npl\",!0),!t[7]&&t[29]?z?(z.p(t,e),536871040&e[0]&&ht(z,1)):(z=Wp(t),z.c(),ht(z,1),z.m(n,h)):z&&(ct(),ft(z,1,1,(()=>{z=null})),ut()),t[37]?O?(O.p(t,e),64&e[1]&&ht(O,1)):(O=Yp(t),O.c(),ht(O,1),O.m(n,f)):O&&(ct(),ft(O,1,1,(()=>{O=null})),ut()),t[37]||!(t[20]||t[19]&&!t[2])&&(t[13]||t[9]||t[4]||(!t[29]||t[15])&&t[29])?H&&(H.d(1),H=null):H?H.p(t,e):(H=Up(t),H.c(),H.m(n,p)),t[4]?D||(D=Zp(),D.c(),D.m(n,d)):D&&(D.d(1),D=null),t[5]?q?(q.p(t,e),32&e[0]&&ht(q,1)):(q=Qp(t),q.c(),ht(q,1),q.m(n,m)):q&&(ct(),ft(q,1,1,(()=>{q=null})),ut()),!t[7]||t[7]&&!t[35]?j?j.p(t,e):(j=Jp(t),j.c(),j.m(n,v)):j&&(j.d(1),j=null),t[7]&&t[35]?V?V.p(t,e):(V=td(t),V.c(),V.m(n,null)):V&&(V.d(1),V=null),(!y||2097152&e[0]&&_!==(_=\"selectContainer \"+t[21]+\" svelte-17l1npl\"))&&I(n,\"class\",_),(!y||2048&e[0])&&I(n,\"style\",t[11]),2098176&e[0]&&F(n,\"hasError\",t[10]),2097280&e[0]&&F(n,\"multiSelect\",t[7]),2097664&e[0]&&F(n,\"disabled\",t[9]),2097154&e[0]&&F(n,\"focused\",t[1])},i(t){y||(ht(T),ht(L),ht(z),ht(O),ht(q),y=!0)},o(t){ft(T),ft(L),ft(z),ft(O),ft(q),y=!1},d(e){e&&x(n),M&&M.d(),T&&T.d(),L&&L.d(),t[82](null),z&&z.d(),O&&O.d(),H&&H.d(),D&&D.d(),q&&q.d(),j&&j.d(),V&&V.d(),t[85](null),g=!1,r(w)}}}function id(t){return t.map(((t,e)=>({index:e,value:t,label:`${t}`})))}function rd(t,e,n){let i,r,o,s,a,l,c,u;const h=W();let{id:f=null}=e,{container:p}=e,{input:d}=e,{isMulti:m=!1}=e,{multiFullItemClearable:v=!1}=e,{isDisabled:_=!1}=e,{isCreatable:y=!1}=e,{isFocused:g=!1}=e,{value:w=null}=e,{filterText:$=\"\"}=e,{placeholder:b=\"Select...\"}=e,{placeholderAlwaysShow:x=!1}=e,{items:M=null}=e,{itemFilter:E=((t,e,n)=>`${t}`.toLowerCase().includes(e.toLowerCase()))}=e,{groupBy:T}=e,{groupFilter:L=(t=>t)}=e,{isGroupHeaderSelectable:C=!1}=e,{getGroupHeaderLabel:S=(t=>t[k]||t.id)}=e,{labelIdentifier:k=\"label\"}=e,{getOptionLabel:I=((t,e)=>t.isCreator?`Create \"${e}\"`:t[k])}=e,{optionIdentifier:P=\"value\"}=e,{loadOptions:A}=e,{hasError:z=!1}=e,{containerStyles:O=\"\"}=e,{getSelectionLabel:R=(t=>t?t[k]:null)}=e,{createGroupHeaderItem:H=(t=>({value:t,label:t}))}=e,{createItem:D=(t=>({value:t,label:t}))}=e;let{isSearchable:F=!0}=e,{inputStyles:q=\"\"}=e,{isClearable:j=!0}=e,{isWaiting:V=!1}=e,{listPlacement:X=\"auto\"}=e,{listOpen:Y=!1}=e,{isVirtualList:G=!1}=e,{loadOptionsInterval:K=300}=e,{noOptionsMessage:Z=\"No options\"}=e,{hideEmptyState:Q=!1}=e,{inputAttributes:J={}}=e,{listAutoWidth:tt=!0}=e,{itemHeight:et=40}=e,{Icon:nt}=e,{iconProps:it={}}=e,{showChevron:rt=!1}=e,{showIndicator:ot=!1}=e,{containerClasses:st=\"\"}=e,{indicatorSvg:at}=e,{listOffset:lt=5}=e,{ClearIcon:ct=jp}=e,{Item:ut=ap}=e,{List:ht=xp}=e,{Selection:ft=Tp}=e,{MultiSelection:pt=Pp}=e,{VirtualList:dt=Fp}=e;function mt(t){if(t.loadOptions&&t.filterText.length>0)return;if(!t.items)return[];t.items&&t.items.length>0&&\"object\"!=typeof t.items[0]&&(t.items=id(t.items));let e=t.items.filter((e=>{let n=E(I(e,t.filterText),t.filterText,e);return n&&t.isMulti&&t.value&&Array.isArray(t.value)&&(n=!t.value.some((n=>n[t.optionIdentifier]===e[t.optionIdentifier]))),n}));return t.groupBy&&(e=function(t){const e=[],n={};t.forEach((t=>{const i=T(t);e.includes(i)||(e.push(i),n[i]=[],i&&n[i].push(Object.assign(H(i,t),{id:i,isGroupHeader:!0,isSelectable:C}))),n[i].push(Object.assign({isGroupItem:!!i},t))}));const i=[];return L(e).forEach((t=>{i.push(...n[t])})),i}(e)),t.isCreatable&&(e=vt(e,t.filterText)),e}function vt(t,e){if(0===e.length)return t;const n=D(e);return t[0]&&e===t[0][k]?t:(n.isCreator=!0,[...t,n])}let _t,yt,gt,wt,$t,bt,{selectedValue:xt=null}=e;const Mt=function(t,e,n){let i;return function(){let r=this,o=arguments,s=function(){i=null,n||t.apply(r,o)},a=n&&!i;clearTimeout(i),i=setTimeout(s,e),a&&t.apply(r,o)}}((async()=>{n(4,V=!0);let t=await A($).catch((t=>{console.warn(\"svelte-select loadOptions error :>> \",t),h(\"error\",{type:\"loadOptions\",details:t})}));t&&!t.cancelled&&(t?(t&&t.length>0&&\"object\"!=typeof t[0]&&(t=id(t)),n(81,i=[...t]),h(\"loaded\",{items:i})):n(81,i=[]),y&&n(81,i=vt(i,$)),n(4,V=!1),n(1,g=!0),n(5,Y=!0))}),K);let Et;function Tt(){let t=!0;if(w){const e=[],i=[];w.forEach((n=>{e.includes(n[P])?t=!1:(e.push(n[P]),i.push(n))})),t||n(2,w=i)}return t}function Lt(t){let e=t?t[P]:w[P];return M.find((t=>t[P]===e))}function Ct(t){const{detail:e}=t,i=w[e?e.i:w.length-1];1===w.length?n(2,w=void 0):n(2,w=w.filter((t=>t!==i))),h(\"clear\",i)}function St(){n(1,g=!0),d&&d.focus()}N((async()=>{n(77,yt=w),n(78,gt=$),n(79,wt=g),n(80,$t=m)})),B((()=>{g&&d&&d.focus()}));let{ariaValues:kt=(t=>`Option ${t}, selected.`)}=e,{ariaListOpen:It=((t,e)=>`You are currently focused on option ${t}. There are ${e} results available.`)}=e,{ariaFocused:Pt=(()=>\"Select is focused, type to refine list, press down to open the menu.\")}=e;return t.$$set=t=>{\"id\"in t&&n(46,f=t.id),\"container\"in t&&n(0,p=t.container),\"input\"in t&&n(6,d=t.input),\"isMulti\"in t&&n(7,m=t.isMulti),\"multiFullItemClearable\"in t&&n(8,v=t.multiFullItemClearable),\"isDisabled\"in t&&n(9,_=t.isDisabled),\"isCreatable\"in t&&n(47,y=t.isCreatable),\"isFocused\"in t&&n(1,g=t.isFocused),\"value\"in t&&n(2,w=t.value),\"filterText\"in t&&n(3,$=t.filterText),\"placeholder\"in t&&n(48,b=t.placeholder),\"placeholderAlwaysShow\"in t&&n(49,x=t.placeholderAlwaysShow),\"items\"in t&&n(50,M=t.items),\"itemFilter\"in t&&n(51,E=t.itemFilter),\"groupBy\"in t&&n(52,T=t.groupBy),\"groupFilter\"in t&&n(53,L=t.groupFilter),\"isGroupHeaderSelectable\"in t&&n(54,C=t.isGroupHeaderSelectable),\"getGroupHeaderLabel\"in t&&n(55,S=t.getGroupHeaderLabel),\"labelIdentifier\"in t&&n(56,k=t.labelIdentifier),\"getOptionLabel\"in t&&n(57,I=t.getOptionLabel),\"optionIdentifier\"in t&&n(58,P=t.optionIdentifier),\"loadOptions\"in t&&n(59,A=t.loadOptions),\"hasError\"in t&&n(10,z=t.hasError),\"containerStyles\"in t&&n(11,O=t.containerStyles),\"getSelectionLabel\"in t&&n(12,R=t.getSelectionLabel),\"createGroupHeaderItem\"in t&&n(60,H=t.createGroupHeaderItem),\"createItem\"in t&&n(61,D=t.createItem),\"isSearchable\"in t&&n(13,F=t.isSearchable),\"inputStyles\"in t&&n(14,q=t.inputStyles),\"isClearable\"in t&&n(15,j=t.isClearable),\"isWaiting\"in t&&n(4,V=t.isWaiting),\"listPlacement\"in t&&n(63,X=t.listPlacement),\"listOpen\"in t&&n(5,Y=t.listOpen),\"isVirtualList\"in t&&n(64,G=t.isVirtualList),\"loadOptionsInterval\"in t&&n(65,K=t.loadOptionsInterval),\"noOptionsMessage\"in t&&n(66,Z=t.noOptionsMessage),\"hideEmptyState\"in t&&n(67,Q=t.hideEmptyState),\"inputAttributes\"in t&&n(16,J=t.inputAttributes),\"listAutoWidth\"in t&&n(68,tt=t.listAutoWidth),\"itemHeight\"in t&&n(69,et=t.itemHeight),\"Icon\"in t&&n(17,nt=t.Icon),\"iconProps\"in t&&n(18,it=t.iconProps),\"showChevron\"in t&&n(19,rt=t.showChevron),\"showIndicator\"in t&&n(20,ot=t.showIndicator),\"containerClasses\"in t&&n(21,st=t.containerClasses),\"indicatorSvg\"in t&&n(22,at=t.indicatorSvg),\"listOffset\"in t&&n(70,lt=t.listOffset),\"ClearIcon\"in t&&n(23,ct=t.ClearIcon),\"Item\"in t&&n(71,ut=t.Item),\"List\"in t&&n(24,ht=t.List),\"Selection\"in t&&n(25,ft=t.Selection),\"MultiSelection\"in t&&n(26,pt=t.MultiSelection),\"VirtualList\"in t&&n(72,dt=t.VirtualList),\"selectedValue\"in t&&n(73,xt=t.selectedValue),\"ariaValues\"in t&&n(74,kt=t.ariaValues),\"ariaListOpen\"in t&&n(75,It=t.ariaListOpen),\"ariaFocused\"in t&&n(76,Pt=t.ariaFocused)},t.$$.update=()=>{140&t.$$.dirty[0]|405340160&t.$$.dirty[1]&&n(81,i=mt({loadOptions:A,filterText:$,items:M,value:w,isMulti:m,optionIdentifier:P,groupBy:T,isCreatable:y})),2048&t.$$.dirty[2]&&xt&&console.warn(\"selectedValue is no longer used. Please use value instead.\"),524288&t.$$.dirty[1]&&function(t){t&&0!==t.length&&!t.some((t=>\"object\"!=typeof t))&&w&&(m?!w.some((t=>!t||!t[P])):w[P])&&(Array.isArray(w)?n(2,w=w.map((t=>Lt(t)||t))):n(2,w=Lt()||w))}(M),4&t.$$.dirty[0]&&w&&(\"string\"==typeof w?n(2,w={[P]:w,label:w}):m&&Array.isArray(w)&&w.length>0&&n(2,w=w.map((t=>\"string\"==typeof t?{value:t,label:t}:t)))),73728&t.$$.dirty[0]&&(!J&&F||(n(31,Et=Object.assign({autocapitalize:\"none\",autocomplete:\"off\",autocorrect:\"off\",spellcheck:!1,tabindex:0,type:\"text\",\"aria-autocomplete\":\"list\"},J)),f&&n(31,Et.id=f,Et),F||n(31,Et.readonly=!0,Et))),128&t.$$.dirty[0]|262144&t.$$.dirty[2]&&(m&&w&&(Array.isArray(w)?n(2,w=[...w]):n(2,w=[w])),$t&&!m&&w&&n(2,w=null)),132&t.$$.dirty[0]&&m&&w&&w.length>1&&Tt(),4&t.$$.dirty[0]&&w&&(m?JSON.stringify(w)!==JSON.stringify(yt)&&Tt()&&h(\"select\",w):yt&&JSON.stringify(w[P])===JSON.stringify(yt[P])||h(\"select\",w)),132&t.$$.dirty[0]|32768&t.$$.dirty[2]&&!w&&m&&yt&&h(\"select\",w),2&t.$$.dirty[0]|131072&t.$$.dirty[2]&&g!==wt&&(g||Y?St():d&&d.blur()),8&t.$$.dirty[0]|65536&t.$$.dirty[2]&&$!==gt&&0!==$.length&&(n(1,g=!0),n(5,Y=!0),A?Mt():(n(5,Y=!0),m&&n(30,_t=void 0))),12&t.$$.dirty[0]&&n(29,r=w&&0===$.length),536904208&t.$$.dirty[0]&&n(37,o=r&&j&&!_&&!V),132&t.$$.dirty[0]|393216&t.$$.dirty[1]&&n(36,s=x&&m?b:w?\"\":b),132&t.$$.dirty[0]&&n(35,a=m&&w&&w.length>0),141&t.$$.dirty[0]|218103808&t.$$.dirty[1]|526326&t.$$.dirty[2]&&n(34,l={Item:ut,filterText:$,optionIdentifier:P,noOptionsMessage:Z,hideEmptyState:Q,isVirtualList:G,VirtualList:dt,value:w,isMulti:m,getGroupHeaderLabel:S,items:i,itemHeight:et,getOptionLabel:I,listPlacement:X,parent:p,listAutoWidth:tt,listOffset:lt}),132&t.$$.dirty[0]&&n(33,c=w?function(){let t;return t=m&&w.length>0?w.map((t=>R(t))).join(\", \"):R(w),kt(t)}():\"\"),268435490&t.$$.dirty[0]|524288&t.$$.dirty[2]&&n(32,u=function(){if(!g||!i||0===i.length)return\"\";let t=i[bt];if(Y&&t){let e=R(t),n=i?i.length:0;return It(e,n)}return Pt()}())},[p,g,w,$,V,Y,d,m,v,_,z,O,R,F,q,j,J,nt,it,rt,ot,st,at,ct,ht,ft,pt,function(){n(2,w=void 0),n(5,Y=!1),h(\"clear\",w),St()},bt,r,_t,Et,u,c,l,a,s,o,Ct,function(t){if(g)switch(t.key){case\"ArrowDown\":case\"ArrowUp\":t.preventDefault(),n(5,Y=!0),n(30,_t=void 0);break;case\"Tab\":Y||n(1,g=!1);break;case\"Backspace\":if(!m||$.length>0)return;if(m&&w&&w.length>0){if(Ct(void 0!==_t?_t:w.length-1),0===_t||void 0===_t)break;n(30,_t=w.length>_t?_t-1:void 0)}break;case\"ArrowLeft\":if(!m||$.length>0)return;void 0===_t?n(30,_t=w.length-1):w.length>_t&&0!==_t&&n(30,_t-=1);break;case\"ArrowRight\":if(!m||$.length>0||void 0===_t)return;_t===w.length-1?n(30,_t=void 0):_t<w.length-1&&n(30,_t+=1)}},St,function(t){if(!p)return;const e=t.path&&t.path.length>0?t.path[0]:t.target;p.contains(e)||(n(1,g=!1),n(5,Y=!1),n(30,_t=void 0),d&&d.blur())},function(){_||(n(1,g=!0),n(5,Y=!Y))},function(t){const{detail:e}=t;if(e){n(3,$=\"\");const t=Object.assign({},e);t.isGroupHeader&&!t.isSelectable||(n(2,w=m?w?w.concat([t]):[t]:t),n(2,w),setTimeout((()=>{n(5,Y=!1),n(30,_t=void 0)})))}},function(t){const{detail:e}=t;m?(n(2,w=w||[]),n(2,w=[...w,D(e)])):n(2,w=D(e)),h(\"itemCreated\",e),n(3,$=\"\"),n(5,Y=!1),n(30,_t=void 0)},function(){n(3,$=\"\"),n(5,Y=!1)},f,y,b,x,M,E,T,L,C,S,k,I,P,A,H,D,()=>i,X,G,K,Z,Q,tt,et,lt,ut,dt,xt,kt,It,Pt,yt,gt,wt,$t,i,function(t){U[t?\"unshift\":\"push\"]((()=>{d=t,n(6,d)}))},function(){$=this.value,n(3,$)},function(t){bt=t,n(28,bt)},function(t){U[t?\"unshift\":\"push\"]((()=>{p=t,n(0,p)}))}]}class od extends Mt{constructor(t){super(),xt(this,t,rd,nd,s,{id:46,container:0,input:6,isMulti:7,multiFullItemClearable:8,isDisabled:9,isCreatable:47,isFocused:1,value:2,filterText:3,placeholder:48,placeholderAlwaysShow:49,items:50,itemFilter:51,groupBy:52,groupFilter:53,isGroupHeaderSelectable:54,getGroupHeaderLabel:55,labelIdentifier:56,getOptionLabel:57,optionIdentifier:58,loadOptions:59,hasError:10,containerStyles:11,getSelectionLabel:12,createGroupHeaderItem:60,createItem:61,getFilteredItems:62,isSearchable:13,inputStyles:14,isClearable:15,isWaiting:4,listPlacement:63,listOpen:5,isVirtualList:64,loadOptionsInterval:65,noOptionsMessage:66,hideEmptyState:67,inputAttributes:16,listAutoWidth:68,itemHeight:69,Icon:17,iconProps:18,showChevron:19,showIndicator:20,containerClasses:21,indicatorSvg:22,listOffset:70,ClearIcon:23,Item:71,List:24,Selection:25,MultiSelection:26,VirtualList:72,selectedValue:73,handleClear:27,ariaValues:74,ariaListOpen:75,ariaFocused:76},null,[-1,-1,-1,-1])}get getFilteredItems(){return this.$$.ctx[62]}get handleClear(){return this.$$.ctx[27]}}function sd(t){let e,n,i,r,o,s;const a=t[5].default,l=d(a,t,t[4],null);function c(e){t[6](e)}let u={items:t[0],isCreatable:!0};return void 0!==t[1]&&(u.value=t[1]),r=new od({props:u}),U.push((()=>gt(r,\"value\",c))),{c(){e=E(\"div\"),l&&l.c(),n=C(),i=E(\"div\"),wt(r.$$.fragment),I(i,\"class\",\"select-container svelte-q0fna\"),I(e,\"class\",\"svelte-q0fna\")},m(t,o){b(t,e,o),l&&l.m(e,null),$(e,n),$(e,i),$t(r,i,null),s=!0},p(t,[e]){l&&l.p&&(!s||16&e)&&_(l,a,t,t[4],s?v(a,t[4],e,null):y(t[4]),null);const n={};1&e&&(n.items=t[0]),!o&&2&e&&(o=!0,n.value=t[1],nt((()=>o=!1))),r.$set(n)},i(t){s||(ht(l,t),ht(r.$$.fragment,t),s=!0)},o(t){ft(l,t),ft(r.$$.fragment,t),s=!1},d(t){t&&x(e),l&&l.d(t),bt(r)}}}function ad(t,e,n){let{$$slots:i={},$$scope:r}=e;var o;let{items:s}=e,{value:a}=e,l=s.find((t=>t.value==a));return t.$$set=t=>{\"items\"in t&&n(0,s=t.items),\"value\"in t&&n(2,a=t.value),\"$$scope\"in t&&n(4,r=t.$$scope)},t.$$.update=()=>{10&t.$$.dirty&&n(2,a=null!==n(3,o=null==l?void 0:l.value)&&void 0!==o?o:null)},[s,l,a,o,r,i,function(t){l=t,n(1,l)}]}class ld extends Mt{constructor(t){super(),xt(this,t,ad,sd,s,{items:0,value:2})}}function cd(t){let e,n,i,r,o,s;const a=t[2].default,l=d(a,t,t[1],null);return{c(){e=E(\"div\"),l&&l.c(),n=C(),i=E(\"input\"),I(i,\"type\",\"text\"),I(i,\"class\",\"svelte-uhbt6z\"),I(e,\"class\",\"svelte-uhbt6z\")},m(a,c){b(a,e,c),l&&l.m(e,null),$(e,n),$(e,i),R(i,t[0]),r=!0,o||(s=k(i,\"input\",t[3]),o=!0)},p(t,[e]){l&&l.p&&(!r||2&e)&&_(l,a,t,t[1],r?v(a,t[1],e,null):y(t[1]),null),1&e&&i.value!==t[0]&&R(i,t[0])},i(t){r||(ht(l,t),r=!0)},o(t){ft(l,t),r=!1},d(t){t&&x(e),l&&l.d(t),o=!1,s()}}}function ud(t,e,n){let{$$slots:i={},$$scope:r}=e,{value:o}=e;return t.$$set=t=>{\"value\"in t&&n(0,o=t.value),\"$$scope\"in t&&n(1,r=t.$$scope)},[o,r,i,function(){o=this.value,n(0,o)}]}class hd extends Mt{constructor(t){super(),xt(this,t,ud,cd,s,{value:0})}}function fd(t){let e,n;const i=t[1].default,r=d(i,t,t[0],null);return{c(){e=E(\"div\"),r&&r.c(),I(e,\"class\",\"container svelte-11aq3ga\")},m(t,i){b(t,e,i),r&&r.m(e,null),n=!0},p(t,[e]){r&&r.p&&(!n||1&e)&&_(r,i,t,t[0],n?v(i,t[0],e,null):y(t[0]),null)},i(t){n||(ht(r,t),n=!0)},o(t){ft(r,t),n=!1},d(t){t&&x(e),r&&r.d(t)}}}function pd(t,e,n){let{$$slots:i={},$$scope:r}=e;return t.$$set=t=>{\"$$scope\"in t&&n(0,r=t.$$scope)},[r,i]}class dd extends Mt{constructor(t){super(),xt(this,t,pd,fd,s,{})}}function md(t){let e;return{c(){e=L(\"Scene key\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function vd(t){let e;return{c(){e=L(\"Area key\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function _d(t){let e;return{c(){e=L(\"Type\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function yd(t){let e;return{c(){e=L(\"Title\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function gd(t){let e;return{c(){e=L(\"Description\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function wd(t){let e;return{c(){e=L(\"Decimals\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function $d(t){let e;return{c(){e=L(\"Metric\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function bd(t){let e;return{c(){e=L(\"Unit\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function xd(t){let e;return{c(){e=L(\"Go to scene key\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function Md(t){let e;return{c(){e=L(\"Yaw\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function Ed(t){let e;return{c(){e=L(\"Pitch\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function Td(t){let e;return{c(){e=L(\"Extra transforms\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function Ld(t){let e;return{c(){e=L(\"Link\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function Cd(t){let e,n,i,r,o,s,a,l,c,u,h,f,p,d,m,v,_,y,g,w,$,M,E,T,L,S,k,I,P,A,z,O,R,H,D,F,q,j,V,N,B,X,W,Y;function G(e){t[4](e)}let K={min:1,$$slots:{default:[md]},$$scope:{ctx:t}};function Z(e){t[5](e)}void 0!==t[0].scene_key&&(K.value=t[0].scene_key),e=new rp({props:K}),U.push((()=>gt(e,\"value\",G)));let Q={min:1,$$slots:{default:[vd]},$$scope:{ctx:t}};function J(e){t[6](e)}void 0!==t[0].area_key&&(Q.value=t[0].area_key),r=new rp({props:Q}),U.push((()=>gt(r,\"value\",Z)));let tt={items:t[2],$$slots:{default:[_d]},$$scope:{ctx:t}};function et(e){t[7](e)}void 0!==t[0].type&&(tt.value=t[0].type),a=new ld({props:tt}),U.push((()=>gt(a,\"value\",J)));let it={$$slots:{default:[yd]},$$scope:{ctx:t}};function rt(e){t[8](e)}void 0!==t[0].title&&(it.value=t[0].title),u=new hd({props:it}),U.push((()=>gt(u,\"value\",et)));let ot={$$slots:{default:[gd]},$$scope:{ctx:t}};function st(e){t[9](e)}void 0!==t[0].description&&(ot.value=t[0].description),p=new hd({props:ot}),U.push((()=>gt(p,\"value\",rt)));let at={$$slots:{default:[wd]},$$scope:{ctx:t}};function lt(e){t[10](e)}void 0!==t[0].decimals&&(at.value=t[0].decimals),v=new rp({props:at}),U.push((()=>gt(v,\"value\",st)));let ct={$$slots:{default:[$d]},$$scope:{ctx:t}};function ut(e){t[11](e)}void 0!==t[0].metric&&(ct.value=t[0].metric),g=new hd({props:ct}),U.push((()=>gt(g,\"value\",lt)));let pt={$$slots:{default:[bd]},$$scope:{ctx:t}};function dt(e){t[12](e)}void 0!==t[0].unit&&(pt.value=t[0].unit),M=new hd({props:pt}),U.push((()=>gt(M,\"value\",ut)));let mt={};function vt(e){t[13](e)}void 0!==t[0].color&&(mt.value=t[0].color),L=new Kf({props:mt}),U.push((()=>gt(L,\"value\",dt)));let _t={items:t[1](),$$slots:{default:[xd]},$$scope:{ctx:t}};function yt(e){t[14](e)}void 0!==t[0].go_to_scene_key&&(_t.value=t[0].go_to_scene_key),I=new ld({props:_t}),U.push((()=>gt(I,\"value\",vt)));let xt={step:.1,$$slots:{default:[Md]},$$scope:{ctx:t}};function Mt(e){t[15](e)}void 0!==t[0].yaw&&(xt.value=t[0].yaw),z=new rp({props:xt}),U.push((()=>gt(z,\"value\",yt)));let Et={step:.1,$$slots:{default:[Ed]},$$scope:{ctx:t}};function Tt(e){t[16](e)}void 0!==t[0].pitch&&(Et.value=t[0].pitch),H=new rp({props:Et}),U.push((()=>gt(H,\"value\",Mt)));let Lt={$$slots:{default:[Td]},$$scope:{ctx:t}};function Ct(e){t[17](e)}void 0!==t[0].extra_transforms&&(Lt.value=t[0].extra_transforms),q=new hd({props:Lt}),U.push((()=>gt(q,\"value\",Tt)));let St={$$slots:{default:[Ld]},$$scope:{ctx:t}};return void 0!==t[0].link&&(St.value=t[0].link),N=new hd({props:St}),U.push((()=>gt(N,\"value\",Ct))),W=new ep({props:{deleteFunc:t[3]}}),{c(){wt(e.$$.fragment),i=C(),wt(r.$$.fragment),s=C(),wt(a.$$.fragment),c=C(),wt(u.$$.fragment),f=C(),wt(p.$$.fragment),m=C(),wt(v.$$.fragment),y=C(),wt(g.$$.fragment),$=C(),wt(M.$$.fragment),T=C(),wt(L.$$.fragment),k=C(),wt(I.$$.fragment),A=C(),wt(z.$$.fragment),R=C(),wt(H.$$.fragment),F=C(),wt(q.$$.fragment),V=C(),wt(N.$$.fragment),X=C(),wt(W.$$.fragment)},m(t,n){$t(e,t,n),b(t,i,n),$t(r,t,n),b(t,s,n),$t(a,t,n),b(t,c,n),$t(u,t,n),b(t,f,n),$t(p,t,n),b(t,m,n),$t(v,t,n),b(t,y,n),$t(g,t,n),b(t,$,n),$t(M,t,n),b(t,T,n),$t(L,t,n),b(t,k,n),$t(I,t,n),b(t,A,n),$t(z,t,n),b(t,R,n),$t(H,t,n),b(t,F,n),$t(q,t,n),b(t,V,n),$t(N,t,n),b(t,X,n),$t(W,t,n),Y=!0},p(t,i){const s={};524288&i&&(s.$$scope={dirty:i,ctx:t}),!n&&1&i&&(n=!0,s.value=t[0].scene_key,nt((()=>n=!1))),e.$set(s);const c={};524288&i&&(c.$$scope={dirty:i,ctx:t}),!o&&1&i&&(o=!0,c.value=t[0].area_key,nt((()=>o=!1))),r.$set(c);const f={};524288&i&&(f.$$scope={dirty:i,ctx:t}),!l&&1&i&&(l=!0,f.value=t[0].type,nt((()=>l=!1))),a.$set(f);const m={};524288&i&&(m.$$scope={dirty:i,ctx:t}),!h&&1&i&&(h=!0,m.value=t[0].title,nt((()=>h=!1))),u.$set(m);const y={};524288&i&&(y.$$scope={dirty:i,ctx:t}),!d&&1&i&&(d=!0,y.value=t[0].description,nt((()=>d=!1))),p.$set(y);const $={};524288&i&&($.$$scope={dirty:i,ctx:t}),!_&&1&i&&(_=!0,$.value=t[0].decimals,nt((()=>_=!1))),v.$set($);const b={};524288&i&&(b.$$scope={dirty:i,ctx:t}),!w&&1&i&&(w=!0,b.value=t[0].metric,nt((()=>w=!1))),g.$set(b);const x={};524288&i&&(x.$$scope={dirty:i,ctx:t}),!E&&1&i&&(E=!0,x.value=t[0].unit,nt((()=>E=!1))),M.$set(x);const T={};!S&&1&i&&(S=!0,T.value=t[0].color,nt((()=>S=!1))),L.$set(T);const C={};524288&i&&(C.$$scope={dirty:i,ctx:t}),!P&&1&i&&(P=!0,C.value=t[0].go_to_scene_key,nt((()=>P=!1))),I.$set(C);const k={};524288&i&&(k.$$scope={dirty:i,ctx:t}),!O&&1&i&&(O=!0,k.value=t[0].yaw,nt((()=>O=!1))),z.$set(k);const A={};524288&i&&(A.$$scope={dirty:i,ctx:t}),!D&&1&i&&(D=!0,A.value=t[0].pitch,nt((()=>D=!1))),H.$set(A);const R={};524288&i&&(R.$$scope={dirty:i,ctx:t}),!j&&1&i&&(j=!0,R.value=t[0].extra_transforms,nt((()=>j=!1))),q.$set(R);const F={};524288&i&&(F.$$scope={dirty:i,ctx:t}),!B&&1&i&&(B=!0,F.value=t[0].link,nt((()=>B=!1))),N.$set(F)},i(t){Y||(ht(e.$$.fragment,t),ht(r.$$.fragment,t),ht(a.$$.fragment,t),ht(u.$$.fragment,t),ht(p.$$.fragment,t),ht(v.$$.fragment,t),ht(g.$$.fragment,t),ht(M.$$.fragment,t),ht(L.$$.fragment,t),ht(I.$$.fragment,t),ht(z.$$.fragment,t),ht(H.$$.fragment,t),ht(q.$$.fragment,t),ht(N.$$.fragment,t),ht(W.$$.fragment,t),Y=!0)},o(t){ft(e.$$.fragment,t),ft(r.$$.fragment,t),ft(a.$$.fragment,t),ft(u.$$.fragment,t),ft(p.$$.fragment,t),ft(v.$$.fragment,t),ft(g.$$.fragment,t),ft(M.$$.fragment,t),ft(L.$$.fragment,t),ft(I.$$.fragment,t),ft(z.$$.fragment,t),ft(H.$$.fragment,t),ft(q.$$.fragment,t),ft(N.$$.fragment,t),ft(W.$$.fragment,t),Y=!1},d(t){bt(e,t),t&&x(i),bt(r,t),t&&x(s),bt(a,t),t&&x(c),bt(u,t),t&&x(f),bt(p,t),t&&x(m),bt(v,t),t&&x(y),bt(g,t),t&&x($),bt(M,t),t&&x(T),bt(L,t),t&&x(k),bt(I,t),t&&x(A),bt(z,t),t&&x(R),bt(H,t),t&&x(F),bt(q,t),t&&x(V),bt(N,t),t&&x(X),bt(W,t)}}}function Sd(t){let e,n;return e=new dd({props:{$$slots:{default:[Cd]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,[n]){const i={};524289&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function kd(t,e,n){let i;p(t,nf,(t=>n(18,i=t)));let{hotspotConfig:r}=e;return t.$$set=t=>{\"hotspotConfig\"in t&&n(0,r=t.hotspotConfig)},[r,()=>i.map((({scene_key:t,scene_name:e})=>({label:`(${t}) ${e}`,value:t}))),[{label:\"metric\",value:\"metric\"},{label:\"scene\",value:\"scene\"},{label:\"info\",value:\"info\"}],function(){const t=new URL(`${Ph()}hotspots`);t.searchParams.append(\"hotspot_key\",`eq.${r.hotspot_key}`),fetch(t.href,{method:\"DELETE\",headers:Rf}).then((()=>jf())).catch((t=>console.error(t)))},function(e){t.$$.not_equal(r.scene_key,e)&&(r.scene_key=e,n(0,r))},function(e){t.$$.not_equal(r.area_key,e)&&(r.area_key=e,n(0,r))},function(e){t.$$.not_equal(r.type,e)&&(r.type=e,n(0,r))},function(e){t.$$.not_equal(r.title,e)&&(r.title=e,n(0,r))},function(e){t.$$.not_equal(r.description,e)&&(r.description=e,n(0,r))},function(e){t.$$.not_equal(r.decimals,e)&&(r.decimals=e,n(0,r))},function(e){t.$$.not_equal(r.metric,e)&&(r.metric=e,n(0,r))},function(e){t.$$.not_equal(r.unit,e)&&(r.unit=e,n(0,r))},function(e){t.$$.not_equal(r.color,e)&&(r.color=e,n(0,r))},function(e){t.$$.not_equal(r.go_to_scene_key,e)&&(r.go_to_scene_key=e,n(0,r))},function(e){t.$$.not_equal(r.yaw,e)&&(r.yaw=e,n(0,r))},function(e){t.$$.not_equal(r.pitch,e)&&(r.pitch=e,n(0,r))},function(e){t.$$.not_equal(r.extra_transforms,e)&&(r.extra_transforms=e,n(0,r))},function(e){t.$$.not_equal(r.link,e)&&(r.link=e,n(0,r))}]}class Id extends Mt{constructor(t){super(),xt(this,t,kd,Sd,s,{hotspotConfig:0})}}function Pd(t){let e,n,i,r;e=new Pf({props:{hotspot:t[3],editable:t[5]&&t[2],$$slots:{default:[Dd]},$$scope:{ctx:t}}}),e.$on(\"newposition\",t[7]);let o=t[5]&&t[2]&&Fd(t);return{c(){wt(e.$$.fragment),n=C(),o&&o.c(),i=S()},m(t,s){$t(e,t,s),b(t,n,s),o&&o.m(t,s),b(t,i,s),r=!0},p(t,n){const r={};8&n&&(r.hotspot=t[3]),4&n&&(r.editable=t[5]&&t[2]),2097153&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r),t[5]&&t[2]?o?(o.p(t,n),4&n&&ht(o,1)):(o=Fd(t),o.c(),ht(o,1),o.m(i.parentNode,i)):o&&(ct(),ft(o,1,1,(()=>{o=null})),ut())},i(t){r||(ht(e.$$.fragment,t),ht(o),r=!0)},o(t){ft(e.$$.fragment,t),ft(o),r=!1},d(t){bt(e,t),t&&x(n),o&&o.d(t),t&&x(i)}}}function Ad(e){let n,i;return n=new $f({}),{c(){wt(n.$$.fragment)},m(t,e){$t(n,t,e),i=!0},p:t,i(t){i||(ht(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){bt(n,t)}}}function zd(t){let e,n;return e=new Mf({props:{go_to_scene_key:t[0].go_to_scene_key}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.go_to_scene_key=t[0].go_to_scene_key),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Od(t){let e,n;return e=new yf({props:{title:t[0].title,color:t[0].color,link:t[0].link,value:\"No data\",$$slots:{value:[Hd],title:[Rd]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.title=t[0].title),1&n&&(i.color=t[0].color),1&n&&(i.link=t[0].link),2097153&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Rd(t){let e,n,i=t[0].title+\"\";return{c(){e=T(\"tspan\"),n=L(i),I(e,\"slot\",\"title\")},m(t,i){b(t,e,i),$(e,n)},p(t,e){1&e&&i!==(i=t[0].title+\"\")&&O(n,i)},d(t){t&&x(e)}}}function Hd(t){let e,n,i;return n=new Lf({props:{alias:t[0].metric,unit:t[0].unit??void 0,decimals:t[0].decimals??void 0}}),{c(){e=T(\"tspan\"),wt(n.$$.fragment),I(e,\"slot\",\"value\")},m(t,r){b(t,e,r),$t(n,e,null),i=!0},p(t,e){const i={};1&e&&(i.alias=t[0].metric),1&e&&(i.unit=t[0].unit??void 0),1&e&&(i.decimals=t[0].decimals??void 0),n.$set(i)},i(t){i||(ht(n.$$.fragment,t),i=!0)},o(t){ft(n.$$.fragment,t),i=!1},d(t){t&&x(e),bt(n)}}}function Dd(t){let e,n,i,r;const o=[Od,zd,Ad],s=[];function a(t,e){return\"metric\"==t[0].type?0:\"scene\"==t[0].type?1:2}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),i=S()},m(t,n){s[e].m(t,n),b(t,i,n),r=!0},p(t,r){let l=e;e=a(t),e===l?s[e].p(t,r):(ct(),ft(s[l],1,1,(()=>{s[l]=null})),ut(),n=s[e],n?n.p(t,r):(n=s[e]=o[e](t),n.c()),ht(n,1),n.m(i.parentNode,i))},i(t){r||(ht(n),r=!0)},o(t){ft(n),r=!1},d(t){s[e].d(t),t&&x(i)}}}function Fd(t){let e,n,i,r;function o(e){t[13](e)}let s={};return void 0!==t[0]&&(s.hotspotConfig=t[0]),n=new Id({props:s}),U.push((()=>gt(n,\"hotspotConfig\",o))),{c(){e=E(\"div\"),wt(n.$$.fragment),I(e,\"class\",\"editor-container svelte-1mqf4s8\")},m(t,i){b(t,e,i),$t(n,e,null),r=!0},p(t,e){const r={};!i&&1&e&&(i=!0,r.hotspotConfig=t[0],nt((()=>i=!1))),n.$set(r)},i(t){r||(ht(n.$$.fragment,t),r=!0)},o(t){ft(n.$$.fragment,t),r=!1},d(t){t&&x(e),bt(n)}}}function qd(t){let e,n,i,o,s,a,l,c,u,h,f=t[3]&&Pd(t);return{c(){e=E(\"div\"),n=E(\"div\"),f&&f.c(),I(n,\"data-scene-key\",i=t[0].scene_key),I(n,\"data-hotspot-key\",o=t[0].hotspot_key),I(n,\"data-yaw\",s=t[0].yaw),I(n,\"data-pitch\",a=t[0].pitch),I(n,\"data-extra-transforms\",l=t[0].extra_transforms),H(n,\"z-index\",t[1]),I(n,\"class\",\"svelte-1mqf4s8\"),F(n,\"editing\",t[2]),F(n,\"editable\",t[5]),I(e,\"class\",\"wrapper svelte-1mqf4s8\")},m(i,r){b(i,e,r),$(e,n),f&&f.m(n,null),t[14](n),c=!0,u||(h=[w(t[6].call(null,n)),w(t[10].call(null,n)),k(n,\"mousedown\",t[8]),k(n,\"outsideclick\",t[9])],u=!0)},p(t,[e]){t[3]?f?(f.p(t,e),8&e&&ht(f,1)):(f=Pd(t),f.c(),ht(f,1),f.m(n,null)):f&&(ct(),ft(f,1,1,(()=>{f=null})),ut()),(!c||1&e&&i!==(i=t[0].scene_key))&&I(n,\"data-scene-key\",i),(!c||1&e&&o!==(o=t[0].hotspot_key))&&I(n,\"data-hotspot-key\",o),(!c||1&e&&s!==(s=t[0].yaw))&&I(n,\"data-yaw\",s),(!c||1&e&&a!==(a=t[0].pitch))&&I(n,\"data-pitch\",a),(!c||1&e&&l!==(l=t[0].extra_transforms))&&I(n,\"data-extra-transforms\",l),(!c||2&e)&&H(n,\"z-index\",t[1]),4&e&&F(n,\"editing\",t[2])},i(t){c||(ht(f),c=!0)},o(t){ft(f),c=!1},d(n){n&&x(e),f&&f.d(),t[14](null),u=!1,r(h)}}}function jd(t,e,n){let i,r,o,s;p(t,af,(t=>n(12,i=t))),p(t,Zh,(t=>n(15,r=t))),p(t,Qh,(t=>n(16,o=t))),p(t,Bh,(t=>n(17,s=t)));let{hotspotConfig:a}=e,{sceneDataList:l}=e,{index:c}=e;const{editable:u}=customProperties;let h,f,d=!1;const m=[...s.hotspots,...o].find((t=>t.hotspot_key==a.hotspot_key));return t.$$set=t=>{\"hotspotConfig\"in t&&n(0,a=t.hotspotConfig),\"sceneDataList\"in t&&n(11,l=t.sceneDataList),\"index\"in t&&n(1,c=t.index)},t.$$.update=()=>{4097&t.$$.dirty&&n(2,d=i===a.hotspot_key),5&t.$$.dirty&&(d||hf(a,m)||function(){if(m&&!hf(a,m)){const t={};for(const e of Object.keys(a))a[e]!==m[e]&&(t[e]=a[e]);hf(t,r[a.hotspot_key])||Zh.update((e=>Object.assign(Object.assign({},e),{[a.hotspot_key]:t})))}else r[a.hotspot_key]&&(delete r[a.hotspot_key],Zh.set(r))}())},[a,c,d,h,f,u,function(t){const e=t.dataset.sceneKey;if(!e)return void console.warn(\"Missing scene key on\",t);const i=function(t){const e=l.find((e=>e.key==t));if(!e)throw new Error(`Found no scene with key ${t}`);return e}(Number(e));n(3,h=i.scene.hotspotContainer().createHotspot(t,{yaw:Number(t.dataset.yaw),pitch:Number(t.dataset.pitch)},{perspective:{extraTransforms:t.dataset.extraTransforms}}))},function(t){n(0,a=Object.assign(Object.assign({},a),t.detail))},function(){u&&g(af,i=a.hotspot_key,i)},function(){d&&g(af,i=null,i)},function(t){Vf(t,{ignoreNodesStores:[uf]})},l,i,function(t){a=t,n(0,a)},function(t){U[t?\"unshift\":\"push\"]((()=>{f=t,n(4,f)}))}]}class Vd extends Mt{constructor(t){super(),xt(this,t,jd,qd,s,{hotspotConfig:0,sceneDataList:11,index:1})}}function Nd(t,e,n){const i=t.slice();return i[2]=e[n],i[4]=n,i}function Bd(t,e){let n,i,r;return i=new Vd({props:{hotspotConfig:e[2],sceneDataList:e[1],index:e[4]}}),{key:t,first:null,c(){n=S(),wt(i.$$.fragment),this.first=n},m(t,e){b(t,n,e),$t(i,t,e),r=!0},p(t,n){e=t;const r={};1&n&&(r.hotspotConfig=e[2]),2&n&&(r.sceneDataList=e[1]),1&n&&(r.index=e[4]),i.$set(r)},i(t){r||(ht(i.$$.fragment,t),r=!0)},o(t){ft(i.$$.fragment,t),r=!1},d(t){t&&x(n),bt(i,t)}}}function Xd(t){let e,n,i=[],r=new Map,o=t[0];const s=t=>t[2].hotspot_key;for(let e=0;e<o.length;e+=1){let n=Nd(t,o,e),a=s(n);r.set(a,i[e]=Bd(a,n))}return{c(){e=E(\"div\");for(let t=0;t<i.length;t+=1)i[t].c();I(e,\"class\",\"hotspot-container\")},m(t,r){b(t,e,r);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){3&n&&(o=t[0],ct(),i=vt(i,n,s,1,t,o,r,e,mt,Bd,null,Nd),ut())},i(t){if(!n){for(let t=0;t<o.length;t+=1)ht(i[t]);n=!0}},o(t){for(let t=0;t<i.length;t+=1)ft(i[t]);n=!1},d(t){t&&x(e);for(let t=0;t<i.length;t+=1)i[t].d()}}}function Wd(t,e,n){let{hotspotConfigList:i}=e,{sceneDataList:r}=e;return t.$$set=t=>{\"hotspotConfigList\"in t&&n(0,i=t.hotspotConfigList),\"sceneDataList\"in t&&n(1,r=t.sceneDataList)},[i,r]}class Yd extends Mt{constructor(t){super(),xt(this,t,Wd,Xd,s,{hotspotConfigList:0,sceneDataList:1})}}function Ud(e){let n,i,r;return{c(){n=E(\"div\"),I(n,\"class\",\"draggable svelte-nddt6l\")},m(t,o){b(t,n,o),i||(r=k(n,\"mousedown\",e[0]),i=!0)},p:t,i:t,o:t,d(t){t&&x(n),i=!1,r()}}}function Gd(t,e,n){let i,{width:r}=e;function o(t){n(1,r=t.x-i),r<100?n(1,r=100):r>window.innerWidth-100&&n(1,r=window.innerWidth-100)}function s(){window.removeEventListener(\"mousemove\",o),window.removeEventListener(\"mouseup\",s)}return t.$$set=t=>{\"width\"in t&&n(1,r=t.width)},[function(t){i=t.x-r,window.addEventListener(\"mousemove\",o),window.addEventListener(\"mouseup\",s)},r]}class Kd extends Mt{constructor(t){super(),xt(this,t,Gd,Ud,s,{width:1})}}function Zd(t,e,n){const i=t.slice();return i[3]=e[n],i[5]=n,i}function Qd(t){let e,n,i,r,o=t[3].label+\"\";function s(){return t[2](t[5])}return{c(){e=E(\"button\"),n=L(o),I(e,\"class\",\"svelte-1mi0k3z\"),F(e,\"active\",t[0]===t[5])},m(t,o){b(t,e,o),$(e,n),i||(r=k(e,\"click\",s),i=!0)},p(i,r){t=i,2&r&&o!==(o=t[3].label+\"\")&&O(n,o),1&r&&F(e,\"active\",t[0]===t[5])},d(t){t&&x(e),i=!1,r()}}}function Jd(t){let e,n,i,r,o,s=t[1],a=[];for(let e=0;e<s.length;e+=1)a[e]=Qd(Zd(t,s,e));var l=t[1][t[0]].component;return l&&(i=new l({})),{c(){e=E(\"div\");for(let t=0;t<a.length;t+=1)a[t].c();n=C(),i&&wt(i.$$.fragment),r=S(),I(e,\"class\",\"tabs svelte-1mi0k3z\")},m(t,s){b(t,e,s);for(let t=0;t<a.length;t+=1)a[t].m(e,null);b(t,n,s),i&&$t(i,t,s),b(t,r,s),o=!0},p(t,[n]){if(3&n){let i;for(s=t[1],i=0;i<s.length;i+=1){const r=Zd(t,s,i);a[i]?a[i].p(r,n):(a[i]=Qd(r),a[i].c(),a[i].m(e,null))}for(;i<a.length;i+=1)a[i].d(1);a.length=s.length}if(l!==(l=t[1][t[0]].component)){if(i){ct();const t=i;ft(t.$$.fragment,1,0,(()=>{bt(t,1)})),ut()}l?(i=new l({}),wt(i.$$.fragment),ht(i.$$.fragment,1),$t(i,r.parentNode,r)):i=null}},i(t){o||(i&&ht(i.$$.fragment,t),o=!0)},o(t){i&&ft(i.$$.fragment,t),o=!1},d(t){t&&x(e),M(a,t),t&&x(n),t&&x(r),i&&bt(i,t)}}}function tm(t,e,n){let{tabs:i}=e,{currentTab:r=0}=e;return t.$$set=t=>{\"tabs\"in t&&n(1,i=t.tabs),\"currentTab\"in t&&n(0,r=t.currentTab)},[r,i,t=>n(0,r=t)]}class em extends Mt{constructor(t){super(),xt(this,t,tm,Jd,s,{tabs:1,currentTab:0})}}function nm(t){let e,n;return{c(){e=E(\"img\"),u(e.src,n=t[0])||I(e,\"src\",n),I(e,\"alt\",\"Scene\"),I(e,\"crossorigin\",\"anonymous\"),I(e,\"class\",\"svelte-98eo36\")},m(t,n){b(t,e,n)},p(t,i){1&i&&!u(e.src,n=t[0])&&I(e,\"src\",n)},d(t){t&&x(e)}}}function im(e){let n,i,r,o,s,a=e[0]&&nm(e);return{c(){n=E(\"div\"),i=E(\"input\"),r=C(),a&&a.c(),I(i,\"type\",\"file\"),I(i,\"class\",\"svelte-98eo36\")},m(t,l){b(t,n,l),$(n,i),$(n,r),a&&a.m(n,null),o||(s=k(i,\"change\",e[1]),o=!0)},p(t,[e]){t[0]?a?a.p(t,e):(a=nm(t),a.c(),a.m(n,null)):a&&(a.d(1),a=null)},i:t,o:t,d(t){t&&x(n),a&&a.d(),o=!1,s()}}}function rm(t,e,n){let{image:i}=e;const r=W();return t.$$set=t=>{\"image\"in t&&n(0,i=t.image)},[i,t=>{var e;const n=null===(e=t.currentTarget.files)||void 0===e?void 0:e.item(0);if(!n)throw new Error(\"No file selected\");const i=new FileReader;i.readAsDataURL(n),i.onload=t=>{var e;const i=null===(e=t.target)||void 0===e?void 0:e.result;\"string\"==typeof i&&r(\"newimage\",{name:n.name,type:n.type,dataURLs:i})}}]}class om extends Mt{constructor(t){super(),xt(this,t,rm,im,s,{image:0})}}function sm(t){let e;return{c(){e=L(\"Scene name\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function am(t){let e;return{c(){e=L(\"Facing pitch\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function lm(t){let e;return{c(){e=L(\"Facing yaw\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function cm(t){let e;return{c(){e=L(\"FOV\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function um(t){let e;return{c(){e=L(\"File ID\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function hm(t){let e,n,i,r,o,s,a,l,c,u,h,f,p,d,m,v,_,y,g,w,M,T,L;function S(e){t[4](e)}let P={$$slots:{default:[sm]},$$scope:{ctx:t}};function A(e){t[5](e)}void 0!==t[0].scene_name&&(P.value=t[0].scene_name),n=new hd({props:P}),U.push((()=>gt(n,\"value\",S)));let z={step:.1,$$slots:{default:[am]},$$scope:{ctx:t}};function O(e){t[6](e)}void 0!==t[0].facing_pitch&&(z.value=t[0].facing_pitch),o=new rp({props:z}),U.push((()=>gt(o,\"value\",A)));let R={step:.1,$$slots:{default:[lm]},$$scope:{ctx:t}};function H(e){t[7](e)}void 0!==t[0].facing_yaw&&(R.value=t[0].facing_yaw),l=new rp({props:R}),U.push((()=>gt(l,\"value\",O)));let D={$$slots:{default:[cm]},$$scope:{ctx:t}};function F(e){t[8](e)}void 0!==t[0].fov&&(D.value=t[0].fov),h=new rp({props:D}),U.push((()=>gt(h,\"value\",H)));let q={min:1,$$slots:{default:[um]},$$scope:{ctx:t}};function j(e){t[9](e)}void 0!==t[0].file_id&&(q.value=t[0].file_id),d=new rp({props:q}),U.push((()=>gt(d,\"value\",F)));let V={};return void 0!==t[1]&&(V.image=t[1]),_=new om({props:V}),U.push((()=>gt(_,\"image\",j))),_.$on(\"newimage\",t[2]),{c(){e=E(\"div\"),wt(n.$$.fragment),r=C(),wt(o.$$.fragment),a=C(),wt(l.$$.fragment),u=C(),wt(h.$$.fragment),p=C(),wt(d.$$.fragment),v=C(),wt(_.$$.fragment),g=C(),w=E(\"button\"),w.textContent=\"Create new scene\",I(w,\"class\",\"svelte-vbt9u8\"),I(e,\"class\",\"svelte-vbt9u8\")},m(i,s){b(i,e,s),$t(n,e,null),$(e,r),$t(o,e,null),$(e,a),$t(l,e,null),$(e,u),$t(h,e,null),$(e,p),$t(d,e,null),$(e,v),$t(_,e,null),$(e,g),$(e,w),M=!0,T||(L=k(w,\"click\",t[3]),T=!0)},p(t,[e]){const r={};2048&e&&(r.$$scope={dirty:e,ctx:t}),!i&&1&e&&(i=!0,r.value=t[0].scene_name,nt((()=>i=!1))),n.$set(r);const a={};2048&e&&(a.$$scope={dirty:e,ctx:t}),!s&&1&e&&(s=!0,a.value=t[0].facing_pitch,nt((()=>s=!1))),o.$set(a);const u={};2048&e&&(u.$$scope={dirty:e,ctx:t}),!c&&1&e&&(c=!0,u.value=t[0].facing_yaw,nt((()=>c=!1))),l.$set(u);const p={};2048&e&&(p.$$scope={dirty:e,ctx:t}),!f&&1&e&&(f=!0,p.value=t[0].fov,nt((()=>f=!1))),h.$set(p);const v={};2048&e&&(v.$$scope={dirty:e,ctx:t}),!m&&1&e&&(m=!0,v.value=t[0].file_id,nt((()=>m=!1))),d.$set(v);const g={};!y&&2&e&&(y=!0,g.image=t[1],nt((()=>y=!1))),_.$set(g)},i(t){M||(ht(n.$$.fragment,t),ht(o.$$.fragment,t),ht(l.$$.fragment,t),ht(h.$$.fragment,t),ht(d.$$.fragment,t),ht(_.$$.fragment,t),M=!0)},o(t){ft(n.$$.fragment,t),ft(o.$$.fragment,t),ft(l.$$.fragment,t),ft(h.$$.fragment,t),ft(d.$$.fragment,t),ft(_.$$.fragment,t),M=!1},d(t){t&&x(e),bt(n),bt(o),bt(l),bt(h),bt(d),bt(_),T=!1,L()}}}function fm(t,e,n){let i,r;p(t,Fh,(t=>n(10,r=t)));let o={area_key:r,scene_name:\"New scene\",facing_pitch:0,facing_yaw:0,fov:100,file_id:null};return t.$$.update=()=>{1&t.$$.dirty&&n(1,i=o.file_id?Ah(o.file_id):null)},[o,i,function(t){const{name:e,type:i,dataURLs:r}=t.detail,[,s]=r.split(\",\"),a=new URL(`${Ph()}rpc/insert_file`);fetch(a.href,{method:\"POST\",body:JSON.stringify([{name:e,type:i,base64:s}]),headers:Rf}).then((t=>t.text().then((t=>n(0,o.file_id=Number(t),o))))).catch((t=>console.error(t)))},function(){const t=new URL(`${Ph()}scenes`);fetch(t.href,{method:\"POST\",body:JSON.stringify(o),headers:Rf}).then((t=>t.json().then((([t])=>{console.info(\"Created scene:\",t),jf()})))).catch((t=>console.error(t)))},function(e){t.$$.not_equal(o.scene_name,e)&&(o.scene_name=e,n(0,o))},function(e){t.$$.not_equal(o.facing_pitch,e)&&(o.facing_pitch=e,n(0,o))},function(e){t.$$.not_equal(o.facing_yaw,e)&&(o.facing_yaw=e,n(0,o))},function(e){t.$$.not_equal(o.fov,e)&&(o.fov=e,n(0,o))},function(e){t.$$.not_equal(o.file_id,e)&&(o.file_id=e,n(0,o))},function(t){i=t,n(1,i),n(0,o)}]}class pm extends Mt{constructor(t){super(),xt(this,t,fm,hm,s,{})}}function dm(e){let n,i,r;return{c(){n=E(\"button\"),n.textContent=\"Save\"},m(t,s){b(t,n,s),i||(r=k(n,\"click\",(function(){o(e[0])&&e[0].apply(this,arguments)})),i=!0)},p(t,[n]){e=t},i:t,o:t,d(t){t&&x(n),i=!1,r()}}}function mm(t,e,n){let{saveFunc:i}=e;return t.$$set=t=>{\"saveFunc\"in t&&n(0,i=t.saveFunc)},[i]}class vm extends Mt{constructor(t){super(),xt(this,t,mm,dm,s,{saveFunc:0})}}function _m(t){let e;return{c(){e=L(\"Scene name\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function ym(t){let e;return{c(){e=L(\"Area key\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function gm(t){let e;return{c(){e=L(\"Facing pitch\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function wm(t){let e;return{c(){e=L(\"Facing yaw\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function $m(t){let e;return{c(){e=L(\"FOV\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function bm(t){let e;return{c(){e=L(\"File ID\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function xm(t){let e,n,i,r,o,s,a,l,c,u,h,f,p,d,m,v,_,y,g,w,$,M,E;function T(e){t[8](e)}let L={$$slots:{default:[_m]},$$scope:{ctx:t}};function S(e){t[9](e)}void 0!==t[0].scene_name&&(L.value=t[0].scene_name),e=new hd({props:L}),U.push((()=>gt(e,\"value\",T)));let k={min:1,$$slots:{default:[ym]},$$scope:{ctx:t}};function I(e){t[10](e)}void 0!==t[0].area_key&&(k.value=t[0].area_key),r=new rp({props:k}),U.push((()=>gt(r,\"value\",S)));let P={step:.1,$$slots:{default:[gm]},$$scope:{ctx:t}};function A(e){t[11](e)}void 0!==t[0].facing_pitch&&(P.value=t[0].facing_pitch),a=new rp({props:P}),U.push((()=>gt(a,\"value\",I)));let z={step:.1,$$slots:{default:[wm]},$$scope:{ctx:t}};function O(e){t[12](e)}void 0!==t[0].facing_yaw&&(z.value=t[0].facing_yaw),u=new rp({props:z}),U.push((()=>gt(u,\"value\",A)));let R={$$slots:{default:[$m]},$$scope:{ctx:t}};function H(e){t[13](e)}void 0!==t[0].fov&&(R.value=t[0].fov),p=new rp({props:R}),U.push((()=>gt(p,\"value\",O)));let D={min:1,$$slots:{default:[bm]},$$scope:{ctx:t}};function F(e){t[14](e)}void 0!==t[0].file_id&&(D.value=t[0].file_id),v=new rp({props:D}),U.push((()=>gt(v,\"value\",H)));let q={};return void 0!==t[1]&&(q.image=t[1]),g=new om({props:q}),U.push((()=>gt(g,\"image\",F))),g.$on(\"newimage\",t[2]),M=new ep({props:{deleteFunc:t[3]}}),{c(){wt(e.$$.fragment),i=C(),wt(r.$$.fragment),s=C(),wt(a.$$.fragment),c=C(),wt(u.$$.fragment),f=C(),wt(p.$$.fragment),m=C(),wt(v.$$.fragment),y=C(),wt(g.$$.fragment),$=C(),wt(M.$$.fragment)},m(t,n){$t(e,t,n),b(t,i,n),$t(r,t,n),b(t,s,n),$t(a,t,n),b(t,c,n),$t(u,t,n),b(t,f,n),$t(p,t,n),b(t,m,n),$t(v,t,n),b(t,y,n),$t(g,t,n),b(t,$,n),$t(M,t,n),E=!0},p(t,i){const s={};32768&i&&(s.$$scope={dirty:i,ctx:t}),!n&&1&i&&(n=!0,s.value=t[0].scene_name,nt((()=>n=!1))),e.$set(s);const c={};32768&i&&(c.$$scope={dirty:i,ctx:t}),!o&&1&i&&(o=!0,c.value=t[0].area_key,nt((()=>o=!1))),r.$set(c);const f={};32768&i&&(f.$$scope={dirty:i,ctx:t}),!l&&1&i&&(l=!0,f.value=t[0].facing_pitch,nt((()=>l=!1))),a.$set(f);const m={};32768&i&&(m.$$scope={dirty:i,ctx:t}),!h&&1&i&&(h=!0,m.value=t[0].facing_yaw,nt((()=>h=!1))),u.$set(m);const y={};32768&i&&(y.$$scope={dirty:i,ctx:t}),!d&&1&i&&(d=!0,y.value=t[0].fov,nt((()=>d=!1))),p.$set(y);const $={};32768&i&&($.$$scope={dirty:i,ctx:t}),!_&&1&i&&(_=!0,$.value=t[0].file_id,nt((()=>_=!1))),v.$set($);const b={};!w&&2&i&&(w=!0,b.image=t[1],nt((()=>w=!1))),g.$set(b)},i(t){E||(ht(e.$$.fragment,t),ht(r.$$.fragment,t),ht(a.$$.fragment,t),ht(u.$$.fragment,t),ht(p.$$.fragment,t),ht(v.$$.fragment,t),ht(g.$$.fragment,t),ht(M.$$.fragment,t),E=!0)},o(t){ft(e.$$.fragment,t),ft(r.$$.fragment,t),ft(a.$$.fragment,t),ft(u.$$.fragment,t),ft(p.$$.fragment,t),ft(v.$$.fragment,t),ft(g.$$.fragment,t),ft(M.$$.fragment,t),E=!1},d(t){bt(e,t),t&&x(i),bt(r,t),t&&x(s),bt(a,t),t&&x(c),bt(u,t),t&&x(f),bt(p,t),t&&x(m),bt(v,t),t&&x(y),bt(g,t),t&&x($),bt(M,t)}}}function Mm(t){let e,n;return e=new dd({props:{$$slots:{default:[xm]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,[n]){const i={};32771&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Em(t,e,n){let i,r,o,s,a;p(t,Wh,(t=>n(5,o=t))),p(t,ef,(t=>n(6,s=t))),p(t,nf,(t=>n(7,a=t)));let{sceneConfig:l}=e;return t.$$set=t=>{\"sceneConfig\"in t&&n(0,l=t.sceneConfig)},t.$$.update=()=>{if(1&t.$$.dirty&&n(1,i=Ah(l.file_id)),129&t.$$.dirty&&n(4,r=a.findIndex((t=>t.scene_key==l.scene_key))),113&t.$$.dirty){const t=o[r];if(hf(l,t))s[l.scene_key]&&(delete s[l.scene_key],ef.set(s));else{const e=Object.fromEntries(Object.keys(l).filter((e=>l[e]!==t[e])).map((t=>[t,l[t]]))),n=s[l.scene_key];hf(n,e)||ef.update((t=>Object.assign(Object.assign({},t),{[l.scene_key]:e})))}}},[l,i,function(t){const{name:e,type:i,dataURLs:r}=t.detail,[,o]=r.split(\",\"),s=new URL(`${Ph()}rpc/insert_file`);fetch(s.href,{method:\"POST\",body:JSON.stringify([{name:e,type:i,base64:o}]),headers:Rf}).then((t=>t.text().then((t=>n(0,l.file_id=Number(t),l))))).catch((t=>console.error(t)))},function(){const t=new URL(`${Ph()}scenes`);t.searchParams.append(\"scene_key\",`eq.${l.scene_key}`),fetch(t.href,{method:\"DELETE\",headers:Rf}).then((()=>{const t=o;let e=\"\";t.length>r+1?e=t[r+1].scene_key:t.length>2&&(e=t[r-1].scene_key),qh.setVariable(e)})).catch((t=>console.error(t)))},r,o,s,a,function(e){t.$$.not_equal(l.scene_name,e)&&(l.scene_name=e,n(0,l))},function(e){t.$$.not_equal(l.area_key,e)&&(l.area_key=e,n(0,l))},function(e){t.$$.not_equal(l.facing_pitch,e)&&(l.facing_pitch=e,n(0,l))},function(e){t.$$.not_equal(l.facing_yaw,e)&&(l.facing_yaw=e,n(0,l))},function(e){t.$$.not_equal(l.fov,e)&&(l.fov=e,n(0,l))},function(e){t.$$.not_equal(l.file_id,e)&&(l.file_id=e,n(0,l))},function(t){i=t,n(1,i),n(0,l)}]}class Tm extends Mt{constructor(t){super(),xt(this,t,Em,Mm,s,{sceneConfig:0})}}function Lm(t){let e,n;return e=new Tm({props:{sceneConfig:t[1]}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.sceneConfig=t[1]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Cm(t){let e,n,i,o,s,a,l,c,h,f,p,d,m,v,_,y=t[1].scene_key+\"\",g=t[1].scene_name+\"\",w=t[3]&&Lm(t);return{c(){e=E(\"li\"),n=E(\"label\"),i=E(\"input\"),s=L(\"\\n    (\"),a=L(y),l=L(\")\\n    \"),c=L(g),h=C(),f=E(\"img\"),d=C(),w&&w.c(),I(i,\"type\",\"radio\"),i.__value=o=t[1].scene_key,i.value=i.__value,t[6][0].push(i),u(f.src,p=Ah(t[1].file_id))||I(f,\"src\",p),I(f,\"alt\",\"Scene\"),I(f,\"crossorigin\",\"anonymous\"),I(f,\"class\",\"svelte-1sg4g2q\"),I(n,\"class\",\"svelte-1sg4g2q\"),F(n,\"active\",t[3]),F(n,\"edited\",t[2])},m(r,o){b(r,e,o),$(e,n),$(n,i),i.checked=i.__value===t[0],$(n,s),$(n,a),$(n,l),$(n,c),$(n,h),$(n,f),$(e,d),w&&w.m(e,null),m=!0,v||(_=[k(i,\"change\",t[5]),k(i,\"change\",t[7])],v=!0)},p(t,[r]){(!m||2&r&&o!==(o=t[1].scene_key))&&(i.__value=o,i.value=i.__value),1&r&&(i.checked=i.__value===t[0]),(!m||2&r)&&y!==(y=t[1].scene_key+\"\")&&O(a,y),(!m||2&r)&&g!==(g=t[1].scene_name+\"\")&&O(c,g),(!m||2&r&&!u(f.src,p=Ah(t[1].file_id)))&&I(f,\"src\",p),8&r&&F(n,\"active\",t[3]),4&r&&F(n,\"edited\",t[2]),t[3]?w?(w.p(t,r),8&r&&ht(w,1)):(w=Lm(t),w.c(),ht(w,1),w.m(e,null)):w&&(ct(),ft(w,1,1,(()=>{w=null})),ut())},i(t){m||(ht(w),m=!0)},o(t){ft(w),m=!1},d(n){n&&x(e),t[6][0].splice(t[6][0].indexOf(i),1),w&&w.d(),v=!1,r(_)}}}function Sm(t,e,n){let i,r,o;p(t,ef,(t=>n(4,o=t)));let{sceneConfig:s}=e,{selectedScene:a}=e;return t.$$set=t=>{\"sceneConfig\"in t&&n(1,s=t.sceneConfig),\"selectedScene\"in t&&n(0,a=t.selectedScene)},t.$$.update=()=>{3&t.$$.dirty&&n(3,i=s.scene_key==a),18&t.$$.dirty&&n(2,r=s.scene_key in o)},[a,s,r,i,o,function(){a=this.__value,n(0,a)},[[]],()=>qh.setVariable(s.scene_key)]}class km extends Mt{constructor(t){super(),xt(this,t,Sm,Cm,s,{sceneConfig:1,selectedScene:0})}}function Im(t,e,n){const i=t.slice();return i[4]=e[n],i}function Pm(t,e){let n,i,r,o;function s(t){e[3](t)}let a={sceneConfig:e[4]};return void 0!==e[1]&&(a.selectedScene=e[1]),i=new km({props:a}),U.push((()=>gt(i,\"selectedScene\",s))),{key:t,first:null,c(){n=S(),wt(i.$$.fragment),this.first=n},m(t,e){b(t,n,e),$t(i,t,e),o=!0},p(t,n){e=t;const o={};1&n&&(o.sceneConfig=e[4]),!r&&2&n&&(r=!0,o.selectedScene=e[1],nt((()=>r=!1))),i.$set(o)},i(t){o||(ht(i.$$.fragment,t),o=!0)},o(t){ft(i.$$.fragment,t),o=!1},d(t){t&&x(n),bt(i,t)}}}function Am(t){let e,n,i,r=[],o=new Map,s=t[0];const a=t=>t[4].scene_key;for(let e=0;e<s.length;e+=1){let n=Im(t,s,e),i=a(n);o.set(i,r[e]=Pm(i,n))}return{c(){e=E(\"div\"),n=E(\"ul\");for(let t=0;t<r.length;t+=1)r[t].c();I(n,\"class\",\"svelte-n62mam\"),I(e,\"class\",\"svelte-n62mam\")},m(t,o){b(t,e,o),$(e,n);for(let t=0;t<r.length;t+=1)r[t].m(n,null);i=!0},p(t,[e]){3&e&&(s=t[0],ct(),r=vt(r,e,a,1,t,s,o,n,mt,Pm,null,Im),ut())},i(t){if(!i){for(let t=0;t<s.length;t+=1)ht(r[t]);i=!0}},o(t){for(let t=0;t<r.length;t+=1)ft(r[t]);i=!1},d(t){t&&x(e);for(let t=0;t<r.length;t+=1)r[t].d()}}}function zm(t,e,n){let i,r,o;return p(t,qh,(t=>n(2,r=t))),p(t,nf,(t=>n(0,o=t))),t.$$.update=()=>{5&t.$$.dirty&&n(1,i=o.find((t=>t.scene_key==r))?r:null)},[o,i,r,function(t){i=t,n(1,i),n(0,o),n(2,r)}]}class Om extends Mt{constructor(t){super(),xt(this,t,zm,Am,s,{})}}function Rm(e){let n,i,r,o,s,a;return n=new Om({}),r=new pm({}),s=new vm({props:{saveFunc:e[0]}}),{c(){wt(n.$$.fragment),i=C(),wt(r.$$.fragment),o=C(),wt(s.$$.fragment)},m(t,e){$t(n,t,e),b(t,i,e),$t(r,t,e),b(t,o,e),$t(s,t,e),a=!0},p:t,i(t){a||(ht(n.$$.fragment,t),ht(r.$$.fragment,t),ht(s.$$.fragment,t),a=!0)},o(t){ft(n.$$.fragment,t),ft(r.$$.fragment,t),ft(s.$$.fragment,t),a=!1},d(t){bt(n,t),t&&x(i),bt(r,t),t&&x(o),bt(s,t)}}}function Hm(t,e,n){let i;return p(t,ef,(t=>n(1,i=t))),[async function(){Promise.all(Object.entries(i).map((async([t,e])=>{const n=new URL(`${Ph()}scenes`);n.searchParams.append(\"scene_key\",`eq.${t}`);try{return fetch(n.href,{method:\"PATCH\",body:JSON.stringify(e),headers:Rf})}catch(t){return console.error(t)}}))).then((()=>jf()))}]}class Dm extends Mt{constructor(t){super(),xt(this,t,Hm,Rm,s,{})}}function Fm(t){let e;return{c(){e=L(\"Area name\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function qm(t){let e,n,i,r,o;function s(e){t[6](e)}let a={$$slots:{default:[Fm]},$$scope:{ctx:t}};return void 0!==t[0].area_name&&(a.value=t[0].area_name),e=new hd({props:a}),U.push((()=>gt(e,\"value\",s))),r=new ep({props:{deleteFunc:t[1]}}),{c(){wt(e.$$.fragment),i=C(),wt(r.$$.fragment)},m(t,n){$t(e,t,n),b(t,i,n),$t(r,t,n),o=!0},p(t,i){const r={};128&i&&(r.$$scope={dirty:i,ctx:t}),!n&&1&i&&(n=!0,r.value=t[0].area_name,nt((()=>n=!1))),e.$set(r)},i(t){o||(ht(e.$$.fragment,t),ht(r.$$.fragment,t),o=!0)},o(t){ft(e.$$.fragment,t),ft(r.$$.fragment,t),o=!1},d(t){bt(e,t),t&&x(i),bt(r,t)}}}function jm(t){let e,n;return e=new dd({props:{$$slots:{default:[qm]},$$scope:{ctx:t}}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,[n]){const i={};129&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Vm(t,e,n){let i,r,o,s;p(t,Xh,(t=>n(3,r=t))),p(t,Uh,(t=>n(4,o=t))),p(t,Kh,(t=>n(5,s=t)));let{areaConfig:a}=e;return t.$$set=t=>{\"areaConfig\"in t&&n(0,a=t.areaConfig)},t.$$.update=()=>{if(33&t.$$.dirty&&n(2,i=s.findIndex((t=>t.area_key==a.area_key))),29&t.$$.dirty){const t=r[i];if(hf(a,t))o[a.area_key]&&(delete o[a.area_key],Uh.set(o));else{const e=Object.fromEntries(Object.keys(a).filter((e=>a[e]!==t[e])).map((t=>[t,a[t]]))),n=o[a.area_key];hf(n,e)||Uh.update((t=>Object.assign(Object.assign({},t),{[a.area_key]:e})))}}},[a,function(){const t=new URL(`${Ph()}areas`);t.searchParams.append(\"area_key\",`eq.${a.area_key}`),fetch(t.href,{method:\"DELETE\",headers:Rf}).then((()=>{const t=r;let e=\"\";t.length>i+1?e=t[i+1].area_key:t.length>2&&(e=t[i-1].area_key),Fh.setVariable(e)})).catch((t=>console.error(t)))},i,r,o,s,function(e){t.$$.not_equal(a.area_name,e)&&(a.area_name=e,n(0,a))}]}class Nm extends Mt{constructor(t){super(),xt(this,t,Vm,jm,s,{areaConfig:0})}}function Bm(t){let e,n;return e=new Nm({props:{areaConfig:t[1]}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.areaConfig=t[1]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Xm(t){let e,n,i,o,s,a,l,c,u,h,f,p,d=t[1].area_key+\"\",m=t[1].area_name+\"\",v=t[3]&&Bm(t);return{c(){e=E(\"li\"),n=E(\"label\"),i=E(\"input\"),s=L(\"\\n    (\"),a=L(d),l=L(\")\\n    \"),c=L(m),u=C(),v&&v.c(),I(i,\"type\",\"radio\"),i.__value=o=t[1].area_key,i.value=i.__value,t[6][0].push(i),I(n,\"class\",\"svelte-kk9kj9\"),F(n,\"active\",t[3]),F(n,\"edited\",t[2])},m(r,o){b(r,e,o),$(e,n),$(n,i),i.checked=i.__value===t[0],$(n,s),$(n,a),$(n,l),$(n,c),$(e,u),v&&v.m(e,null),h=!0,f||(p=[k(i,\"change\",t[5]),k(i,\"change\",t[7])],f=!0)},p(t,[r]){(!h||2&r&&o!==(o=t[1].area_key))&&(i.__value=o,i.value=i.__value),1&r&&(i.checked=i.__value===t[0]),(!h||2&r)&&d!==(d=t[1].area_key+\"\")&&O(a,d),(!h||2&r)&&m!==(m=t[1].area_name+\"\")&&O(c,m),8&r&&F(n,\"active\",t[3]),4&r&&F(n,\"edited\",t[2]),t[3]?v?(v.p(t,r),8&r&&ht(v,1)):(v=Bm(t),v.c(),ht(v,1),v.m(e,null)):v&&(ct(),ft(v,1,1,(()=>{v=null})),ut())},i(t){h||(ht(v),h=!0)},o(t){ft(v),h=!1},d(n){n&&x(e),t[6][0].splice(t[6][0].indexOf(i),1),v&&v.d(),f=!1,r(p)}}}function Wm(t,e,n){let i,r,o;p(t,Uh,(t=>n(4,o=t)));let{areaConfig:s}=e,{selectedArea:a}=e;return t.$$set=t=>{\"areaConfig\"in t&&n(1,s=t.areaConfig),\"selectedArea\"in t&&n(0,a=t.selectedArea)},t.$$.update=()=>{3&t.$$.dirty&&n(3,i=s.area_key==a),18&t.$$.dirty&&n(2,r=s.area_key in o)},[a,s,r,i,o,function(){a=this.__value,n(0,a)},[[]],()=>Fh.setVariable(s.area_key)]}class Ym extends Mt{constructor(t){super(),xt(this,t,Wm,Xm,s,{areaConfig:1,selectedArea:0})}}function Um(t,e,n){const i=t.slice();return i[4]=e[n],i}function Gm(t){let e,n,i;function r(e){t[3](e)}let o={areaConfig:t[4]};return void 0!==t[1]&&(o.selectedArea=t[1]),e=new Ym({props:o}),U.push((()=>gt(e,\"selectedArea\",r))),{c(){wt(e.$$.fragment)},m(t,n){$t(e,t,n),i=!0},p(t,i){const r={};1&i&&(r.areaConfig=t[4]),!n&&2&i&&(n=!0,r.selectedArea=t[1],nt((()=>n=!1))),e.$set(r)},i(t){i||(ht(e.$$.fragment,t),i=!0)},o(t){ft(e.$$.fragment,t),i=!1},d(t){bt(e,t)}}}function Km(t){let e,n,i,r=t[0],o=[];for(let e=0;e<r.length;e+=1)o[e]=Gm(Um(t,r,e));const s=t=>ft(o[t],1,1,(()=>{o[t]=null}));return{c(){e=E(\"div\"),n=E(\"ul\");for(let t=0;t<o.length;t+=1)o[t].c();I(n,\"class\",\"svelte-n62mam\"),I(e,\"class\",\"svelte-n62mam\")},m(t,r){b(t,e,r),$(e,n);for(let t=0;t<o.length;t+=1)o[t].m(n,null);i=!0},p(t,[e]){if(3&e){let i;for(r=t[0],i=0;i<r.length;i+=1){const s=Um(t,r,i);o[i]?(o[i].p(s,e),ht(o[i],1)):(o[i]=Gm(s),o[i].c(),ht(o[i],1),o[i].m(n,null))}for(ct(),i=r.length;i<o.length;i+=1)s(i);ut()}},i(t){if(!i){for(let t=0;t<r.length;t+=1)ht(o[t]);i=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)ft(o[t]);i=!1},d(t){t&&x(e),M(o,t)}}}function Zm(t,e,n){let i,r,o;return p(t,Fh,(t=>n(2,r=t))),p(t,Gh,(t=>n(0,o=t))),t.$$.update=()=>{5&t.$$.dirty&&n(1,i=o.find((t=>t.area_key==r))?r:null)},[o,i,r,function(t){i=t,n(1,i),n(0,o),n(2,r)}]}class Qm extends Mt{constructor(t){super(),xt(this,t,Zm,Km,s,{})}}function Jm(t){let e;return{c(){e=L(\"Area name\")},m(t,n){b(t,e,n)},d(t){t&&x(e)}}}function tv(t){let e,n,i,r,o,s,a,l;function c(e){t[2](e)}let u={$$slots:{default:[Jm]},$$scope:{ctx:t}};return void 0!==t[0].area_name&&(u.value=t[0].area_name),n=new hd({props:u}),U.push((()=>gt(n,\"value\",c))),{c(){e=E(\"div\"),wt(n.$$.fragment),r=C(),o=E(\"button\"),o.textContent=\"Create new area\",I(o,\"class\",\"svelte-58jnl0\"),I(e,\"class\",\"svelte-58jnl0\")},m(i,c){b(i,e,c),$t(n,e,null),$(e,r),$(e,o),s=!0,a||(l=k(o,\"click\",t[1]),a=!0)},p(t,[e]){const r={};8&e&&(r.$$scope={dirty:e,ctx:t}),!i&&1&e&&(i=!0,r.value=t[0].area_name,nt((()=>i=!1))),n.$set(r)},i(t){s||(ht(n.$$.fragment,t),s=!0)},o(t){ft(n.$$.fragment,t),s=!1},d(t){t&&x(e),bt(n),a=!1,l()}}}function ev(t,e,n){let i={area_name:\"New area\"};return[i,function(){const t=new URL(`${Ph()}areas`);fetch(t.href,{method:\"POST\",body:JSON.stringify(i),headers:Rf}).then((t=>t.json().then((([t])=>{console.info(\"Created area:\",t),jf()})))).catch((t=>console.error(t)))},function(e){t.$$.not_equal(i.area_name,e)&&(i.area_name=e,n(0,i))}]}class nv extends Mt{constructor(t){super(),xt(this,t,ev,tv,s,{})}}function iv(e){let n,i,r,o,s,a;return n=new Qm({}),r=new nv({}),s=new vm({props:{saveFunc:e[0]}}),{c(){wt(n.$$.fragment),i=C(),wt(r.$$.fragment),o=C(),wt(s.$$.fragment)},m(t,e){$t(n,t,e),b(t,i,e),$t(r,t,e),b(t,o,e),$t(s,t,e),a=!0},p:t,i(t){a||(ht(n.$$.fragment,t),ht(r.$$.fragment,t),ht(s.$$.fragment,t),a=!0)},o(t){ft(n.$$.fragment,t),ft(r.$$.fragment,t),ft(s.$$.fragment,t),a=!1},d(t){bt(n,t),t&&x(i),bt(r,t),t&&x(o),bt(s,t)}}}function rv(t,e,n){let i;return p(t,Uh,(t=>n(1,i=t))),[async function(){Promise.all(Object.entries(i).map((async([t,e])=>{const n=new URL(`${Ph()}areas`);n.searchParams.append(\"area_key\",`eq.${t}`);try{return fetch(n.href,{method:\"PATCH\",body:JSON.stringify(e),headers:Rf})}catch(t){return console.error(t)}}))).then((()=>jf()))}]}class ov extends Mt{constructor(t){super(),xt(this,t,rv,iv,s,{})}}function sv(t){let e,n;return e=new Id({props:{hotspotConfig:t[0]}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.hotspotConfig=t[0]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function av(t){let e,n,i,r,o,s,a,l,c,u,h,f=t[0].hotspot_key+\"\",p=t[3]&&sv(t);return{c(){e=E(\"li\"),n=E(\"label\"),i=E(\"input\"),o=L(\"\\n    (\"),s=L(f),a=L(\")\"),l=C(),p&&p.c(),I(i,\"type\",\"radio\"),i.__value=r=t[0].hotspot_key,i.value=i.__value,t[6][0].push(i),I(n,\"class\",\"svelte-kk9kj9\"),F(n,\"active\",t[3]),F(n,\"edited\",t[2])},m(r,f){b(r,e,f),$(e,n),$(n,i),i.checked=i.__value===t[1],$(n,o),$(n,s),$(n,a),$(e,l),p&&p.m(e,null),c=!0,u||(h=k(i,\"change\",t[5]),u=!0)},p(t,[o]){(!c||1&o&&r!==(r=t[0].hotspot_key))&&(i.__value=r,i.value=i.__value),2&o&&(i.checked=i.__value===t[1]),(!c||1&o)&&f!==(f=t[0].hotspot_key+\"\")&&O(s,f),8&o&&F(n,\"active\",t[3]),4&o&&F(n,\"edited\",t[2]),t[3]?p?(p.p(t,o),8&o&&ht(p,1)):(p=sv(t),p.c(),ht(p,1),p.m(e,null)):p&&(ct(),ft(p,1,1,(()=>{p=null})),ut())},i(t){c||(ht(p),c=!0)},o(t){ft(p),c=!1},d(n){n&&x(e),t[6][0].splice(t[6][0].indexOf(i),1),p&&p.d(),u=!1,h()}}}function lv(t,e,n){let i,r,o,s;p(t,Uh,(t=>n(4,o=t))),p(t,af,(t=>n(1,s=t)));let{hotspotConfig:a}=e;return t.$$set=t=>{\"hotspotConfig\"in t&&n(0,a=t.hotspotConfig)},t.$$.update=()=>{3&t.$$.dirty&&n(3,i=a.hotspot_key==s),17&t.$$.dirty&&n(2,r=a.hotspot_key in o)},[a,s,r,i,o,function(){s=this.__value,af.set(s)},[[]]]}class cv extends Mt{constructor(t){super(),xt(this,t,lv,av,s,{hotspotConfig:0})}}function uv(t,e,n){const i=t.slice();return i[6]=e[n],i}function hv(t){let e,n;return e=new cv({props:{hotspotConfig:t[6]}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.hotspotConfig=t[6]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function fv(t){let e,n,i,r=t[1],o=[];for(let e=0;e<r.length;e+=1)o[e]=hv(uv(t,r,e));const s=t=>ft(o[t],1,1,(()=>{o[t]=null}));return{c(){e=E(\"div\"),n=E(\"ul\");for(let t=0;t<o.length;t+=1)o[t].c();I(n,\"class\",\"svelte-n62mam\"),I(e,\"class\",\"svelte-n62mam\")},m(r,s){b(r,e,s),$(e,n);for(let t=0;t<o.length;t+=1)o[t].m(n,null);t[4](n),i=!0},p(t,[e]){if(2&e){let i;for(r=t[1],i=0;i<r.length;i+=1){const s=uv(t,r,i);o[i]?(o[i].p(s,e),ht(o[i],1)):(o[i]=hv(s),o[i].c(),ht(o[i],1),o[i].m(n,null))}for(ct(),i=r.length;i<o.length;i+=1)s(i);ut()}},i(t){if(!i){for(let t=0;t<r.length;t+=1)ht(o[t]);i=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)ft(o[t]);i=!1},d(n){n&&x(e),M(o,n),t[4](null)}}}function pv(t,e,n){let i,r,o,s,a;return p(t,uf,(t=>n(5,r=t))),p(t,qh,(t=>n(2,o=t))),p(t,tf,(t=>n(3,s=t))),B((()=>{uf.set([...r,a])})),X((()=>{uf.set(r.filter((t=>t!==a)))})),t.$$.update=()=>{12&t.$$.dirty&&n(1,i=s.filter((t=>t.scene_key===o)))},[a,i,o,s,function(t){U[t?\"unshift\":\"push\"]((()=>{a=t,n(0,a)}))}]}class dv extends Mt{constructor(t){super(),xt(this,t,pv,fv,s,{})}}function mv(e){let n,i,r;return{c(){n=E(\"button\"),n.textContent=\"New hotspot\",I(n,\"class\",\"svelte-4vhvtq\")},m(t,o){b(t,n,o),i||(r=k(n,\"click\",e[0]),i=!0)},p:t,i:t,o:t,d(t){t&&x(n),i=!1,r()}}}function vv(t,e,n){let i,r,o,s;return p(t,Nh,(t=>n(1,i=t))),p(t,Fh,(t=>n(2,r=t))),p(t,qh,(t=>n(3,o=t))),p(t,tf,(t=>n(4,s=t))),[function(){Qh.update((t=>{const e=s.filter((t=>\"string\"==typeof t.hotspot_key)).map((t=>Number(String(t.hotspot_key).replace(\"new\",\"\"))));return[...t,{hotspot_key:\"new\"+(e.length>0?Math.max(...e)+1:1),scene_key:o,area_key:r,yaw:i.view().yaw(),pitch:i.view().pitch(),color:null,description:null,extra_transforms:null,go_to_scene_key:null,metric:null,title:null,type:null,unit:null,decimals:null,link:null}]}))}]}class _v extends Mt{constructor(t){super(),xt(this,t,vv,mv,s,{})}}function yv(e){let n,i,r,o,s,a;return n=new dv({}),r=new _v({}),s=new vm({props:{saveFunc:e[0]}}),{c(){wt(n.$$.fragment),i=C(),wt(r.$$.fragment),o=C(),wt(s.$$.fragment)},m(t,e){$t(n,t,e),b(t,i,e),$t(r,t,e),b(t,o,e),$t(s,t,e),a=!0},p:t,i(t){a||(ht(n.$$.fragment,t),ht(r.$$.fragment,t),ht(s.$$.fragment,t),a=!0)},o(t){ft(n.$$.fragment,t),ft(r.$$.fragment,t),ft(s.$$.fragment,t),a=!1},d(t){bt(n,t),t&&x(i),bt(r,t),t&&x(o),bt(s,t)}}}function gv(t,e,n){let i,r;p(t,Zh,(t=>n(1,i=t))),p(t,Qh,(t=>n(2,r=t)));var o=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};async function s(){const t=r.map((t=>o(t,[\"hotspot_key\"]))),e=new URL(`${Ph()}hotspots`);await fetch(e.href,{method:\"POST\",body:JSON.stringify(t),headers:Rf}).then((t=>t.json().then((t=>{console.info(\"Created hotspots:\",t),function(t){for(const e in r){const n=r[e].hotspot_key,s=t[e];i[n]&&Zh.update((t=>{var e=n,i=t[e],r=o(t,[\"symbol\"==typeof e?e:e+\"\"]);return Object.assign({[s]:i},r)}))}}(t.map((t=>Number(t.hotspot_key)))),Qh.set([]),jf()})))).catch((t=>console.error(t)))}return[async function(){await s(),Promise.all(Object.entries(i).map((async([t,e])=>{const n=new URL(`${Ph()}hotspots`);n.searchParams.append(\"hotspot_key\",`eq.${t}`);try{return fetch(n.href,{method:\"PATCH\",body:JSON.stringify(e),headers:Rf})}catch(t){return console.error(t)}}))).then((()=>{Zh.update((()=>({}))),jf()}))}]}class wv extends Mt{constructor(t){super(),xt(this,t,gv,yv,s,{})}}function $v(t){let e,n,i,r,o,s,a,l;function c(e){t[10](e)}let u={};function h(e){t[11](e)}void 0!==t[0]&&(u.width=t[0]),n=new Kd({props:u}),U.push((()=>gt(n,\"width\",c)));let f={tabs:[{label:`Areas (${t[3]})`,component:ov},{label:`Scenes (${t[1]})`,component:Dm},{label:`Hotspots (${t[2]})`,component:wv}]};return void 0!==t[4]&&(f.currentTab=t[4]),o=new em({props:f}),U.push((()=>gt(o,\"currentTab\",h))),{c(){e=E(\"div\"),wt(n.$$.fragment),r=C(),wt(o.$$.fragment),I(e,\"class\",\"sidebar svelte-723jm5\"),I(e,\"style\",a=`width: ${t[0]}px`)},m(t,i){b(t,e,i),$t(n,e,null),$(e,r),$t(o,e,null),l=!0},p(t,[r]){const c={};!i&&1&r&&(i=!0,c.width=t[0],nt((()=>i=!1))),n.$set(c);const u={};14&r&&(u.tabs=[{label:`Areas (${t[3]})`,component:ov},{label:`Scenes (${t[1]})`,component:Dm},{label:`Hotspots (${t[2]})`,component:wv}]),!s&&16&r&&(s=!0,u.currentTab=t[4],nt((()=>s=!1))),o.$set(u),(!l||1&r&&a!==(a=`width: ${t[0]}px`))&&I(e,\"style\",a)},i(t){l||(ht(n.$$.fragment,t),ht(o.$$.fragment,t),l=!0)},o(t){ft(n.$$.fragment,t),ft(o.$$.fragment,t),l=!1},d(t){t&&x(e),bt(n),bt(o)}}}function bv(t,e,n){let i,r,o,s,a,l,c,u;p(t,lf,(t=>n(4,o=t))),p(t,af,(t=>n(5,s=t))),p(t,qh,(t=>n(6,a=t))),p(t,tf,(t=>n(7,l=t))),p(t,of,(t=>n(8,c=t))),p(t,Kh,(t=>n(9,u=t)));let h,f=400;return t.$$.update=()=>{512&t.$$.dirty&&n(3,i=u.length),256&t.$$.dirty&&c.then((({length:t})=>n(1,h=t))),192&t.$$.dirty&&n(2,r=l.filter((t=>t.scene_key===a)).length),32&t.$$.dirty&&null!==s&&g(lf,o=2,o)},[f,h,r,i,o,s,a,l,c,u,function(t){f=t,n(0,f)},function(t){o=t,lf.set(o)}]}class xv extends Mt{constructor(t){super(),xt(this,t,bv,$v,s,{})}}function Mv(t){const e=Ih.autorotate({yawSpeed:.1,targetPitch:0,targetFov:Math.PI/2});t.setIdleMovement(3e3,e),t.startMovement(e)}function Ev(t){t.setIdleMovement(1/0),t.stopMovement()}const Tv=t=>{t.altKey||cf.set(Lv(t))},Lv=t=>{const e=f(Nh);if(!e||!e.view())return{pitch:0,yaw:0};const{x:n,y:i}=e.domElement().getBoundingClientRect(),r=t.x-n,o=t.y-i;return e.view().screenToCoordinates({x:r,y:o})},Cv=t=>{console.info(\"Mouse Coordinates\",Lv(t))};function Sv(e){let n,i,r,o,s,a;return{c(){n=E(\"div\"),i=E(\"span\"),r=L(e[0]),o=C(),s=E(\"span\"),a=L(e[1]),I(n,\"class\",\"svelte-10r7xly\")},m(t,e){b(t,n,e),$(n,i),$(i,r),$(n,o),$(n,s),$(s,a)},p(t,[e]){1&e&&O(r,t[0]),2&e&&O(a,t[1])},i:t,o:t,d(t){t&&x(n)}}}function kv(t,e,n){let{label:i}=e,{value:r}=e;return t.$$set=t=>{\"label\"in t&&n(0,i=t.label),\"value\"in t&&n(1,r=t.value)},[i,r]}class Iv extends Mt{constructor(t){super(),xt(this,t,kv,Sv,s,{label:0,value:1})}}function Pv(t){let e,n,i,r,o,s,a;return n=new Iv({props:{label:\"Fov\",value:(180*t[0]/Math.PI).toFixed(1)}}),r=new Iv({props:{label:\"Height\",value:t[1]+\"px\"}}),s=new Iv({props:{label:\"Width\",value:t[2]+\"px\"}}),{c(){e=E(\"div\"),wt(n.$$.fragment),i=C(),wt(r.$$.fragment),o=C(),wt(s.$$.fragment),I(e,\"class\",\"svelte-b2gyfz\")},m(t,l){b(t,e,l),$t(n,e,null),$(e,i),$t(r,e,null),$(e,o),$t(s,e,null),a=!0},p(t,[e]){const i={};1&e&&(i.value=(180*t[0]/Math.PI).toFixed(1)),n.$set(i);const o={};2&e&&(o.value=t[1]+\"px\"),r.$set(o);const a={};4&e&&(a.value=t[2]+\"px\"),s.$set(a)},i(t){a||(ht(n.$$.fragment,t),ht(r.$$.fragment,t),ht(s.$$.fragment,t),a=!0)},o(t){ft(n.$$.fragment,t),ft(r.$$.fragment,t),ft(s.$$.fragment,t),a=!1},d(t){t&&x(e),bt(n),bt(r),bt(s)}}}function Av(t,e,n){let{viewer:i}=e,r=0,o=0,s=0;const a=()=>{!0===i.domElement().isConnected?(n(0,r=i.view().fov()),n(1,o=i.view().height()),n(2,s=i.view().width())):i.removeEventListener(\"viewChange\",a)};return i.addEventListener(\"viewChange\",a),t.$$set=t=>{\"viewer\"in t&&n(3,i=t.viewer)},[r,o,s,i]}class zv extends Mt{constructor(t){super(),xt(this,t,Av,Pv,s,{viewer:3})}}function Ov(t){let e,n,i,r,o;return n=new Iv({props:{label:\"Pitch\",value:t[0].toFixed(t[2])}}),r=new Iv({props:{label:\"Yaw\",value:t[1].toFixed(t[2])}}),{c(){e=E(\"div\"),wt(n.$$.fragment),i=C(),wt(r.$$.fragment),I(e,\"class\",\"container svelte-5mdjxu\")},m(t,s){b(t,e,s),$t(n,e,null),$(e,i),$t(r,e,null),o=!0},p(t,[e]){const i={};5&e&&(i.value=t[0].toFixed(t[2])),n.$set(i);const o={};6&e&&(o.value=t[1].toFixed(t[2])),r.$set(o)},i(t){o||(ht(n.$$.fragment,t),ht(r.$$.fragment,t),o=!0)},o(t){ft(n.$$.fragment,t),ft(r.$$.fragment,t),o=!1},d(t){t&&x(e),bt(n),bt(r)}}}function Rv(t,e,n){let{pitch:i}=e,{yaw:r}=e,{decimals:o=4}=e;return t.$$set=t=>{\"pitch\"in t&&n(0,i=t.pitch),\"yaw\"in t&&n(1,r=t.yaw),\"decimals\"in t&&n(2,o=t.decimals)},[i,r,o]}class Hv extends Mt{constructor(t){super(),xt(this,t,Rv,Ov,s,{pitch:0,yaw:1,decimals:2})}}function Dv(t){let e,n,i,r,o;return r=new Hv({props:{pitch:t[1],yaw:t[0]}}),{c(){e=E(\"div\"),n=E(\"div\"),n.textContent=\"Mouse Coords\",i=C(),wt(r.$$.fragment)},m(t,s){b(t,e,s),$(e,n),$(e,i),$t(r,e,null),o=!0},p(t,[e]){const n={};2&e&&(n.pitch=t[1]),1&e&&(n.yaw=t[0]),r.$set(n)},i(t){o||(ht(r.$$.fragment,t),o=!0)},o(t){ft(r.$$.fragment,t),o=!1},d(t){t&&x(e),bt(r)}}}function Fv(t,e,n){let i,r,o;return p(t,cf,(t=>n(2,o=t))),t.$$.update=()=>{4&t.$$.dirty&&n(1,i=o.pitch),4&t.$$.dirty&&n(0,r=o.yaw)},[r,i,o]}class qv extends Mt{constructor(t){super(),xt(this,t,Fv,Dv,s,{})}}function jv(t){let e,n,i,r,o;return r=new Hv({props:{pitch:t[0],yaw:t[1]}}),{c(){e=E(\"div\"),n=E(\"div\"),n.textContent=\"View Coords\",i=C(),wt(r.$$.fragment)},m(t,s){b(t,e,s),$(e,n),$(e,i),$t(r,e,null),o=!0},p(t,[e]){const n={};1&e&&(n.pitch=t[0]),2&e&&(n.yaw=t[1]),r.$set(n)},i(t){o||(ht(r.$$.fragment,t),o=!0)},o(t){ft(r.$$.fragment,t),o=!1},d(t){t&&x(e),bt(r)}}}function Vv(t,e,n){let{viewer:i}=e,r=0,o=0;const s=()=>{!0===i.domElement().isConnected?(n(0,r=i.view().pitch()),n(1,o=i.view().yaw())):i.removeEventListener(\"viewChange\",s)};return i.addEventListener(\"viewChange\",s),t.$$set=t=>{\"viewer\"in t&&n(2,i=t.viewer)},[r,o,i]}class Nv extends Mt{constructor(t){super(),xt(this,t,Vv,jv,s,{viewer:2})}}function Bv(t){let e,n,i,r,o,s;return e=new zv({props:{viewer:t[0]}}),i=new Nv({props:{viewer:t[0]}}),o=new qv({}),{c(){wt(e.$$.fragment),n=C(),wt(i.$$.fragment),r=C(),wt(o.$$.fragment)},m(t,a){$t(e,t,a),b(t,n,a),$t(i,t,a),b(t,r,a),$t(o,t,a),s=!0},p(t,n){const r={};1&n&&(r.viewer=t[0]),e.$set(r);const o={};1&n&&(o.viewer=t[0]),i.$set(o)},i(t){s||(ht(e.$$.fragment,t),ht(i.$$.fragment,t),ht(o.$$.fragment,t),s=!0)},o(t){ft(e.$$.fragment,t),ft(i.$$.fragment,t),ft(o.$$.fragment,t),s=!1},d(t){bt(e,t),t&&x(n),bt(i,t),t&&x(r),bt(o,t)}}}function Xv(t){let e,n,i=t[0]&&Bv(t);return{c(){e=E(\"div\"),i&&i.c(),I(e,\"class\",\"dev-info svelte-lxue0z\")},m(t,r){b(t,e,r),i&&i.m(e,null),n=!0},p(t,[n]){t[0]?i?(i.p(t,n),1&n&&ht(i,1)):(i=Bv(t),i.c(),ht(i,1),i.m(e,null)):i&&(ct(),ft(i,1,1,(()=>{i=null})),ut())},i(t){n||(ht(i),n=!0)},o(t){ft(i),n=!1},d(t){t&&x(e),i&&i.d()}}}function Wv(t,e,n){let i;return p(t,Nh,(t=>n(0,i=t))),[i]}class Yv extends Mt{constructor(t){super(),xt(this,t,Wv,Xv,s,{})}}function Uv(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Gv(t){let e,n,i,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Jv,then:Zv,catch:Kv,value:6,blocks:[,,,]};return pt(n=t[2],r),{c(){e=S(),r.block.c()},m(t,n){b(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,i=!0},p(e,i){t=e,r.ctx=t,4&i&&n!==(n=t[2])&&pt(n,r)||dt(r,t,i)},i(t){i||(ht(r.block),i=!0)},o(t){for(let t=0;t<3;t+=1){ft(r.blocks[t])}i=!1},d(t){t&&x(e),r.block.d(t),r.token=null,r=null}}}function Kv(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Zv(t){let e,n,i=t[2]&&t[5].length>0&&Qv(t);return{c(){i&&i.c(),e=S()},m(t,r){i&&i.m(t,r),b(t,e,r),n=!0},p(t,n){t[2]&&t[5].length>0?i?(i.p(t,n),6&n&&ht(i,1)):(i=Qv(t),i.c(),ht(i,1),i.m(e.parentNode,e)):i&&(ct(),ft(i,1,1,(()=>{i=null})),ut())},i(t){n||(ht(i),n=!0)},o(t){ft(i),n=!1},d(t){i&&i.d(t),t&&x(e)}}}function Qv(t){let e,n;return e=new Yd({props:{hotspotConfigList:t[6],sceneDataList:t[5]}}),{c(){wt(e.$$.fragment)},m(t,i){$t(e,t,i),n=!0},p(t,n){const i={};4&n&&(i.hotspotConfigList=t[6]),2&n&&(i.sceneDataList=t[5]),e.$set(i)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){ft(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Jv(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function t_(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function e_(t){let e,n,i,o,s,a,l,c,u,h={ctx:t,current:null,token:null,hasCatch:!1,pending:t_,then:Gv,catch:Uv,value:5,blocks:[,,,]};pt(s=t[1],h);let f=t[3]&&function(t){let e,n,i,r;return e=new xv({}),i=new Yv({}),{c(){wt(e.$$.fragment),n=C(),wt(i.$$.fragment)},m(t,o){$t(e,t,o),b(t,n,o),$t(i,t,o),r=!0},i(t){r||(ht(e.$$.fragment,t),ht(i.$$.fragment,t),r=!0)},o(t){ft(e.$$.fragment,t),ft(i.$$.fragment,t),r=!1},d(t){bt(e,t),t&&x(n),bt(i,t)}}}();return{c(){e=E(\"div\"),n=E(\"div\"),i=E(\"div\"),o=C(),h.block.c(),a=C(),f&&f.c(),I(i,\"class\",\"panorama-container svelte-z7wx6o\")},m(r,s){b(r,e,s),$(e,n),$(n,i),t[4](i),$(n,o),h.block.m(n,h.anchor=null),h.mount=()=>n,h.anchor=null,$(e,a),f&&f.m(e,null),l=!0,c||(u=[k(i,\"click\",Cv),k(e,\"mousemove\",Tv)],c=!0)},p(e,[n]){t=e,h.ctx=t,2&n&&s!==(s=t[1])&&pt(s,h)||dt(h,t,n)},i(t){l||(ht(h.block),ht(f),l=!0)},o(t){for(let t=0;t<3;t+=1){ft(h.blocks[t])}ft(f),l=!1},d(n){n&&x(e),t[4](null),h.block.d(),h.token=null,h=null,f&&f.d(),c=!1,r(u)}}}function n_(t,e,n){let i,r;p(t,of,(t=>n(1,i=t))),p(t,tf,(t=>n(2,r=t)));const{editable:o}=customProperties;let s;return sf.subscribe((async t=>{var e;const n=await t;(null===(e=null==n?void 0:n.scene)||void 0===e?void 0:e._viewer)&&n.scene.switchTo()})),Vh.subscribe(jf),Nh.subscribe((t=>{t&&jh.subscribe((e=>{const n=\"False\"!==e;n?Mv(t):Ev(t),af.subscribe((e=>{e?Ev(t):n&&Mv(t)}))}))})),af.subscribe((t=>{const e=f(Nh);e&&(null===t?e.controls().enable():e.controls().disable())})),B((()=>Nh.set(new Ih.Viewer(s)))),[s,i,r,o,function(t){U[t?\"unshift\":\"push\"]((()=>{s=t,n(0,s)}))}]}class i_ extends Mt{constructor(t){super(),xt(this,t,n_,e_,s,{})}}const r_=()=>{var t;const e=f(rf),n=f(qh),i=e.find((({scene_key:t})=>t===n));var r;r=null!==(t=null==i?void 0:i.fov)&&void 0!==t?t:100,f(Nh).view().setFov(r*Math.PI/180)},o_=t=>{switch(t.key){case\"f\":t.stopPropagation(),e=t.currentTarget,htmlNode.fullscreenElement?document.exitFullscreen():e.requestFullscreen();break;case\"r\":r_()}var e};function s_(e){let n,i,r,o,s;return i=new i_({}),{c(){n=E(\"main\"),wt(i.$$.fragment),I(n,\"tabindex\",\"0\")},m(t,e){b(t,n,e),$t(i,n,null),r=!0,o||(s=k(n,\"keydown\",o_),o=!0)},p:t,i(t){r||(ht(i.$$.fragment,t),r=!0)},o(t){ft(i.$$.fragment,t),r=!1},d(t){t&&x(n),bt(i),o=!1,s()}}}function a_(t){function e(){Vh.update((()=>data))}return htmlNode.addEventListener(\"panelupdate\",e),X((()=>{htmlNode.removeEventListener(\"panelupdate\",e)})),[]}return new class extends Mt{constructor(t){super(),xt(this,t,a_,s_,s,{})}}({target:htmlNode.children[1]})}();\n",
        "onInitOnResize": false,
        "onRender": "\n",
        "overflow": "visible",
        "panelupdateOnMount": false,
        "reduceOptions": {
          "calcs": [
            "lastNotNull",
            "last",
            "first",
            "firstNotNull",
            "min",
            "max",
            "mean",
            "sum",
            "count",
            "range",
            "delta",
            "step",
            "diff",
            "logmin",
            "allIsZero",
            "allIsNull",
            "diffperc"
          ]
        },
        "renderOnMount": true,
        "rootCSS": "",
        "updateOnInitOnResize": false
      },
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "W3XJT3dnz"
          },
          "fields": [
            {
              "jsonPath": "$",
              "name": "Value"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "areas",
          "urlPath": "/areas"
        },
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "W3XJT3dnz"
          },
          "fields": [
            {
              "jsonPath": "$",
              "name": "Value"
            }
          ],
          "hide": false,
          "method": "GET",
          "queryParams": "",
          "refId": "scenes",
          "urlPath": "/scenes?area_key=eq.${area}"
        },
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "W3XJT3dnz"
          },
          "fields": [
            {
              "jsonPath": "$",
              "name": "Value"
            }
          ],
          "hide": false,
          "method": "GET",
          "queryParams": "",
          "refId": "hotspots",
          "urlPath": "/hotspots?area_key=eq.${area}"
        }
      ],
      "type": "gapit-htmlgraphics-panel"
    }
  ],
  "refresh": "",
  "schemaVersion": 33,
  "style": "dark",
  "tags": [],
  "templating": {
    "list": [
      {
        "datasource": {
          "type": "marcusolsson-json-datasource",
          "uid": "W3XJT3dnz"
        },
        "definition": "$.*.area_key",
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "area",
        "options": [],
        "query": {
          "cacheDurationSeconds": 300,
          "experimentalVariableTextField": "Text",
          "experimentalVariableValueField": "Value",
          "fields": [
            {
              "jsonPath": "$.*.area_key",
              "name": "Value"
            },
            {
              "jsonPath": "$.*.area_name",
              "language": "jsonpath",
              "name": "Text"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "urlPath": "/areas"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "datasource": {
          "type": "marcusolsson-json-datasource",
          "uid": "W3XJT3dnz"
        },
        "definition": "$.*.scene_key",
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "scene",
        "options": [],
        "query": {
          "cacheDurationSeconds": 300,
          "experimentalVariableTextField": "Text",
          "experimentalVariableValueField": "Value",
          "fields": [
            {
              "jsonPath": "$.*.scene_key",
              "name": "Value"
            },
            {
              "jsonPath": "$.*.scene_name",
              "language": "jsonpath",
              "name": "Text"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "urlPath": "/scenes?area_key=eq.${area}"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "autoRotate",
        "options": [
          {
            "selected": true,
            "text": "True",
            "value": "True"
          },
          {
            "selected": false,
            "text": "False",
            "value": "False"
          }
        ],
        "query": "True,False",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      }
    ]
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Grafana 360 viewer",
  "uid": "nVgahqd7d",
  "version": 2,
  "weekStart": ""
}
